{
    "question": "请帮我计算，在20210105，中信行业分类划分的一级行业为综合金融行业中，涨跌幅最大股票的股票代码是？涨跌幅是多少？百分数保留两位小数。股票涨跌幅定义为：（收盘价 - 前一日收盘价 / 前一日收盘价）* 100%。",
    "sql": "WITH a_stock_data AS (\n    SELECT \n        a_code,\n        a_date,\n        a_close,\n        LAG(a_close) OVER (ORDER BY a_date) AS a_close_prev\n    FROM \n        A股票日行情表 a\n    WHERE \n        a_date = '20210105'\n),\nb_stock_data AS (\n    SELECT \n        a_code,\n        a_date,\n        a_close,\n        a_close_prev,\n        ((a_close - a_close_prev) / a_close_prev) * 100 AS stock_return\n    FROM \n        a_stock_data\n),\nc_stock_data AS (\n    SELECT \n        a_code,\n        MAX(stock_return) AS max_return,\n        MIN(stock_return) AS min_return\n    FROM \n        b_stock_data\n    GROUP BY \n        a_code\n)\nSELECT \n    a_code,\n    ROUND(MAX(stock_return), 2) AS stock_return_percentage\nFROM \n    c_stock_data\nWHERE \n    a_code IN (\n        SELECT \n            a_code \n        FROM \n            b_stock_data \n        WHERE \n            a_date = '20210105' \n            AND a_close_prev IS NOT NULL \n            AND a_close IS NOT NULL\n    )\nGROUP BY \n    a_code\nORDER BY \n    ROUND(MAX(stock_return), 2) DESC\nLIMIT 1;",
    "error": "no such column: a_code"
}
{
    "question": "湖南长远锂科股份有限公司变更设立时作为发起人的法人有哪些？",
    "sql": "SELECT DISTINCT f1.fund_code AS 公司代码, \n       f1.fund_name AS 公司全称 \nFROM \n    基金基本信息 f1 \nJOIN \n    基金股票持仓明细 f2 ON f1.fund_code = f2.fund_code \nJOIN \n    基金债券持仓明细 f3 ON f1.fund_code = f3.fund_code \nJOIN \n    基金可转债持仓明细 f4 ON f1.fund_code = f4.fund_code \nJOIN \n    A股票日行情表 f5 ON f1.fund_code = f5.fund_code \nJOIN \n    A股票公司行业划分表 f6 ON f1.fund_code = f6.stock_code \nWHERE \n    f1.fund全称 LIKE '%湖南长远锂科股份有限公司%';",
    "error": "no such table: A股票公司行业划分表"
}
{
    "question": "20210304日，一级行业为非银金融的股票的成交量合计是多少？取整。",
    "sql": "SELECT ROUND(SUM(A.成交量(元)), 0) AS 成交额合计\nFROM A股票日行情表 A\nJOIN A股票日行情表 B ON A.交易日 = B.交易日\nWHERE A.股票代码 IN (\n    SELECT A.股票代码 \n    FROM A股票日行情表 A\n    WHERE A.股票代码 LIKE '%60%')  -- 假设股票代码以%60%结尾表示非银金融行业\nORDER BY A.成交量(元) DESC\nLIMIT 1;",
    "error": "near \"(\": syntax error"
}
{
    "question": "嘉实基金管理有限公司2019年成立了多少基金?",
    "sql": "SELECT COUNT(DISTINCT fund_code) as 成功发行基金数量\nFROM 基金基本信息\nWHERE FOUNDATION_DATE BETWEEN '2019-01-01' AND '2019-12-31';",
    "error": "no such column: fund_code"
}
{
    "question": "2021年三季度，有多少家基金发生了净赎回?总共赎回了多少份额?记得给我四舍五入到小数点后两位哦。",
    "sql": "SELECT \n    COUNT(DISTINCT fund_code) AS 基金数量,\n    SUM(赎回份额) AS 总赎回份额\nFROM \n    基金规模变动表\nWHERE \n    公告日期 >= '2021-07-01' AND 公告日期 <= '2021-09-30'\n    AND (基金类型 = '股票型' OR 基金类型 = '债券型' OR 基金类型 = '混合型')\n    AND 报告类型 = '定期报告';",
    "error": "no such column: fund_code"
}
{
    "question": "请帮我查询下，在20190605，中信行业分类里一级行业为石油石化行业的所有股票里, 成交金额(元)最多的股票的代码是什么？成交金额是多少？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_short_name,\n    SUM(fh.成交金额(元)) AS total成交金额\nFROM \n    基金股票持仓明细 f\nJOIN \n    A股票日行情表 fh \nON \n    f.基金代码 = fh.股票代码\nWHERE \n    f.基金代码 LIKE '%中信%石油石化%'\n    AND fh.交易日 = '20190605'\n    AND fh.一级行业 = '石油石化'\nGROUP BY \n    f.fund_code, f.fund_short_name\nORDER BY \n    total成交金额 DESC\nLIMIT 1;",
    "error": "near \"(\": syntax error"
}
{
    "question": "股票002244在20191220日期中的收盘价是多少?（小数点保留3位）",
    "sql": "SELECT ROUND(LOWER(A.今开盘(元), 3) AS 收盘价(元) FROM A股票日行情表 A WHERE A.交易日 = '20191220' ORDER BY A.交易日 DESC LIMIT 1;",
    "error": "near \"(\": syntax error"
}
{
    "question": "本次发行前，大连派思燃气系统股份有限公司的控股股东持有公司的多少股份？占公司总股份的多少？",
    "sql": "SELECT\n    f1.fund_code,\n    f1.fund_short_name,\n    SUM(f2.数量) AS total_shares,\n    (SUM(f2.数量) / f1.资产净值) * 100 AS percentage\nFROM\n    基金股票持仓明细 f2\n    LEFT JOIN\n    基金基本信息 f1 ON f1.fund_code = f2.fund_code\nWHERE\n    f2.fund_short_name = '大连派思燃气系统股份有限公司'\nGROUP BY\n    f1.fund_code,\n    f1.fund_short_name\nORDER BY\n    f1.fund_short_name DESC\nLIMIT 1;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "请问2019年三季度有多少家基金是净申购?它们的净申购份额加起来是多少?请四舍五入保留小数点两位。",
    "sql": "SELECT \n    COUNT(DISTINCT f1.fund_code) AS net_sharing_funds,\n    ROUND(SUM(f2.total_sharing_amount), 2) AS total_net_sharing\nFROM \n    fund_scale f1\nJOIN \n    fund_scale f2 \nON \n    f1.fund_code = f2.fund_code\nWHERE \n    f1.report_period_year = 2019\n    AND f1.report_period_quarter = 3\n    AND f2.report_period_year = 2019\n    AND f2.report_period_quarter = 3\n    AND f2.total_sharing_amount > 0;",
    "error": "no such table: fund_scale"
}
{
    "question": "帮我查一下湘财长弘灵活配置混合A基金在20210419的资产净值和单位净值是多少?",
    "sql": "SELECT \n    f1.fund_code,\n    f1.trade_date,\n    f1.unitholders,\n    f1.cumunits \nFROM \n    fund_daily f1 \nWHERE \n    f1.fund_code = '湘财长弘灵活配置混合A' \n    AND f1.trade_date = '20210419';",
    "error": "no such table: fund_daily"
}
{
    "question": "近三年，广东银禧科技股份有限公司总资产周转率分别为多少？",
    "sql": "SELECT \n    f1.fund_code,\n    f1.fund简称,\n    f1.管理费率,\n    f1.托管费率,\n    f1.成立日期,\n    f1.到期日期,\n    f1.管理费率 / f2.市值 AS 总资产周转率\nFROM \n    基金基本信息 f1\nJOIN \n    基金股票持仓明细 f2 ON f1.fund_code = f2.fund_code\nWHERE \n    f1.fund简称 = '广东银禧科技股份有限公司'\n    AND f1.成立日期 >= '2020-01-01'\n    AND f1.到期日期 <= '2023-12-31'\n    AND f2.持仓日期 >= '2020-01-01'\n    AND f2.持仓日期 <= '2023-12-31'\n    AND f2.股票代码 = '603123'\n    ORDER BY f1.到期日期 DESC\nLIMIT 100;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "我想知道安信稳健回报6个月持有期混合A基金在20211231的年报(含半年报)中，其可转债持仓占比最大的是哪个行业？用中信一级行业来统计。",
    "sql": "SELECT\n    f1.`一级行业名称` AS `一级行业名称`,\n    COUNT(f1.`第N大重仓股`) AS `可转债持仓占比最大的行业`\nFROM\n    基金可转债持仓明细 f1\nJOIN\n    A股票日行情表 f2 ON f1.`基金代码` = f2.`股票代码`\nJOIN\n    A股票日行情表 f3 ON f1.`基金代码` = f3.`股票代码`\nJOIN\n    A股票日行情表 f4 ON f1.`基金代码` = f4.`股票代码`\nJOIN\n    A股票日行情表 f5 ON f1.`基金代码` = f5.`股票代码`\nJOIN\n    A股票日行情表 f6 ON f1.`基金代码` = f6.`股票代码`\nGROUP BY f1.`基金代码`, f1.`一级行业名称`\n HAVING COUNT(f1.`第N大重仓股`) = (\n    SELECT MAX(COUNT(f2.`第N大重仓股`))\n    FROM A股票日行情表 f2\n    WHERE f2.`基金代码` = f1.`基金代码`\n    AND f2.`交易日期` >= '2021-12-31'\n    ORDER BY f2.`交易日期` DESC\n    LIMIT 1\n    )\nORDER BY f1.`一级行业名称`;",
    "error": "no such column: f1.一级行业名称"
}
{
    "question": "根据联化科技股份有限公司招股意见书，精细化工产品的通常利润率是多少？",
    "sql": "SELECT\n    f1.fund_code,\n    f1.fund_short_name,\n    f1.fund_total_assets AS total_assets,\n    f1.fund manages,\n    f1.fund_total_assets - f1.fund managed_shares AS total managed assets,\n    f1.fund_total_assets - f1.fund managed_shares - f1.fund managed_cash AS total managed liabilities\nFROM\n    Fund基本信息 f1\nLEFT JOIN\n    Fund债券持仓明细 f2 ON f1.fund_code = f2.fund_code\nLEFT JOIN\n    Fund股票持仓明细 f3 ON f1.fund_code = f3.fund_code\nLEFT JOIN\n    Fund可转债持仓明细 f4 ON f1.fund_code = f4.fund_code\nLEFT JOIN\n    Fund日行情表 f5 ON f1.fund_code = f5.fund_code\nLEFT JOIN\n    A股票日行情表 a1 ON f1.fund_short_name = a1.stock_code\nLEFT JOIN\n    A股票日行情表 a2 ON f1.fund_short_name = a2.stock_code\nLEFT JOIN\n    A股票日行情表 a3 ON f1.fund_short_name = a3.stock_code\nLEFT JOIN\n    A股票日行情表 a4 ON f1.fund_short_name = a4.stock_code\nLEFT JOIN\n    A股票日行情表 a5 ON f1.fund_short_name = a5.stock_code\nLEFT JOIN\n    A股票日行情表 a6 ON f1.fund_short_name = a6.stock_code\nLEFT JOIN\n    A股票日行情表 a7 ON f1.fund_short_name = a7.stock_code\nLEFT JOIN\n    A股票日行情表 a8 ON f1.fund_short_name = a8.stock_code\nLEFT JOIN\n    A股票日行情表 a9 ON f1.fund_short_name = a9.stock_code\nLEFT JOIN\n    A股票日行情表 a10 ON f1.fund_short_name = a10.stock_code\nLEFT JOIN\n    A股票日行情表 a11 ON f1.fund_short_name = a11.stock_code\nLEFT JOIN\n    A股票日行情表 a12 ON f1.fund_short_name = a12.stock_code\nLEFT JOIN\n    A股票日行情表 a13 ON f1.fund;",
    "error": "near \"AS\": syntax error"
}
{
    "question": "各报告期末，江苏旷达汽车织物集团股份有限公司存货分别为多少万元？占流动资产的比例分别多少？",
    "sql": "SELECT\n    f.fund_code,\n    f.fund简称,\n    f.成立日期,\n    f.到期日期,\n    f.管理费率,\n    f.托管费率,\n    SUM(p.数量) AS 存货总量万元,\n    (SUM(p.数量) / f.资产净值) * 100 AS 存货占比流动资产\nFROM\n    基金基本信息 f\nJOIN\n    基金股票持仓明细 p ON f.fund_code = p.fund_code\nJOIN\n    基金债券持仓明细 b ON f.fund_code = b.fund_code\nJOIN\n    基金可转债持仓明细 cr ON f.fund_code = cr.fund_code\nJOIN\n    基金债券持仓明细 cr ON f.fund_code = cr.fund_code\nJOIN\n    基金债券持仓明细 b ON f.fund_code = b.fund_code\nJOIN\n    基金可转债持仓明细 cr ON f.fund_code = cr.fund_code\nJOIN\n    A股票日行情表 a ON f.fund_code = a.基金代码\nJOIN\n    港股票日行情表 h ON f.fund_code = h.基金代码\nJOIN\n    A股公司行业划分表 i ON f.fund简称 = i.股票代码\nJOIN\n    基金规模变动表 s ON f.fund_code = s.fund_code\nJOIN\n    基金日行情表 d ON f.fund_code = d.fund_code\nGROUP BY\n    f.fund_code,\n    f.fund简称,\n    f.成立日期,\n    f.到期日期,\n    f.管理费率,\n    f.托管费率\nORDER BY\n    f.成立日期 DESC,\n    f.到期日期 DESC,\n    f.资产净值 DESC\nLIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "2019年中期报告里，华夏基金管理有限公司管理的基金中，机构投资者持有份额比个人投资者多的基金有多少只?",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS num_funds\nFROM fund_scale_holders f1\nJOIN fund_fundamentals f2 ON f1.fund_code = f2.fund_code\nWHERE f2.fund_manager = '华夏基金管理有限公司'\nAND f1.机构投资者持有的基金份额 > f1.个人投资者持有的基金份额\nORDER BY f1.fund_code DESC\nLIMIT 100;",
    "error": "no such table: fund_scale_holders"
}
{
    "question": "假设股票日收益率计算公式为：日收益率 = （当日收盘价-昨收盘价）/昨收盘价。请帮我找到在2021年，申万行业分类行业划分标准,银行一级行业中, 代码为多少的股票的日均收益率最高？",
    "sql": "SELECT \n    stock_code,\n    a_stock.dayreturn_rate,\n    (SELECT a_stock.dayreturn_rate \n     FROM A股票日行情表 a_stock \n     WHERE a_stock.交易日期 = '2021-12-31'\n     ) AS dayreturn_rate\nFROM \n    A股票日行情表 AS a_stock\nWHERE \n    a_stock.交易日期 = '2021-12-31'\n    AND a_stock.股票代码 = (SELECT stock_code \n                           FROM A股票日行情表 \n                           WHERE a_stock.交易日期 = '2021-12-31'\n                           AND a_stock.股票代码 LIKE '%银行%')\n    AND a_stock.日收益率 > 0\nORDER BY dayreturn_rate DESC\nLIMIT 1;",
    "error": "no such column: stock_code"
}
{
    "question": "在20201022，按照中信行业分类的行业划分标准，哪个一级行业的A股公司数量最多？",
    "sql": "SELECT \n    a.stock_code,\n    a.行业划分标准,\n    a.一级行业名称,\n    COUNT(a.stock_code) AS 数量\nFROM \n    A股票日行情表 a\nJOIN \n    A股公司行业划分表 b \nON \n    a.股票代码 = b.股票代码\nWHERE \n    a.交易日期 = '20201022'\n    AND b.行业划分标准 = '中信行业分类'\n    AND a.交易日期 >= '20201022'\n    AND a.交易日期 <= '20201022'\nGROUP BY \n    a.一级行业名称\nORDER BY \n    数量 DESC\nLIMIT 1;",
    "error": "no such column: a.stock_code"
}
{
    "question": "我想知道招商安润灵活配置混合A基金，在2021年半年度报告中，前10大重仓股中，有多少只股票在报告期内取得正收益。",
    "sql": "SELECT COUNT(DISTINCT s.stock_code) AS distinct_stocks_with_positive_return\nFROM fund_stocks_holding_details f\nJOIN stock_daily_details s ON f.stock_code = s.stock_code AND f.fund_code = '招商安润灵活配置混合A' AND f.fund_short_name = '灵活配置'\nWHERE f.holding_date BETWEEN '2021-01-01' AND '2021-06-30'\n  AND f.portfolio_rank = 10\n  AND s.trading_date >= f.holding_date\n  AND s.trading_date <= f.holding_date\n  AND s.close > s.open\nGROUP BY f.fund_code, f.fund_short_name, f.holding_date\nORDER BY COUNT(DISTINCT s.stock_code) DESC\nLIMIT 100;",
    "error": "no such table: fund_stocks_holding_details"
}
{
    "question": "帮我查询在2020年12月31日，代码为007678的基金前20大重仓股票中属于中信二级照明电工及其他行业的平均市值是多少？小数点后保留不超过3位。",
    "sql": "SELECT\n    substr(fund_info.fund_short_name, 0, 20) AS fund_short_name,\n    avg(fund_stocks.market_value) AS avg_market_value\nFROM\n    fund_stocks\nJOIN\n    fund_info ON fund_stocks.fund_code = fund_info.fund_code\nWHERE\n    fund_info.fund_code = '007678'\n    AND fund_info.fund_date = '2020-12-31'\n    AND fund_stocks.position_rank <= 20\n    AND fund_stocks.industry IN ('中信', '二级', '照明电工', '及其他', '行业')\n    AND fund_stocks.sub_industry = '中信二级照明电工及其他'\nGROUP BY\n    fund_stocks.fund_code,\n    fund_stocks.fund_short_name,\n    fund_stocks.sub_industry\nORDER BY\n    avg_market_value DESC\nLIMIT 1;",
    "error": "no such table: fund_stocks"
}
{
    "question": "请帮我查询出20190121日，非银行金融一级行业涨幅超过5%（不包含）的股票数量。",
    "sql": "SELECT COUNT(DISTINCT stock_code) AS stock_code_count\nFROM (\n    SELECT stock_code, stock_name, (current_open - previous_close) / previous_close * 100 AS percentage_change\n    FROM A股票日行情表 a\n    WHERE a.交易日期 = '20190121'\n        AND a.股票代码 LIKE 'A%'\n        AND a.行业划分标准 = '非银行金融'\n        AND a.一级行业名称 = '一级'\n        AND a.二级行业名称 IS NULL\n        AND a.percentage_change > 5\n) AS subquery;",
    "error": "no such column: stock_code"
}
{
    "question": "请查询：在20190118，属于申万二级银行行业的A股股票，它们的平均成交金额是多少？小数点后保留不超过5位。",
    "sql": "SELECT ROUND(AVGS.MARKET成交金额(元), 5) AS 平均成交金额\nFROM A股票日行情表 AS A\nJOIN A股票日行情表 AS B ON A.交易日 = B.交易日\nJOIN A股票日行情表 AS C ON A.交易日 = C.交易日\nJOIN A股票日行情表 AS D ON A.交易日 = D.交易日\nJOIN A股票日行情表 AS E ON A.交易日 = E.交易日\nJOIN A股票日行情表 AS F ON A.交易日 = F.交易日\nJOIN A股票日行情表 AS G ON A.交易日 = G.交易日\nJOIN A股票日行情表 AS H ON A.交易日 = H.交易日\nJOIN A股票日行情表 AS I ON A.交易日 = I.交易日\nJOIN A股票日行情表 AS J ON A.交易日 = J.交易日\nWHERE \n    A.股票代码 IN (\n        SELECT \n            A股票日行情表.股票代码 \n        FROM A股票日行情表 \n        WHERE A股票日行情表.交易日期 = '20190118' \n        AND A股票日行情表.行业划分标准 = '申万二级银行行业'\n    )\n    AND A.股票代码 IN (\n        SELECT \n            A股票日行情表.股票代码 \n        FROM A股票日行情表 \n        WHERE A股票日行情表.交易日期 = '20190118' \n        AND A股票日行情表.行业划分标准 = '申万二级银行行业'\n    )\n    AND A.交易日期 >= '20190101'\n    AND A.交易日期 <= '20190131'\n    AND A.成交金额(元) IS NOT NULL\n    AND A.成交金额(元) LIKE '%'\n    AND A.成交金额(元) NOT LIKE '%null%';",
    "error": "near \"(\": syntax error"
}
{
    "question": "中国铁路通信信号股份有限公司的主要经营模式是怎样的？",
    "sql": "SELECT\n    f.fund_code,\n    f.fund_name,\n    f.mgr,\n    f.tch,\n    f.mgr_fee,\n    f.tch_fee,\n    f.establish_date,\n    f.maturity_date,\n    f.mgr_commission,\n    f.mtch_commission\nFROM\n    Fund_Basic f\nJOIN\n    Fund_Equity Holdings fh ON f.fund_code = fh.fund_code\nJOIN\n    Fund_Bond Holdings fhb ON f.fund_code = fhb.fund_code\nJOIN\n    Fund_TrlBonds Holdings fht ON f.fund_code = fht.fund_code\nORDER BY f.establish_date DESC\nLIMIT 100;",
    "error": "near \"fh\": syntax error"
}
{
    "question": "请查询：在2021的年度报告中，个人投资者持有基金份额大于机构投资者持有基金份额的基金属于货币型类型的有几个。",
    "sql": "SELECT COUNT(DISTINCT fund_code)\nFROM (\n    SELECT fund_code\n    FROM (\n        SELECT f1.*,\n               f2.*,\n               f3.*,\n               f4.*,\n               f5.*,\n               f6.*,\n               f7.*,\n               f8.*,\n               f9.*,\n               f10.*,\n               f11.*,\n               f12.*,\n               f13.*,\n               f14.*,\n               f15.*,\n               f16.*,\n               f17.*,\n               f18.*,\n               f19.*,\n               f20.*,\n               f21.*,\n               f22.*,\n               f23.*,\n               f24.*,\n               f25.*,\n               f26.*,\n               f27.*,\n               f28.*,\n               f29.*,\n               f30.*,\n               f31.*,\n               f32.*,\n               f33.*,\n               f34.*,\n               f35.*,\n               f36.*,\n               f37.*,\n               f38.*,\n               f39.*,\n               f40.*,\n               f41.*,\n               f42.*,\n               f43.*,\n               f44.*,\n               f45.*,\n               f46.*,\n               f47.*,\n               f48.*,\n               f49.*,\n               f50.*,\n               f51.*,\n               f52.*,\n               f53.*,\n               f54.*,\n               f55.*,\n               f56.*,\n               f57.*,\n               f58.*,\n               f59.*,\n               f60.*,\n               f61.*,\n               f62.*,\n               f63.*,\n               f64.*,\n               f65.*,\n               f66.*,\n               f67.*,\n               f68.*,\n               f69.*,\n               f70.*,\n               f71.*,\n               f72.*,\n               f73.*,\n               f74.*,\n               f75.*,\n               f76.*,\n               f77.*,\n               f78.*,\n               f79.*,\n               f80.*,\n               f81.*;",
    "error": "near \";\": syntax error"
}
{
    "question": "我想知道圆信永丰高端制造混合基金，在2020年半年度报告中，前10大重仓股中，有多少只股票在报告期内取得正收益。",
    "sql": "SELECT COUNT(*) AS count_of_stocks_with_positive_return\nFROM (\n    SELECT \n        stock_code,\n        SUM(CASE WHEN close > open THEN 1 ELSE 0 END) AS positive_return\n    FROM \n        fund_stocks_holding_details\n    WHERE \n        fund_code = '圆信永丰高端制造混合基金' AND \n        reporting_period = '2020年半年度'\n        AND position_rank <= 10\n    GROUP BY \n        stock_code\n) AS temp_table\nWHERE \n    temp_table.count_of_stocks_with_positive_return > 0;",
    "error": "no such table: fund_stocks_holding_details"
}
{
    "question": "在2019年的中期报告里，金鹰基金管理有限公司管理的基金中，有多少比例的基金是个人投资者持有的份额超过机构投资者？希望得到一个精确到两位小数的百分比。",
    "sql": "WITH FundHolderStructure AS (\n    SELECT \n        f1.fund_code,\n        f1.fund简称,\n        f1.管理人,\n        f1.托管人,\n        f1.基金类型,\n        f1.成立日期,\n        f1.到期日期,\n        f1.管理费率,\n        f1.托管费率,\n        COUNT(f2.基金持有份额) AS total_shares,\n        f2.个人投资者持有的基金份额 AS personal_shares,\n        f2.机构投资者持有的基金份额 AS institutional_shares\n    FROM \n        Fund基本信息 f1\n    LEFT JOIN \n        FundHolderStructure f2 ON f1.fund_code = f2.fund_code\n    WHERE \n        f1.基金简称 LIKE '%金鹰基金管理有限公司%'\n        AND YEAR(f1.成立日期) = 2019\n    GROUP BY \n        f1.fund_code, f1.fund简称, f1.管理人, f1.托管人, f1.基金类型, f1.成立日期, f1.到期日期, f1.管理费率, f1.托管费率\n)\nSELECT \n    ROUND(SUM(CASE WHEN f1.personal_shares > f1.institutional_shares THEN f1.personal_shares ELSE 0 END) / \n        SUM(f1.total_shares) * 100, 2) AS percentage\nFROM \n    FundHolderStructure f1\nWHERE \n    f1.personal_shares > f1.institutional_shares\nORDER BY \n    f1.成立日期 DESC\nLIMIT 100;",
    "error": "no such table: Fund基本信息"
}
{
    "question": "在2019年12月季报中，持有大亚圣象这一股票且市值占基金资产净值比不小于5%的有几只基金？",
    "sql": "SELECT COUNT(DISTINCT fund_code) AS num_funds\nFROM (\n    SELECT fund_code, stock_code, 市值, 基金资产净值, 市值占基金资产净值比\n    FROM 基金股票持仓明细\n    WHERE 报告类型 = '季报'\n        AND 基金代码 = '大亚圣象'\n        AND 市值占基金资产净值比 >= 5\n) AS temp_table\nGROUP BY fund_code\nORDER BY num_funds DESC\nLIMIT 10;",
    "error": "no such column: fund_code"
}
{
    "question": "我想知道在2019年，金信基金管理有限公司已发行的基金中，有多少只基金报告期期初基金总份额小于报告期期末基金总份额(使用每只基金当年最晚的定期报告数据计算)？",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS distinct_fund_count\nFROM fund基本信息 f1\nJOIN 基金规模变动表 f2 ON f1.fund_code = f2.fund_code\nWHERE f2.reporting_year = 2019\n  AND f2.fund_code LIKE '金信管理%' -- 假设基金公司名称前缀为 '金信管理%'\n  AND f1.portfolio_start_amount < f1.portfolio_end_amount\nORDER BY f2.reporting_year DESC\nLIMIT 1;",
    "error": "no such table: fund基本信息"
}
{
    "question": "报告期内，武汉兴图新科电子股份有限公司来自军用领域的收入占主营业务收入的比重分别是多少？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    (SELECT SUM(case WHEN www.w sharing_type = '军用' THEN ww shares_volume ELSE 0 END) \n     FROM fund_holders \n     WHERE fund_code = f.fund_code \n     AND holding_date >= f.start_date \n     AND holding_date <= f.end_date) \n     / \n    (SELECT SUM(ww shares_volume) \n     FROM fund_holders \n     WHERE fund_code = f.fund_code \n     AND holding_date >= f.start_date \n     AND holding_date <= f.end_date) \nAS ratio\nFROM fund_daily \nAS f\nJOIN fund_holders \nON f.fund_code = h.fund_code\nAND f.holding_date = h.holding_date\nWHERE f.fund_name LIKE '%武汉兴图新科电子股份有限公司%';",
    "error": "near \"sharing_type\": syntax error"
}
{
    "question": "根据武汉兴图新科电子股份有限公司招股意向书，电子信息行业的上游涉及哪些企业？",
    "sql": "📌 任务描述：\n            你是一名 SQL 生成专家，需要将用户的自然语言问题转换为 **高效且准确的 SQL 查询**。\n            \n            📊 **数据库模式（Schema）**：\n            ▌ 表名：基金基本信息\n    ▪ 基金代码 (TEXT)\n    ▪ 基金全称 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 管理人 (TEXT)\n    ▪ 托管人 (TEXT)\n    ▪ 基金类型 (TEXT)\n    ▪ 成立日期 (TEXT)\n    ▪ 到期日期 (TEXT)\n    ▪ 管理费率 (TEXT)\n    ▪ 托管费率 (TEXT)\n\n▌ 表名：基金股票持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 股票代码 (TEXT)\n    ▪ 股票名称 (TEXT)\n    ▪ 数量 (REAL)\n    ▪ 市值 (REAL)\n    ▪ 市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金债券持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 债券类型 (TEXT)\n    ▪ 债券名称 (TEXT)\n    ▪ 持债数量 (REAL)\n    ▪ 持债市值 (REAL)\n    ▪ 持债市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金可转债持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 对应股票代码 (TEXT)\n    ▪ 债券名称 (TEXT)\n    ▪ 数量 (REAL)\n    ▪ 市值 (REAL)\n    ▪ 市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金日行情表\n    ▪ 基金代码 (TEXT)\n    ▪ 交易日期 (TEXT)\n    ▪ 单位净值 (REAL)\n    ▪ 复权单位净值 (REAL)\n    ▪ 累计单位净值 (REAL)\n    ▪ 资产净值 (REAL)\n\n▌ 表名：A股票日行情表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日 (TEXT)\n    ▪ 昨收盘(元) (REAL)\n    ▪ 今开盘(元) (REAL)\n    ▪ 最高价(元) (REAL)\n    ▪ 最低价(元) (REAL)\n    ▪ 收盘价(元) (REAL)\n    ▪ 成交量(股) (REAL)\n    ▪ 成交金额(元) (REAL)\n\n▌ 表名：港股票日行情表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日 (TEXT)\n    ▪ 昨收盘(元) (REAL)\n    ▪ 今开盘(元) (REAL)\n    ▪ 最高价(元) (REAL)\n    ▪ 最低价(元) (REAL)\n    ▪ 收盘价(元) (REAL)\n    ▪ 成交量(股) (REAL)\n    ▪ 成交金额(元) (REAL)\n\n▌ 表名：A股公司行业划分表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日期 (TEXT)\n    ▪ 行业划分标准 (TEXT)\n    ▪ 一级行业名称 (TEXT)\n    ▪ 二级行业名称 (TEXT)\n\n▌ 表名：基金规模变动表\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 公告日期 (TIMESTAMP)\n    ▪ 截止日期 (TIMESTAMP)\n    ▪ 报告期期初基金总份额 (REAL)\n    ▪ 报告期基金总申购份额 (REAL)\n    ▪ 报告期基金总赎回份额 (REAL)\n    ▪ 报告期期末基金总份额 (REAL)\n    ▪ 定期报告所属年度 (INTEGER)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金份额持有人结构\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 公告日期 (TIMESTAMP)\n    ▪ 截止日期 (TIMESTAMP)\n    ▪ 机构投资者持有的基金份额 (REAL)\n    ▪ 机构投资者持有的基金份额占总份额比例 (REAL)\n    ▪ 个人投资者持有的基金份额 (REAL)\n    ▪ 个人投资者持有的基金份额占总份额比例 (REAL)\n    ▪ 定期报告所属年度 (INTEGER)\n    ▪ 报告类型 (TEXT)\n\n            📝 **SQL 生成要求：**\n            1️⃣ **仅返回 SQL 代码**，不包含任何额外的自然语言解释。  \n2️⃣ SQL **应符合 ANSI 标准**，或可根据数据库类型（`MySQL` / `PostgreSQL` / `SQL Server`）调整语法。  \n3️⃣ **正确使用 `JOIN` 进行表关联**，避免冗余查询。  \n4️⃣ 对于涉及 **聚合操作**（如 `COUNT`、`SUM`、`AVG`），**自动补充 `GROUP BY`**，避免 SQL 语法错误。  \n5️⃣ **字段应加上表前缀**（如 `users.name` 而不是 `name`）以避免歧义。  \n6️⃣ **使用索引字段进行过滤**（如 `fund_code`、`stock_code`），提高查询效率。  \n7️⃣ **对于时间序列查询，自动补充 `ORDER BY date_column DESC` 以返回最新数据**。  \n8️⃣ **合理使用 `LIMIT` 避免查询返回过多数据**（如默认 `LIMIT 100`）。  \n9️⃣ **复杂查询推荐使用 `WITH` 语句（CTE）或子查询**，提高可读性和维护性。  \n🔟 **特别说明**：对于包含括号的字段名（例如 \"成交金额(元)\"），请确保在生成 SQL 时使用适当的引用符号（如反引号、方括号或双引号，依据所用数据库的具体要求），以防止解析错误。\n\n            🛠️ 根据以上信息（包括数据库模式、SQL生成要求等），\n            请将以下问题转换为SQL语句：\n            根据武汉兴图新科电子股份有限公司招股意向书，电子信息行业的上游涉及哪些企业？\n            🎯 **最终 SQL 查询**：```\n\nOkay, so I need to help this user by converting their natural language question into an efficient SQL query. Let me start by understanding what they're asking for. The user provided a detailed database schema and specific SQL requirements, so I have to make sure I follow those closely.\n\nThe question is: \"根据武汉兴图新科电子股份有限公司招股意向书，电子信息行业的上游涉及哪些企业？\" Translating that, it's asking which upstream companies are involved in the electronics industry that upstream from WUTXNC.ELG, based on the招股意向书.\n\nFirst, I'll break down the components. They want companies in the upstream of the electronics industry. So, I need to find companies that are in the supply chain or dependencies of the electronics companies. The main company here is WUTXNC.ELG, but I need to find its upstream suppliers.\n\nLooking at the database tables, I see several that might be relevant. The \"基金股票持仓明细\" and \"基金债券持仓明细\" tables are related to mutual funds holding stocks and bonds, but I'm not sure how that ties into the company's upstream. Maybe that's a red herring. The \"基金可转债持仓明细\" also seems off-topic.\n\nThe more relevant tables might be the ones related to the company's financials and holdings. Wait, the user provided a database schema, so I need to check which tables relate to the company's stakeholders or supply chain.\n\nHmm, perhaps the \"基金日行情表\" and \"基金规模变动表\" are related to the company's performance, but again, not directly about upstream companies.\n\nWait, maybe the user is referring to the supply chain within the electronics industry. So, perhaps looking at the \"港股票日行情表\" and \"A股票日行情表\" for stock market data on electronics companies, but that might not directly give upstream suppliers.\n\nAlternatively, maybe the user is interested in the company's stakeholders or major investors, but the question is about upstream companies in the industry, not investors.\n\nWait, perhaps the user wants to find the companies that supply WUTXNC.ELG, so looking at the supply chain, which might be in a different table. But looking at the provided tables, I don't see one that directly links a company to its suppliers. Maybe the tables provided don't include the necessary information for this query.\n\nAlternatively, maybe the user wants to find the companies that are in;",
    "error": "near \"📌\": syntax error"
}
{
    "question": "广州中海达卫星导航技术股份有限公司本次募集资金主要投资哪些项目？",
    "sql": "SELECT\n    f.fund_code,\n    f.fund_name,\n    f manage_type,\n    SUM(p1.fundraising_amount) AS total_funding\nFROM\n    基金基本信息 f\n    LEFT JOIN\n    基金可转债持仓明细 p1\n    ON f.fund_code = p1.fund_code\n    WHERE\n        f.fund_name LIKE '%广州中海达卫星导航技术股份有限公司%'\n    GROUP BY\n    f.fund_code, f.fund_name, f.fund_type\n    ORDER BY\n    total_funding DESC,\n    f.fund_name\n    LIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "我想了解一下红土创新基金管理有限公司2020年成立的混合型基金,其管理费率的平均值是多少?请四舍五入保留小数点两位。",
    "sql": "SELECT\n    F.fund_name,\n    ROUND(Avg(Management_Fee), 2) AS Management_Fee_Avg\nFROM\n    Fund_Basics F\nJOIN\n    Fund_Snapshot_FY2020 A ON F.Fund_Code = A.Fund_Code\nWHERE\n    F.Fund_Code LIKE '%红土创新%'\n    AND F.Fund_Type = '混合型'\n    AND F.Founded_Date LIKE '2020-01-%';",
    "error": "no such table: Fund_Basics"
}
{
    "question": "在2008年，东莞勤上光电股份有限公司在景观亮化半导体照明领域的市场占有率为多少？",
    "sql": "SELECT\n    f.fund_code,\n    f.fund简称,\n    f.管理费Rate,\n    f.托管费Rate\nFROM\n    基金基本信息 f\nJOIN\n    基金股票持仓明细 s ON f.fund_code = s.fund_code\nJOIN\n    A股票日行情表 a ON s.stock_code = a.stock_code\nWHERE\n    a.交易日期 = '2008-12-31'\n    AND a.股票代码 = '002415'\n    AND f.fund简称 = '东莞勤上光电股份有限公司'\n    AND a.行业划分标准 = '景观亮化半导体照明'\n    ORDER BY date DESC\n    LIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "湖南南岭民用爆破器材股份有限公司的控股股东是谁？",
    "sql": "SELECT DISTINCT \n    f1.fund_code AS 基金代码,\n    f1.fund_name AS 基金全称\nFROM \n    基金基本信息 f1\nJOIN \n    基金股票持仓明细 f2 ON f1.fund_code = f2.fund_code\nJOIN \n    基金债券持仓明细 f3 ON f1.fund_code = f3.fund_code\nJOIN \n    基金可转债持仓明细 f4 ON f1.fund_code = f4.fund_code\nJOIN \n    基金日行情表 f5 ON f1.fund_code = f5.fund_code\nJOIN \n    A股票日行情表 f6 ON f1.fund_name LIKE '%A股票%'\nJOIN \n    港股票日行情表 f7 ON f1.fund_name LIKE '%港股票%'\nJOIN \n    A股公司行业划分表 f8 ON f1.fund_name LIKE '%A股公司%'\nWHERE \n    f1.fund_name = '湖南南岭民用爆破器材股份有限公司'\nLIMIT 1;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "在研发方面，上海真兰仪表科技股份有限公司利用哪三地的人才优势，成立研发中心，组建了“三位一体”的研发体系？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f.manager,\n    f.mgrt_funder,\n    f.mgrt_fund,\n    f.fund_type,\n    f.fund_start_date,\n    f.fund_end_date,\n    f.mgrt_fee,\n    f.mgrt_fee,\n    f.mgrt_fee,\n    f.mgrt_fee\nFROM \n    Fund_Behavior f\nJOIN \n    Fund_Mgrt f_mgrt\nON \n    f.fund_code = f_mgrt.fund_code\nJOIN \n    Fund_Funder f_funder\nON \n    f_mgrt.fund_code = f_funder.fund_code\nJOIN \n    Fund_Fund f_fund\nON \n    f_funder.fund_code = f_fund.fund_code\nJOIN \n    Fund_Type f_type\nON \n    f_fund.fund_code = f_type.fund_code\nORDER BY \n    f.fund_start_date DESC,\n    f.fund_end_date DESC,\n    f.fund_code DESC;",
    "error": "no such table: Fund_Behavior"
}
{
    "question": "我想了解博时研究优选灵活配置混合(LOF)A基金,在2021年四季度的季报第3大重股。该持仓股票当个季度的涨跌幅?请四舍五入保留百分比到小数点两位。",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_short_name,\n    s.stock_code AS stock_code,\n    s.stock_name AS stock_name,\n    ROUND(s.movement_percentage, 2) AS movement_percentage\nFROM \n    fund_stocks_holding_min明细 f\nJOIN \n    stock_day行情表 s \nON \n    f.stock_code = s.stock_code\nWHERE \n    f.fund_code = '博时研究优选灵活配置混合LOF A'\n    AND f.fund_short_name = 'LOF'\n    AND f.fundholding_type IN ('股票型基金', '混合型基金')\n    AND f.holding_rank = 3\n    AND f.holding_date >= '2021-09-30'\n    AND f.holding_date <= '2021-12-31'\n    AND s.trade_date >= '2021-09-30'\n    AND s.trade_date <= '2021-12-31';",
    "error": "no such table: fund_stocks_holding_min明细"
}
{
    "question": "我想知道富兰克林国海大中华精选混合(QDII)(美元现汇)在2021年Q2的季报中，该基金的第1大重仓股的代码是什么?",
    "sql": "SELECT DISTINCT fws.fund_code, fws.fund_short_name, fwsReporting.fund ReportingDate, fws.fund_type,\n       fws.fund_management_fees_rate, fws.fund_tchf_fees_rate\nFROM fund_franklin_guoqin_AHJZQDII_emerging markets_fund_info fws\nJOIN fund_franklin_guoqin_AHJZQDII_emerging markets_fund_holding明细 fwh\nON fws.fund_code = fwh.fund_code\nJOIN fund_franklin_guoqin_AHJZQDII_emerging markets_fund_holding明细 fws_holding ON fws.fund_code = fws_holding.fund_code\nJOIN fund_franklin_guoqin_AHJZQDII_emerging markets_fund_holding明细 fws_fund_holding ON fws.fund_code = fws_fund_holding.fund_code\nWHERE fws.reporting_date = '2021-06-30'\n   AND fws.fund_type = '混合型'\n   AND fws.fund_short_name = '富兰克林国海大中华精选混合(QDII)(美元现汇)'\n   AND fws.fund_management_fees_rate IS NOT NULL\n   AND fws.fund_tchf_fees_rate IS NOT NULL\n   AND fws_holding.n_th_largest_share = 1\n   AND fws_holding.stock_name IS NOT NULL\n   AND fws_holding.stock_code LIKE '%.USD' -- Assuming USD codes end with .USD\n   AND fws_fund_holding.fund_code = fws.fund_code\n   AND fws_fund_holdingReporting.fund ReportingDate = fws.reporting_date\n   AND fws_fund_holdingReporting.fund_short_name = fws.fund_short_name\n   AND fws_fund_holdingReporting.fund_type = fws.fund_type\n   AND fws_fund_holdingReporting.fund_management_fees_rate = fws.fund_management_fees_rate\n   AND fws_fund_holdingReporting.fund_tchf_fees_rate = fws.fund_tchf_fees_rate\n   AND fws_holdingReporting.fund_code = fws_holding.fund_code\n   AND f;",
    "error": "near \"fws\": syntax error"
}
{
    "question": "常熟风范电力设备股份有限公司的机器设备成新率是多少？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f manage_type,\n    f management_fees,\n    f.tombus_holders_funds,\n    f.tombus_holders_funds_ratio,\n    f.fund_total_assets,\n    f.fund_total_assets_ratio\nFROM \n    fund_fundamentals f\nJOIN \n    fund_holders f_holders \n    ON \n        f.fund_code = f_holders.fund_code\nJOIN \n    fund_holders f_holders2 \n    ON \n        f_holders.fund_code = f_holders2.fund_code\nWHERE \n    f_fund_holders_fund_name LIKE '%常熟风范电力设备股份有限公司%';",
    "error": "no such table: fund_fundamentals"
}
{
    "question": "2009年、2010年及2011年，海南双成药业股份有限公司销售费用分别为多少？",
    "sql": "SELECT \n    f1.基金代码 AS 公司代码,\n    f1.基金简称 AS 公司名称,\n    f1.管理费(%) AS 管理费率,\n    f1.托管费(%) AS 托管费率\nFROM \n    基金基本信息 f1\nJOIN \n    基金股票持仓明细 f2 ON f1.基金代码 = f2.基金代码\nJOIN \n    基金债券持仓明细 f3 ON f1.基金代码 = f3.基金代码\nJOIN \n    基金可转债持仓明细 f4 ON f1.基金代码 = f4.基金代码\nWHERE \n    f1.基金简称 LIKE '%海南双成药业股份有限公司%'\n    AND YEAR(f1.成立日期) BETWEEN 2009 AND 2011\n    AND f2.基金简称 LIKE '%海南双成药业股份有限公司%'\n    AND f3.基金简称 LIKE '%海南双成药业股份有限公司%'\n    AND f4.基金简称 LIKE '%海南双成药业股份有限公司%'\nORDER BY f1.基金简称 ASC\nLIMIT 100;",
    "error": "near \"(\": syntax error"
}
{
    "question": "内蒙古君正能源化工股份有限公司的法定代表人是谁？",
    "sql": "SELECT DISTINCT u.user_name\nFROM users u\nJOIN a_stocks AS a\nON u.user_id = a.user_id\nWHERE a.stock_name = '内蒙古君正能源化工股份有限公司';",
    "error": "no such table: users"
}
{
    "question": "联化科技股份有限公司的主营业务包括哪两部分？",
    "sql": "SELECT DISTINCT\n    f1.fund_type AS \"主营业务1\"\nFROM\n    Fund_BusinessParts f1\nJOIN\n    Fund_BusinessParts f2 ON f1.fund_code = f2.fund_code\nJOIN\n    Fund_BusinessParts f3 ON f1.fund_code = f3.fund_code\nJOIN\n    Fund_BusinessParts f4 ON f1.fund_code = f4.fund_code\nJOIN\n    Fund_BusinessParts f5 ON f1.fund_code = f5.fund_code\nJOIN\n    Fund_BusinessParts f6 ON f1.fund_code = f6.fund_code\nJOIN\n    Fund_BusinessParts f7 ON f1.fund_code = f7.fund_code\nJOIN\n    Fund_BusinessParts f8 ON f1.fund_code = f8.fund_code\nJOIN\n    Fund_BusinessParts f9 ON f1.fund_code = f9.fund_code\nJOIN\n    Fund_BusinessParts f10 ON f1.fund_code = f10.fund_code\nJOIN\n    Fund_BusinessParts f11 ON f1.fund_code = f11.fund_code\nJOIN\n    Fund_BusinessParts f12 ON f1.fund_code = f12.fund_code\nJOIN\n    Fund_BusinessParts f13 ON f1.fund_code = f13.fund_code\nJOIN\n    Fund_BusinessParts f14 ON f1.fund_code = f14.fund_code\nJOIN\n    Fund_BusinessParts f15 ON f1.fund_code = f15.fund_code\nJOIN\n    Fund_BusinessParts f16 ON f1.fund_code = f16.fund_code\nJOIN\n    Fund_BusinessParts f17 ON f1.fund_code = f17.fund_code\nJOIN\n    Fund_BusinessParts f18 ON f1.fund_code = f18.fund_code\nJOIN\n    Fund_BusinessParts f19 ON f1.fund_code = f19.fund_code\nJOIN\n    Fund_BusinessParts f20 ON f1.fund_code = f20.fund_code\nJOIN\n    Fund_BusinessParts f21 ON f1.fund_code = f21.fund_code\nJOIN\n    Fund_BusinessParts;",
    "error": "no such table: Fund_BusinessParts"
}
{
    "question": "20191231日，宋城演艺在多少只基金的前七大重仓股中？",
    "sql": "SELECT COUNT(DISTINCT f.fund_code) AS distinct_fund_codes\nFROM fund_stocks\nJOIN fund_bonds\nON fund_stocks.fund_code = fund_bonds.fund_code\nJOIN fund_corp_bonds\nON fund_stocks.fund_code = fund_corp_bonds.fund_code\nWHERE\n    fund_stocks.fund_short_name = '宋城演艺'\n    AND transaction_date = '20191231'\n    AND rank = 1\n    OR rank = 2\n    OR rank = 3\n    OR rank = 4\n    OR rank = 5\n    OR rank = 6\n    OR rank = 7;",
    "error": "no such table: fund_stocks"
}
{
    "question": "读者出版传媒股份有限公司的主要纸张供应商有哪些？",
    "sql": "SELECT DISTINCT\n    f1.fund_code,\n    f1.fund_name,\n    f1.fund_manager,\n    f1.fund_type,\n    f1.fund_estdate,\n    f1.fund_maturity_date,\n    f1.fund_management_fee,\n    f1.fund_administration_fee\nFROM \"基金基本信息\" f1\nLEFT JOIN \"基金股票持仓明细\" f2 ON f1.fund_code = f2.fund_code\nLEFT JOIN \"基金债券持仓明细\" f3 ON f1.fund_code = f3.fund_code\nLEFT JOIN \"基金可转债持仓明细\" f4 ON f1.fund_code = f4.fund_code\nLEFT JOIN \"基金日行情表\" f5 ON f1.fund_code = f5.fund_code\nLEFT JOIN \"A股票日行情表\" a1 ON f1.fund_code = a1.stock_code\nLEFT JOIN \"港股票日行情表\" h1 ON f1.fund_code = h1.stock_code\nLEFT JOIN \"基金规模变动表\" f6 ON f1.fund_code = f6.fund_code\nLEFT JOIN \"基金份额持有人结构\" f7 ON f1.fund_code = f7.fund_code\nWHERE f1.fund_name LIKE '%读者出版传媒股份有限公司%';",
    "error": "no such column: f1.fund_code"
}
{
    "question": "2005年、2006年和2007年，宁波立立电子股份有限公司所获政府补助计入当期损益的金额分别占当年利润总额的比例是多少？",
    "sql": "WITH FundPerformanceAS(\n    SELECT \n        f1.fund_code,\n        f1.fund_name,\n        f2.year AS profit_year,\n        f2.total_profit,\n        f2.year AS government_benefit_year,\n        f2.total_benefit,\n        f3.benefit_amount\n    FROM \n        FundBasic inf\n    JOIN \n        FundAnnualReport f2 ON inf.fund_code = f2.fund_code\n    WHERE \n        f2.year BETWEEN '2005' AND '2007'\n    )\n,\nStockDataAS(\n    SELECT \n        s1.stock_code,\n        s1.stock_name,\n        s1.year AS stock_year,\n        s2.benefit_year,\n        s2.benefit_amount,\n        s2.total_profit\n    FROM \n        AStocks a\n    JOIN \n        AStocksFundBenefit f ON a.stock_code = f.stock_code\n    WHERE \n        a.year = '2005' OR a.year = '2006' OR a.year = '2007'\n)\n,\nBenefitDataAS(\n    SELECT \n        b.benefit_year,\n        b.benefit_amount,\n        b.total_profit\n    FROM \n        FundPerformance f1\n    CROSS JOIN \n        StockData f2\n    WHERE \n        f1.year = f2.year\n        AND f1.benefit_year = f2.benefit_year\n)\nSELECT \n    (benefit_amount / total_profit) * 100 AS percentage\nFROM \n    BenefitData\nWHERE \n    year >= '2005'\n    AND year <= '2007'\n    AND benefit_year = '宁波立立电子股份有限公司'\nORDER BY year DESC\nLIMIT 3;",
    "error": "near \"SELECT\": syntax error"
}
{
    "question": "在20190211，按照中信行业分类的行业划分标准，哪个一级行业的A股公司数量最多？",
    "sql": "SELECT a.行业划分标准, b.一级行业名称, COUNT(*) AS 数量\nFROM A股票日行情表 a\nJOIN A股公司行业划分表 b ON a.股票代码 = b.股票代码\nWHERE a.交易日期 = '20190211'\n  AND b.行业划分标准 = '中信行业分类标准'\nGROUP BY a.一级行业名称\nORDER BY 数量 DESC\nLIMIT 1;",
    "error": "no such column: a.行业划分标准"
}
{
    "question": "帮我查一下在2019年，代码为603199的A股股票今开盘高于昨收盘的天数？",
    "sql": "SELECT COUNT(DISTINCT dt)\nFROM (\n    SELECT date AS dt\n    FROM A股票日行情表 AS a\n    WHERE \n        a.股票代码 = '603199' \n        AND date >= '2019-01-01' \n        AND date <= '2019-12-31' \n        AND a.今开盘(元) > a.昨收盘(元)\n    ORDER BY date\n) AS t\nORDER BY t.dtp descend;",
    "error": "near \"(\": syntax error"
}
{
    "question": "帮我查一下鹏扬景科混合A基金在20201126的资产净值和单位净值是多少?",
    "sql": "SELECT\n    f1.fund_code AS 基金代码,\n    f1.trade_date AS 交易日期,\n    f1.unite_value AS 单位净值,\n    f1 assets_value AS 资产净值\nFROM\n    基金日行情表 f1\nJOIN\n    A股票日行情表 f2\n    ON f1.fund_code = f2.fund_code\n    AND f1.trade_date = f2.trade_date\nJOIN\n    A股公司行业划分表 f3\n    ON f1.fund_code = f3.fund_code\n    AND f1.trade_date >= f3.交易日期\nJOIN\n    基金股票持仓明细 f4\n    ON f1.fund_code = f4.fund_code\n    AND f1.trade_date >= f4.holding_date\nJOIN\n    基金债券持仓明细 f5\n    ON f1.fund_code = f5.fund_code\n    AND f1.trade_date >= f5.holding_date\nJOIN\n    基金可转债持仓明细 f6\n    ON f1.fund_code = f6.fund_code\n    AND f1.trade_date >= f6.holding_date\nWHERE\n    f1.fund_code = '鹏扬景科混合A'\n    AND f1.trade_date = '20201126'\nORDER BY\n    f1.trade_date DESC;",
    "error": "near \"AS\": syntax error"
}
{
    "question": "请问股票代码为301005的股票在2021年内日成交量低于该股票当年平均日成交量的有多少个交易日？",
    "sql": "SELECT COUNT(*) AS trading_days\nFROM (\n    SELECT \n        date AS trade_date,\n        stock_code,\n        SUM(成交金额(元)) AS total_volume\n    FROM A股票日行情表\n    WHERE stock_code = '301005' AND year(trade_date) = 2021\n    GROUP BY date, stock_code\n) AS stock_volume\nWHERE total_volume < (SELECT SUM(total_volume) FROM stock_volume)\nORDER BY trade_date DESC\nLIMIT 100;",
    "error": "no such table: stock_volume"
}
{
    "question": "请查询：在2020的年度报告中，个人投资者持有基金份额大于机构投资者持有基金份额的基金属于混合型类型的有几个。",
    "sql": "SELECT COUNT(fund_code)\nFROM (\n    SELECT fund_code\n    FROM基金规模变动表 fund规模变动表 a\n    JOIN基金持有人结构基金持有结构表 b ON a.fund_code = b.fund_code\n    WHERE a.报告类型 = '年度报告' AND a.报告期期初基金总份额 > 0\n    AND a.定期报告所属年度 = 2020\n    AND b.个人投资者持有的基金份额 > b.机构投资者持有的基金份额\n) AS t\nWHERE t.基金类型 = '混合型';",
    "error": "near \"fund规模变动表\": syntax error"
}
{
    "question": "帮我查一下在2020年，代码为002868的A股股票今开盘高于昨收盘的天数？",
    "sql": "SELECT COUNT(*) AS Trading_Days\nFROM AStocks\nWHERE \n    年份 = '2020' AND \n    基金代码 = '002868' AND \n    今开盘 > 昨收盘;",
    "error": "no such table: AStocks"
}
{
    "question": "森赫电梯股份有限公司的主营业务是什么？",
    "sql": "WITH fund_stock_holding AS (\n    SELECT\n        distinct f1.fund_code,\n        f1.fund_short_name AS fund_short_name,\n        f1.fund_type,\n        f1.start_date,\n        f1.end_date,\n        f1.mgr费率,\n        f1.tch费率\n    FROM\n        基金股票持仓明细 f1\n    WHERE\n        f1.fund_short_name = '森赫电梯股份有限公司'\n        AND f1.fund_type IN ('股票型', '混合型')\n        AND f1.mgr费率 != 'NULL'\n        AND f1.tch费率 != 'NULL'\n),\nfund_bond_holding AS (\n    SELECT\n        distinct f2.fund_code,\n        f2.fund_short_name AS fund_short_name,\n        f2.bond_type,\n        f2.bond_name,\n        f2.hold_num,\n        f2.market,\n        f2.country,\n        f2.report_type\n    FROM\n        基金债券持仓明细 f2\n    WHERE\n        f2.fund_short_name = '森赫电梯股份有限公司'\n        AND f2.bond_type IN ('债券型', '货币市场基金')\n        AND f2.hold_num != 'NULL'\n        AND f2.market IN (' reminding_securities市场', ' reminding_countrystd市场')\n        AND f2.country IN ('中国', '其他国家')\n        AND f2.report_type IN ('一级', '二级')\n),\nfund_fund转债_holding AS (\n    SELECT\n        distinct f3.fund_code,\n        f3.fund_short_name AS fund_short_name,\n        f3.issuance_type,\n        f3.issuance_name,\n        f3.hold_num,\n        f3.market,\n        f3.country,\n        f3.report_type\n    FROM\n        基金可转债持仓明细 f3\n    WHERE\n        f3.fund_short_name = '森赫电梯股份有限公司'\n        AND f3.issuance_type IN ('可转债', '可交换债')\n        AND f3.hold_num != 'NULL'\n        AND f3.market IN (' reminding_securities市场', ' reminding_countrystd市场')\n        AND f3.country IN ('中国', '其他国家')\n        AND f3.report_type IN ('一级', '二级')\n),\nfund_daily;",
    "error": "near \";\": syntax error"
}
{
    "question": "多晶硅成本约占宁波立立电子股份有限公司2007年度产品原材料成本的多大比例？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f.start_date,\n    f.end_date,\n    f asset_total,\n    f.fund_total_shares,\n    f.fund_total_shares - f.fund_total_shares_at_start as total_shares,\n    f.fund_total_shares_at_start,\n    f.fund_total_shares_at_end,\n    f.fund_total_shares_at_start * f.fund_rate_of_return AS total_return,\n    f.fund_total_shares_at_end * f.fund_rate_of_return AS total_return_end\nFROM \n    fund_daily_statistics f\nJOIN \n    fund_daily_statistics g ON f.fund_code = g.fund_code\n    AND f.start_date = g.start_date\n    AND f.end_date = g.end_date\n    AND f.fund_total_shares_at_start = g.fund_total_shares_at_start\n    AND f.fund_total_shares_at_end = g.fund_total_shares_at_end\n    AND f.fund_rate_of_return = g.fund_rate_of_return\n    ORDER BY f.start_date DESC\nLIMIT 100;",
    "error": "no such table: fund_daily_statistics"
}
{
    "question": "请查询：在20191129，属于申万二级仪器仪表行业的A股股票，它们的平均成交金额是多少？小数点后保留不超过5位。",
    "sql": "SELECT\n    substr(a股票日行情表.成交金额(元), 0, 15) AS 成交金额(元)\nFROM\n    A股票日行情表 a\nJOIN\n    A股公司行业划分表 b ON a.股票代码 = b.股票代码\nWHERE\n    a.交易日期 = '20191129'\n    AND b.一级行业名称 = '申万二级仪器仪表'\n    AND substr(a.成交金额(元), 0, 15) LIKE '%.00000' OR substr(a.成交金额(元), 0, 15) LIKE '%.00001' OR substr(a.成交金额(元), 0, 15) LIKE '%.00002' OR substr(a.成交金额(元), 0, 15) LIKE '%.00003' OR substr(a.成交金额(元), 0, 15) LIKE '%.00004';",
    "error": "near \"(\": syntax error"
}
{
    "question": "易方达基金管理有限公司2019年成立了多少基金?",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS num_funds\nFROM \"基金基本信息\" f1\nJOIN \"基金股票持仓明细\" f2 ON f1.fund_code = f2.fund_code\nJOIN \"基金债券持仓明细\" f3 ON f1.fund_code = f3.fund_code\nJOIN \"基金可转债持仓明细\" f4 ON f1.fund_code = f4.fund_code\nWHERE f1.fund年份 = '2019'\nORDER BY f1.fund年份 DESC\nLIMIT 100;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "嘉实基金管理有限公司管理的债券型产品的数量有多少?",
    "sql": "SELECT COUNT(DISTINCT f.fund_code) AS fund_count\nFROM fund_bonds f\nWHERE fund_manager = '嘉实基金管理有限公司'\n  AND fund_type = '债券型';",
    "error": "no such table: fund_bonds"
}
{
    "question": "我想知道股票002720在申万行业分类下的二级行业是什么？用最新的数据。",
    "sql": "📌 任务描述：\n            你是一名 SQL 生成专家，需要将用户的自然语言问题转换为 **高效且准确的 SQL 查询**。\n            \n            📊 **数据库模式（Schema）**：\n            ▌ 表名：基金基本信息\n    ▪ 基金代码 (TEXT)\n    ▪ 基金全称 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 管理人 (TEXT)\n    ▪ 托管人 (TEXT)\n    ▪ 基金类型 (TEXT)\n    ▪ 成立日期 (TEXT)\n    ▪ 到期日期 (TEXT)\n    ▪ 管理费率 (TEXT)\n    ▪ 托管费率 (TEXT)\n\n▌ 表名：基金股票持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 股票代码 (TEXT)\n    ▪ 股票名称 (TEXT)\n    ▪ 数量 (REAL)\n    ▪ 市值 (REAL)\n    ▪ 市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金债券持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 债券类型 (TEXT)\n    ▪ 债券名称 (TEXT)\n    ▪ 持债数量 (REAL)\n    ▪ 持债市值 (REAL)\n    ▪ 持债市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金可转债持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 对应股票代码 (TEXT)\n    ▪ 债券名称 (TEXT)\n    ▪ 数量 (REAL)\n    ▪ 市值 (REAL)\n    ▪ 市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金日行情表\n    ▪ 基金代码 (TEXT)\n    ▪ 交易日期 (TEXT)\n    ▪ 单位净值 (REAL)\n    ▪ 复权单位净值 (REAL)\n    ▪ 累计单位净值 (REAL)\n    ▪ 资产净值 (REAL)\n\n▌ 表名：A股票日行情表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日 (TEXT)\n    ▪ 昨收盘(元) (REAL)\n    ▪ 今开盘(元) (REAL)\n    ▪ 最高价(元) (REAL)\n    ▪ 最低价(元) (REAL)\n    ▪ 收盘价(元) (REAL)\n    ▪ 成交量(股) (REAL)\n    ▪ 成交金额(元) (REAL)\n\n▌ 表名：港股票日行情表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日 (TEXT)\n    ▪ 昨收盘(元) (REAL)\n    ▪ 今开盘(元) (REAL)\n    ▪ 最高价(元) (REAL)\n    ▪ 最低价(元) (REAL)\n    ▪ 收盘价(元) (REAL)\n    ▪ 成交量(股) (REAL)\n    ▪ 成交金额(元) (REAL)\n\n▌ 表名：A股公司行业划分表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日期 (TEXT)\n    ▪ 行业划分标准 (TEXT)\n    ▪ 一级行业名称 (TEXT)\n    ▪ 二级行业名称 (TEXT)\n\n▌ 表名：基金规模变动表\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 公告日期 (TIMESTAMP)\n    ▪ 截止日期 (TIMESTAMP)\n    ▪ 报告期期初基金总份额 (REAL)\n    ▪ 报告期基金总申购份额 (REAL)\n    ▪ 报告期基金总赎回份额 (REAL)\n    ▪ 报告期期末基金总份额 (REAL)\n    ▪ 定期报告所属年度 (INTEGER)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金份额持有人结构\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 公告日期 (TIMESTAMP)\n    ▪ 截止日期 (TIMESTAMP)\n    ▪ 机构投资者持有的基金份额 (REAL)\n    ▪ 机构投资者持有的基金份额占总份额比例 (REAL)\n    ▪ 个人投资者持有的基金份额 (REAL)\n    ▪ 个人投资者持有的基金份额占总份额比例 (REAL)\n    ▪ 定期报告所属年度 (INTEGER)\n    ▪ 报告类型 (TEXT)\n\n            📝 **SQL 生成要求：**\n            1️⃣ **仅返回 SQL 代码**，不包含任何额外的自然语言解释。  \n2️⃣ SQL **应符合 ANSI 标准**，或可根据数据库类型（`MySQL` / `PostgreSQL` / `SQL Server`）调整语法。  \n3️⃣ **正确使用 `JOIN` 进行表关联**，避免冗余查询。  \n4️⃣ 对于涉及 **聚合操作**（如 `COUNT`、`SUM`、`AVG`），**自动补充 `GROUP BY`**，避免 SQL 语法错误。  \n5️⃣ **字段应加上表前缀**（如 `users.name` 而不是 `name`）以避免歧义。  \n6️⃣ **使用索引字段进行过滤**（如 `fund_code`、`stock_code`），提高查询效率。  \n7️⃣ **对于时间序列查询，自动补充 `ORDER BY date_column DESC` 以返回最新数据**。  \n8️⃣ **合理使用 `LIMIT` 避免查询返回过多数据**（如默认 `LIMIT 100`）。  \n9️⃣ **复杂查询推荐使用 `WITH` 语句（CTE）或子查询**，提高可读性和维护性。  \n🔟 **特别说明**：对于包含括号的字段名（例如 \"成交金额(元)\"），请确保在生成 SQL 时使用适当的引用符号（如反引号、方括号或双引号，依据所用数据库的具体要求），以防止解析错误。\n\n            🛠️ 根据以上信息（包括数据库模式、SQL生成要求等），\n            请将以下问题转换为SQL语句：\n            我想知道股票002720在申万行业分类下的二级行业是什么？用最新的数据。\n            🎯 **最终 SQL 查询**：请提供一个清晰的 SQL 查询示例，包含 **详细注释说明**，并解释该查询的作用。\n\nOkay, I need to help the user by converting their natural language question into an efficient and accurate SQL query based on the provided database schema. Let me break down the problem step by step.\n\nFirst, the user's question is: \"我想知道股票002720在申万行业分类下的二级行业是什么？用最新的数据。\" Translating this, they want to find the二级行业 (secondary industry classification) for the stock 002720 using the most recent data.\n\nLooking at the database schema, I see that there are several tables. The relevant ones seem to be the A股票日行情表 (A stock daily行情 table), the A股公司行业划分表 (A stock company industry division table), and the基金股票持仓明细 (fund stock holding details).\n\nWait, the stock code is 002720, which I believe is a Chinese stock listed on the Hong Kong market, so the relevant tables for this stock would likely be the港股票日行情表 (Hong Kong stock daily行情表) and the A股公司行业划分表.\n\nBut let me check the tables again. The A股票日行情表 seems to be for A-listed stocks in China, while the港股票日行情表 is for Hong Kong-listed stocks. Since 002720 is a Hong Kong-listed stock, I should use the港股票日行情表.\n\nNow, I need to find the申万行业分类 (Shanwansheng industry classification) and its二级行业 (secondary industry). The A股公司行业划分表 (A stock company industry division table) has the一级和二级行业 information. However, this table might be for A-listed companies.\n\nWait, I'm a bit confused. The user is asking about a specific stock's industry classification. So I need to link the stock's information with its industry.\n\nPerhaps the process is: first, find the stock's holding in the基金股票持仓明细 tables (both bond and bond detailed), then find the fund's information in the基金基本信息 table, and then find the fund's industry information from the基金公司行业划分表.\n\nWait, but the user's question is about the stock's industry, not the fund. So maybe the correct approach is to find the fund's holding of this stock,;",
    "error": "near \"📌\": syntax error"
}
{
    "question": "请帮我查询在截止2021-03-31的基金定期报告中，基金总赎回份额为零的基金有几个？",
    "sql": "SELECT COUNT(fund_code) AS total_funds\nFROM fund规模变动表\nWHERE 报告期基金总赎回份额 = 0\n  AND 公告日期 <= '2021-03-31';",
    "error": "no such table: fund规模变动表"
}
{
    "question": "我想知道股票600508在申万行业分类下的二级行业是什么？用最新的数据。",
    "sql": "📌 任务描述：\n            你是一名 SQL 生成专家，需要将用户的自然语言问题转换为 **高效且准确的 SQL 查询**。\n            \n            📊 **数据库模式（Schema）**：\n            ▌ 表名：基金基本信息\n    ▪ 基金代码 (TEXT)\n    ▪ 基金全称 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 管理人 (TEXT)\n    ▪ 托管人 (TEXT)\n    ▪ 基金类型 (TEXT)\n    ▪ 成立日期 (TEXT)\n    ▪ 到期日期 (TEXT)\n    ▪ 管理费率 (TEXT)\n    ▪ 托管费率 (TEXT)\n\n▌ 表名：基金股票持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 股票代码 (TEXT)\n    ▪ 股票名称 (TEXT)\n    ▪ 数量 (REAL)\n    ▪ 市值 (REAL)\n    ▪ 市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金债券持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 债券类型 (TEXT)\n    ▪ 债券名称 (TEXT)\n    ▪ 持债数量 (REAL)\n    ▪ 持债市值 (REAL)\n    ▪ 持债市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金可转债持仓明细\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 持仓日期 (TEXT)\n    ▪ 对应股票代码 (TEXT)\n    ▪ 债券名称 (TEXT)\n    ▪ 数量 (REAL)\n    ▪ 市值 (REAL)\n    ▪ 市值占基金资产净值比 (REAL)\n    ▪ 第N大重仓股 (INTEGER)\n    ▪ 所在证券市场 (TEXT)\n    ▪ 所属国家(地区) (TEXT)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金日行情表\n    ▪ 基金代码 (TEXT)\n    ▪ 交易日期 (TEXT)\n    ▪ 单位净值 (REAL)\n    ▪ 复权单位净值 (REAL)\n    ▪ 累计单位净值 (REAL)\n    ▪ 资产净值 (REAL)\n\n▌ 表名：A股票日行情表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日 (TEXT)\n    ▪ 昨收盘(元) (REAL)\n    ▪ 今开盘(元) (REAL)\n    ▪ 最高价(元) (REAL)\n    ▪ 最低价(元) (REAL)\n    ▪ 收盘价(元) (REAL)\n    ▪ 成交量(股) (REAL)\n    ▪ 成交金额(元) (REAL)\n\n▌ 表名：港股票日行情表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日 (TEXT)\n    ▪ 昨收盘(元) (REAL)\n    ▪ 今开盘(元) (REAL)\n    ▪ 最高价(元) (REAL)\n    ▪ 最低价(元) (REAL)\n    ▪ 收盘价(元) (REAL)\n    ▪ 成交量(股) (REAL)\n    ▪ 成交金额(元) (REAL)\n\n▌ 表名：A股公司行业划分表\n    ▪ 股票代码 (TEXT)\n    ▪ 交易日期 (TEXT)\n    ▪ 行业划分标准 (TEXT)\n    ▪ 一级行业名称 (TEXT)\n    ▪ 二级行业名称 (TEXT)\n\n▌ 表名：基金规模变动表\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 公告日期 (TIMESTAMP)\n    ▪ 截止日期 (TIMESTAMP)\n    ▪ 报告期期初基金总份额 (REAL)\n    ▪ 报告期基金总申购份额 (REAL)\n    ▪ 报告期基金总赎回份额 (REAL)\n    ▪ 报告期期末基金总份额 (REAL)\n    ▪ 定期报告所属年度 (INTEGER)\n    ▪ 报告类型 (TEXT)\n\n▌ 表名：基金份额持有人结构\n    ▪ 基金代码 (TEXT)\n    ▪ 基金简称 (TEXT)\n    ▪ 公告日期 (TIMESTAMP)\n    ▪ 截止日期 (TIMESTAMP)\n    ▪ 机构投资者持有的基金份额 (REAL)\n    ▪ 机构投资者持有的基金份额占总份额比例 (REAL)\n    ▪ 个人投资者持有的基金份额 (REAL)\n    ▪ 个人投资者持有的基金份额占总份额比例 (REAL)\n    ▪ 定期报告所属年度 (INTEGER)\n    ▪ 报告类型 (TEXT)\n\n            📝 **SQL 生成要求：**\n            1️⃣ **仅返回 SQL 代码**，不包含任何额外的自然语言解释。  \n2️⃣ SQL **应符合 ANSI 标准**，或可根据数据库类型（`MySQL` / `PostgreSQL` / `SQL Server`）调整语法。  \n3️⃣ **正确使用 `JOIN` 进行表关联**，避免冗余查询。  \n4️⃣ 对于涉及 **聚合操作**（如 `COUNT`、`SUM`、`AVG`），**自动补充 `GROUP BY`**，避免 SQL 语法错误。  \n5️⃣ **字段应加上表前缀**（如 `users.name` 而不是 `name`）以避免歧义。  \n6️⃣ **使用索引字段进行过滤**（如 `fund_code`、`stock_code`），提高查询效率。  \n7️⃣ **对于时间序列查询，自动补充 `ORDER BY date_column DESC` 以返回最新数据**。  \n8️⃣ **合理使用 `LIMIT` 避免查询返回过多数据**（如默认 `LIMIT 100`）。  \n9️⃣ **复杂查询推荐使用 `WITH` 语句（CTE）或子查询**，提高可读性和维护性。  \n🔟 **特别说明**：对于包含括号的字段名（例如 \"成交金额(元)\"），请确保在生成 SQL 时使用适当的引用符号（如反引号、方括号或双引号，依据所用数据库的具体要求），以防止解析错误。\n\n            🛠️ 根据以上信息（包括数据库模式、SQL生成要求等），\n            请将以下问题转换为SQL语句：\n            我想知道股票600508在申万行业分类下的二级行业是什么？用最新的数据。\n            🎯 **最终 SQL 查询**：```\n\nOkay, I need to help the user convert their natural language question into an efficient and accurate SQL query. Let's break down the problem step by step.\n\nThe user wants to know the stock 600508's二级行业 in the申万 hierarchy using the latest data. So, the goal is to find the二级行业 classification for this specific stock.\n\nFirst, I'll look at the available tables. There's an A股票日行情表, which has stock codes and their daily information. But this table mainly provides stock prices and volumes, not industry classifications. So, I need a table that links stocks to their industries.\n\nThe A股票日行情表 doesn't have the industry info, so I should check the other tables. The A股公司行业划分表 seems relevant. It has stock codes, transaction dates, and both一级和二级行业名称. Perfect, this table will help me get the industry hierarchy.\n\nNow, the user is interested in a specific stock, 600508. So, I need to find the二级行业 for this stock. Since the query is specific, I'll use a WHERE clause to filter for fund_code or stock_code. Wait, in the A股票表, the relevant field is stock_code, right? So, I'll use stock_code = '600508'.\n\nNext, I need to get the二级行业名称. The table has一级行业名称 and二级行业名称. So, I'll select these fields where the stock_code matches. I'll also want to get the交易日期 to ensure it's the latest data. To get the latest date, I'll use the MAX function on the交易日期.\n\nI should also consider the database schema. The stock_code is TEXT, so I'll enclose it in double quotes in the SQL query. The industry names are TEXT as well, so no special quoting is needed unless the database requires it. But since the user mentioned using appropriate quotes for fields with parentheses, I'll stick to standard SQL syntax.\n\nPutting it all together, I'll write a SELECT statement that retrieves the一级行业名称 and二级行业名称 from A股公司行业划分表, where stock_code is '600508' and交易日期 is the maximum available. This should give the user the most recent classification for the stock.\n\nI should also check if there are any indexes on stock_code or交易日期 to optimize the query, but the user didn;",
    "error": "near \"📌\": syntax error"
}
{
    "question": "森赫电梯股份有限公司是否有技术创新方面的认定称号？是什么？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f manage_type\nFROM \n    fund_bond持仓明细 f\nLEFT JOIN \n    fund_equity持仓明细 e ON f.fund_code = e.fund_code\nWHERE \n    e.fund_short_name = '森赫电梯股份有限公司'\n    AND f.manage_type IN ('创新型基金', '成长型基金')\n    AND e.第N大重仓股 = 1\nORDER BY \n    f.fund_code;",
    "error": "no such table: fund_bond持仓明细"
}
{
    "question": "我想知道2020年的年度报告中，机构投资者持有的份额占比超过30%的基金有多少，并且他们总共持有了多少?记得帮我保留两位小数。",
    "sql": "SELECT \n    COUNT(DISTINCT f1.fund_code) AS distinct_fund_count,\n    SUM(f2.机构投资者持有的基金份额) AS total_shares\nFROM \n    基金规模变动表 f1\nJOIN \n    基金持有人结构 f2 \nON \n    f1.fund_code = f2.fund_code\nWHERE \n    f1.定期报告所属年度 = 2020\n    AND f2.机构投资者持有的基金份额 / f2.总份额 > 30%\n    AND f1.基金类型 IN ('股票型', '混合型')\n    AND f2.基金类型 = f1.基金类型\nORDER BY \n    total_shares DESC\nLIMIT 100;",
    "error": "near \"AND\": syntax error"
}
{
    "question": "珠海健帆生物科技股份有限公司的哪些产品被认定为广东省高新技术产品？",
    "sql": "SELECT\n    f.fund_code,\n    f.fund_name,\n    f.fund_type,\n    f.mgr,\n    f托管人,\n    f.管理费率,\n    f.托管费率\nFROM\n    基金基本信息 f\nJOIN\n    基金可转债持仓明细 w ON f.fund_code = w.fund_code\nJOIN\n    基金债券持仓明细 b ON f.fund_code = b.fund_code\nJOIN\n    基金股票持仓明细 s ON f.fund_code = s.fund_code\nJOIN\n    基金日行情表 d ON f.fund_code = d.fund_code\nWHERE\n    f.fund简称 LIKE '%珠健生%'\n    AND (w.对应股票代码 LIKE '%139000%' OR b.bond_type LIKE '%国债%' OR s.stock_code LIKE '%603000%')\n    AND f.基金类型 IN ('股票型', '债券型', '混合型')\n    AND f.管理费率 > 0\n    AND f.托管费率 > 0\n    AND f.成立日期 > '2022-01-01'\n    AND f.到期日期 IS NULL\n    AND f.管理费率 <= f.托管费率\n    AND f.基金简称 LIKE '%珠健生%'\n    AND f.基金简称 LIKE '%健帆%'\nORDER BY f.fund_type DESC,\n        f.成立日期 DESC,\n        f.到期日期 DESC,\n        f.管理费率 DESC,\n        f.托管费率 DESC,\n        f.单位净值 DESC,\n        f.累计单位净值 DESC,\n        f.资产净值 DESC\nLIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "博时基金管理有限公司管理的股票型产品的数量有多少?",
    "sql": "SELECT COUNT(DISTINCT fund_code) AS managed_count\nFROM fund_stocks\nWHERE fund_manager = '博时基金管理有限公司'\nAND fund_type = '股票型';",
    "error": "no such table: fund_stocks"
}
{
    "question": "20211207日，成交金额最大的前三家上市公司的股票代码是什么？按成交金额从大到小给出",
    "sql": "SELECT \n    s.stock_code \nFROM \n    A股票日行情表 s \nWHERE \n    s.成交金额(元) = (\n        SELECT \n            MAX(成交金额(元)) \n        FROM \n        A股票日行情表 \n        WHERE \n        交易日期 = '20211207'\n    )\nORDER BY \n    s.成交金额(元) DESC \nLIMIT 3;",
    "error": "near \"(\": syntax error"
}
{
    "question": "深圳信立泰药业股份有限公司专门的研发机构信立泰技术中心工作人员中，多大比例的人员为本科以上学历？",
    "sql": "SELECT \n    COUNT(CASE WHEN education_level = '本科及以上' THEN 1 END) AS educated_ratio,\n    (COUNT(CASE WHEN education_level = '本科及以上' THEN 1 END) / \n     COUNT(CASE WHEN education_level = '不限' THEN 1 END)) * 100 AS percentage\nFROM \n    employees\nWHERE \n    manager = '信立泰技术中心' AND \n    department = '研究开发部';",
    "error": "no such table: employees"
}
{
    "question": "请帮我查询下股票代码为300873的股票在2021年内最高日收盘价是多少？",
    "sql": "SELECT MAX(`成交金额(元)`) AS max_close_price\nFROM `A股票日行情表` a\nJOIN `港股票日行情表` b ON a.`股票代码` = b.`股票代码`\nWHERE a.`股票代码` = '300873' AND a.`交易日` >= '2021-01-01' AND a.`交易日` <= '2021-12-31';",
    "error": "ambiguous column name: 成交金额(元)"
}
{
    "question": "请帮我计算，代码为000798的股票，2020年一年持有的年化收益率有多少？百分数请保留两位小数。年化收益率定义为：（（有记录的一年的最终收盘价-有记录的一年的年初当天开盘价）/有记录的一年的当天开盘价）* 100%。",
    "sql": "SELECT \n    ( (final_close - initial_open) / initial_open ) * 100 AS yearized_return\nFROM (\n    SELECT \n        000798 AS fund_code,\n        MIN(opening_price) AS initial_open,\n        MAX(close_price) AS final_close\n    FROM \n        A股票日行情表\n    WHERE \n        股票代码 = '000798'\n        AND 交易日期 BETWEEN '2020-01-01' AND '2020-12-31'\n) AS annual_return_calculation;",
    "error": "no such column: opening_price"
}
{
    "question": "在20210630的年报(含半年报)中，华夏中债1-3年政策性金融债指数C基金的债券持仓,其持有最大仓位的债券类型是什么?",
    "sql": "WITH bond_counts AS (\n    SELECT bond_type, \n           COUNT(*) AS total_count \n           FROM fund_bonds \n           WHERE \n               fund_code = '华夏中债1-3年政策性金融债指数C基金' \n               AND holding_date = '20210630'\n)\nSELECT bond_type FROM bond_counts \nORDER BY total_count DESC \nLIMIT 1;",
    "error": "no such table: fund_bonds"
}
{
    "question": "请查询：在20190510，属于申万二级餐饮行业的A股股票，它们的平均成交金额是多少？小数点后保留不超过5位。",
    "sql": "SELECT\n    s.成交金额(元) AS 平均成交金额\nFROM\n    A股票日行情表 AS a\nJOIN\n    A股公司行业划分表 AS b\nON\n    a.股票代码 = b.股票代码\nWHERE\n    a.交易日期 = '20190510' AND\n    b.行业划分标准 = '申万二级餐饮行业' AND\n    a.股票代码 LIKE '%A股';",
    "error": "near \"(\": syntax error"
}
{
    "question": "中国铁路通信信号股份有限公司提供轨道交通控制系统全产业链上的产品及服务，主要业务包括哪些？",
    "sql": "SELECT DISTINCT fund简称 AS '基金简称'\nFROM 基金基本信息 fund\nJOIN 基金股票持仓明细 pos ON fund.基金代码 = pos.基金代码\nJOIN 基金债券持仓明细 bond ON fund.基金代码 = bond.基金代码\nJOIN 基金可转债持仓明细 cba ON fund.基金代码 = cba.基金代码\nWHERE fund简称 LIKE '%中国铁路通信信号股份有限公司%';",
    "error": "no such column: fund简称"
}
{
    "question": "请帮我查询下在2020年, 农银汇理基金管理有限公司管理的债券型基金中，持有过同业存单的基金有多少只？",
    "sql": "SELECT COUNT(DISTINCT f.fund_code) AS bond_fund_count\nFROM fund_bonds\nJOIN fund_fundamentals f ON f.fund_code = fund_bonds.fund_code\nWHERE f.fund_year = '2020'\n  AND fund_bonds.bond_type = '债券型'\n  AND fund_bonds.holdings_included = '同业存单';",
    "error": "no such table: fund_bonds"
}
{
    "question": "在2021年12月年报(含半年报)中，惠升惠民混合A基金持有市值最多的前10只股票中，所在证券市场是中国香港证券交易所的有几个？",
    "sql": "SELECT COUNT(*) AS count\nFROM (\n    SELECT \n        stock_name,\n        COUNT(*) AS frequency\n    FROM \n        fund_stocks_holding明细\n    WHERE \n        fund_code = '惠升惠民混合A基金' AND \n        year(announced_date) = 2021\n    GROUP BY \n        stock_name\n    HAVING \n        frequency > 0\n) AS holding_stocks\nWHERE \n    stock市场 = '中国香港证券交易所'\nORDER BY \n    count DESC\nLIMIT 10;",
    "error": "no such table: fund_stocks_holding明细"
}
{
    "question": "报告期内确成硅化学股份有限公司 _出口退税率为多少？",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f.mgr,\n    f.mgrt,\n    f.fund_type,\n    f.issuing_date,\n    f.maturity_date,\n    f.mgr费率,\n    f.mgrt费率\nFROM \n    基金基本信息 f\nJOIN \n    基金股票持仓明细 s ON f.fund_code = s.fund_code\nWHERE \n    s.stock_name = '硅化学股份有限公司'\n    AND f.issuing_date <= f.maturity_date\n    AND f.issuing_date >= date_sub(f.maturity_date, interval 1 year)\n    AND f.issuing_date >= date_sub(f.maturity_date, interval 1 year)\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1年) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1年) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1年) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1年) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1年) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1年) AND f.maturity_date\n    AND;",
    "error": "near \"1\": syntax error"
}
{
    "question": "2021年年度报告里，凯石基金管理有限公司管理的基金中，机构投资者持有份额比个人投资者多的基金有多少只?",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS机构投资者持有份额多的基金数量\nFROM基金规模变动表 f1\nJOIN基金持有人结构 f2 ON f1.fund_code = f2.fund_code\nWHERE f2.机构投资者持有的基金份额 > f2.个人投资者持有的基金份额\nAND f1.报告类型 IN ('年度报告', '半年度报告');",
    "error": "near \"FROM基金规模变动表\": syntax error"
}
{
    "question": "20200923日，一级行业为建筑的股票的成交量合计是多少？取整。",
    "sql": "SELECT ROUND(SUM(成交量(股) * 成交金额(元)), 0) AS 成交额合计\nFROM A股票日行情表 AS a\nJOIN A股公司行业划分表 AS b ON a.股票代码 = b.股票代码\nWHERE a.交易日期 = '20200923' AND b.一级行业名称 = '建筑';",
    "error": "no such column: 元"
}
{
    "question": "除浙江双飞无油轴承股份有限公司外，具有规模的自润滑轴承生产企业还有哪些？",
    "sql": "SELECT DISTINCT fund_code, fund_name\nFROM fund_stocks\nWHERE fund_code IN (\n    SELECT fund_code \n    FROM fund_stocks \n    WHERE fund_code LIKE '%双飞%'\n    ORDER BY fund_code DESC\n    LIMIT 1\n)\nORDER BY fund_code;",
    "error": "no such table: fund_stocks"
}
{
    "question": "请查询在20190115日期，中信行业分类下轻工制造一级行业中，当日收盘价波动最大（即最高价与最低价之差最大）的股票代码是什么？",
    "sql": "SELECT stock_code\nFROM A股票日行情表 a\nJOIN A股票日行情表 b ON a.交易日 = '20190115' AND a.股票代码 = b.股票代码\nWHERE a.行业划分标准 = '中信行业分类' AND a.一级行业名称 = '轻工制造'\nORDER BY (a.最高价 - a.最低价) DESC\nLIMIT 1;",
    "error": "no such column: stock_code"
}
{
    "question": "查询下基金代码008295的基金，它的管理费率是？",
    "sql": "SELECT management_fees FROM fund_basic_info WHERE fund_code = '008295';",
    "error": "no such table: fund_basic_info"
}
