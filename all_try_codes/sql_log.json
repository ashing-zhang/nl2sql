{
    "question": "è¯·å¸®æˆ‘è®¡ç®—ï¼Œåœ¨20210105ï¼Œä¸­ä¿¡è¡Œä¸šåˆ†ç±»åˆ’åˆ†çš„ä¸€çº§è¡Œä¸šä¸ºç»¼åˆé‡‘èè¡Œä¸šä¸­ï¼Œæ¶¨è·Œå¹…æœ€å¤§è‚¡ç¥¨çš„è‚¡ç¥¨ä»£ç æ˜¯ï¼Ÿæ¶¨è·Œå¹…æ˜¯å¤šå°‘ï¼Ÿç™¾åˆ†æ•°ä¿ç•™ä¸¤ä½å°æ•°ã€‚è‚¡ç¥¨æ¶¨è·Œå¹…å®šä¹‰ä¸ºï¼šï¼ˆæ”¶ç›˜ä»· - å‰ä¸€æ—¥æ”¶ç›˜ä»· / å‰ä¸€æ—¥æ”¶ç›˜ä»·ï¼‰* 100%ã€‚",
    "sql": "WITH a_stock_data AS (\n    SELECT \n        a_code,\n        a_date,\n        a_close,\n        LAG(a_close) OVER (ORDER BY a_date) AS a_close_prev\n    FROM \n        Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a\n    WHERE \n        a_date = '20210105'\n),\nb_stock_data AS (\n    SELECT \n        a_code,\n        a_date,\n        a_close,\n        a_close_prev,\n        ((a_close - a_close_prev) / a_close_prev) * 100 AS stock_return\n    FROM \n        a_stock_data\n),\nc_stock_data AS (\n    SELECT \n        a_code,\n        MAX(stock_return) AS max_return,\n        MIN(stock_return) AS min_return\n    FROM \n        b_stock_data\n    GROUP BY \n        a_code\n)\nSELECT \n    a_code,\n    ROUND(MAX(stock_return), 2) AS stock_return_percentage\nFROM \n    c_stock_data\nWHERE \n    a_code IN (\n        SELECT \n            a_code \n        FROM \n            b_stock_data \n        WHERE \n            a_date = '20210105' \n            AND a_close_prev IS NOT NULL \n            AND a_close IS NOT NULL\n    )\nGROUP BY \n    a_code\nORDER BY \n    ROUND(MAX(stock_return), 2) DESC\nLIMIT 1;",
    "error": "no such column: a_code"
}
{
    "question": "æ¹–å—é•¿è¿œé”‚ç§‘è‚¡ä»½æœ‰é™å…¬å¸å˜æ›´è®¾ç«‹æ—¶ä½œä¸ºå‘èµ·äººçš„æ³•äººæœ‰å“ªäº›ï¼Ÿ",
    "sql": "SELECT DISTINCT f1.fund_code AS å…¬å¸ä»£ç , \n       f1.fund_name AS å…¬å¸å…¨ç§° \nFROM \n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f1 \nJOIN \n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f2 ON f1.fund_code = f2.fund_code \nJOIN \n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† f3 ON f1.fund_code = f3.fund_code \nJOIN \n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† f4 ON f1.fund_code = f4.fund_code \nJOIN \n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f5 ON f1.fund_code = f5.fund_code \nJOIN \n    Aè‚¡ç¥¨å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ f6 ON f1.fund_code = f6.stock_code \nWHERE \n    f1.fundå…¨ç§° LIKE '%æ¹–å—é•¿è¿œé”‚ç§‘è‚¡ä»½æœ‰é™å…¬å¸%';",
    "error": "no such table: Aè‚¡ç¥¨å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨"
}
{
    "question": "20210304æ—¥ï¼Œä¸€çº§è¡Œä¸šä¸ºéé“¶é‡‘èçš„è‚¡ç¥¨çš„æˆäº¤é‡åˆè®¡æ˜¯å¤šå°‘ï¼Ÿå–æ•´ã€‚",
    "sql": "SELECT ROUND(SUM(A.æˆäº¤é‡(å…ƒ)), 0) AS æˆäº¤é¢åˆè®¡\nFROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ A\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ B ON A.äº¤æ˜“æ—¥ = B.äº¤æ˜“æ—¥\nWHERE A.è‚¡ç¥¨ä»£ç  IN (\n    SELECT A.è‚¡ç¥¨ä»£ç  \n    FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ A\n    WHERE A.è‚¡ç¥¨ä»£ç  LIKE '%60%')  -- å‡è®¾è‚¡ç¥¨ä»£ç ä»¥%60%ç»“å°¾è¡¨ç¤ºéé“¶é‡‘èè¡Œä¸š\nORDER BY A.æˆäº¤é‡(å…ƒ) DESC\nLIMIT 1;",
    "error": "near \"(\": syntax error"
}
{
    "question": "å˜‰å®åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸2019å¹´æˆç«‹äº†å¤šå°‘åŸºé‡‘?",
    "sql": "SELECT COUNT(DISTINCT fund_code) as æˆåŠŸå‘è¡ŒåŸºé‡‘æ•°é‡\nFROM åŸºé‡‘åŸºæœ¬ä¿¡æ¯\nWHERE FOUNDATION_DATE BETWEEN '2019-01-01' AND '2019-12-31';",
    "error": "no such column: fund_code"
}
{
    "question": "2021å¹´ä¸‰å­£åº¦ï¼Œæœ‰å¤šå°‘å®¶åŸºé‡‘å‘ç”Ÿäº†å‡€èµå›?æ€»å…±èµå›äº†å¤šå°‘ä»½é¢?è®°å¾—ç»™æˆ‘å››èˆäº”å…¥åˆ°å°æ•°ç‚¹åä¸¤ä½å“¦ã€‚",
    "sql": "SELECT \n    COUNT(DISTINCT fund_code) AS åŸºé‡‘æ•°é‡,\n    SUM(èµå›ä»½é¢) AS æ€»èµå›ä»½é¢\nFROM \n    åŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\nWHERE \n    å…¬å‘Šæ—¥æœŸ >= '2021-07-01' AND å…¬å‘Šæ—¥æœŸ <= '2021-09-30'\n    AND (åŸºé‡‘ç±»å‹ = 'è‚¡ç¥¨å‹' OR åŸºé‡‘ç±»å‹ = 'å€ºåˆ¸å‹' OR åŸºé‡‘ç±»å‹ = 'æ··åˆå‹')\n    AND æŠ¥å‘Šç±»å‹ = 'å®šæœŸæŠ¥å‘Š';",
    "error": "no such column: fund_code"
}
{
    "question": "è¯·å¸®æˆ‘æŸ¥è¯¢ä¸‹ï¼Œåœ¨20190605ï¼Œä¸­ä¿¡è¡Œä¸šåˆ†ç±»é‡Œä¸€çº§è¡Œä¸šä¸ºçŸ³æ²¹çŸ³åŒ–è¡Œä¸šçš„æ‰€æœ‰è‚¡ç¥¨é‡Œ, æˆäº¤é‡‘é¢(å…ƒ)æœ€å¤šçš„è‚¡ç¥¨çš„ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿæˆäº¤é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_short_name,\n    SUM(fh.æˆäº¤é‡‘é¢(å…ƒ)) AS totalæˆäº¤é‡‘é¢\nFROM \n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f\nJOIN \n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ fh \nON \n    f.åŸºé‡‘ä»£ç  = fh.è‚¡ç¥¨ä»£ç \nWHERE \n    f.åŸºé‡‘ä»£ç  LIKE '%ä¸­ä¿¡%çŸ³æ²¹çŸ³åŒ–%'\n    AND fh.äº¤æ˜“æ—¥ = '20190605'\n    AND fh.ä¸€çº§è¡Œä¸š = 'çŸ³æ²¹çŸ³åŒ–'\nGROUP BY \n    f.fund_code, f.fund_short_name\nORDER BY \n    totalæˆäº¤é‡‘é¢ DESC\nLIMIT 1;",
    "error": "near \"(\": syntax error"
}
{
    "question": "è‚¡ç¥¨002244åœ¨20191220æ—¥æœŸä¸­çš„æ”¶ç›˜ä»·æ˜¯å¤šå°‘?ï¼ˆå°æ•°ç‚¹ä¿ç•™3ä½ï¼‰",
    "sql": "SELECT ROUND(LOWER(A.ä»Šå¼€ç›˜(å…ƒ), 3) AS æ”¶ç›˜ä»·(å…ƒ) FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ A WHERE A.äº¤æ˜“æ—¥ = '20191220' ORDER BY A.äº¤æ˜“æ—¥ DESC LIMIT 1;",
    "error": "near \"(\": syntax error"
}
{
    "question": "æœ¬æ¬¡å‘è¡Œå‰ï¼Œå¤§è¿æ´¾æ€ç‡ƒæ°”ç³»ç»Ÿè‚¡ä»½æœ‰é™å…¬å¸çš„æ§è‚¡è‚¡ä¸œæŒæœ‰å…¬å¸çš„å¤šå°‘è‚¡ä»½ï¼Ÿå å…¬å¸æ€»è‚¡ä»½çš„å¤šå°‘ï¼Ÿ",
    "sql": "SELECT\n    f1.fund_code,\n    f1.fund_short_name,\n    SUM(f2.æ•°é‡) AS total_shares,\n    (SUM(f2.æ•°é‡) / f1.èµ„äº§å‡€å€¼) * 100 AS percentage\nFROM\n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f2\n    LEFT JOIN\n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f1 ON f1.fund_code = f2.fund_code\nWHERE\n    f2.fund_short_name = 'å¤§è¿æ´¾æ€ç‡ƒæ°”ç³»ç»Ÿè‚¡ä»½æœ‰é™å…¬å¸'\nGROUP BY\n    f1.fund_code,\n    f1.fund_short_name\nORDER BY\n    f1.fund_short_name DESC\nLIMIT 1;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "è¯·é—®2019å¹´ä¸‰å­£åº¦æœ‰å¤šå°‘å®¶åŸºé‡‘æ˜¯å‡€ç”³è´­?å®ƒä»¬çš„å‡€ç”³è´­ä»½é¢åŠ èµ·æ¥æ˜¯å¤šå°‘?è¯·å››èˆäº”å…¥ä¿ç•™å°æ•°ç‚¹ä¸¤ä½ã€‚",
    "sql": "SELECT \n    COUNT(DISTINCT f1.fund_code) AS net_sharing_funds,\n    ROUND(SUM(f2.total_sharing_amount), 2) AS total_net_sharing\nFROM \n    fund_scale f1\nJOIN \n    fund_scale f2 \nON \n    f1.fund_code = f2.fund_code\nWHERE \n    f1.report_period_year = 2019\n    AND f1.report_period_quarter = 3\n    AND f2.report_period_year = 2019\n    AND f2.report_period_quarter = 3\n    AND f2.total_sharing_amount > 0;",
    "error": "no such table: fund_scale"
}
{
    "question": "å¸®æˆ‘æŸ¥ä¸€ä¸‹æ¹˜è´¢é•¿å¼˜çµæ´»é…ç½®æ··åˆAåŸºé‡‘åœ¨20210419çš„èµ„äº§å‡€å€¼å’Œå•ä½å‡€å€¼æ˜¯å¤šå°‘?",
    "sql": "SELECT \n    f1.fund_code,\n    f1.trade_date,\n    f1.unitholders,\n    f1.cumunits \nFROM \n    fund_daily f1 \nWHERE \n    f1.fund_code = 'æ¹˜è´¢é•¿å¼˜çµæ´»é…ç½®æ··åˆA' \n    AND f1.trade_date = '20210419';",
    "error": "no such table: fund_daily"
}
{
    "question": "è¿‘ä¸‰å¹´ï¼Œå¹¿ä¸œé“¶ç¦§ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸æ€»èµ„äº§å‘¨è½¬ç‡åˆ†åˆ«ä¸ºå¤šå°‘ï¼Ÿ",
    "sql": "SELECT \n    f1.fund_code,\n    f1.fundç®€ç§°,\n    f1.ç®¡ç†è´¹ç‡,\n    f1.æ‰˜ç®¡è´¹ç‡,\n    f1.æˆç«‹æ—¥æœŸ,\n    f1.åˆ°æœŸæ—¥æœŸ,\n    f1.ç®¡ç†è´¹ç‡ / f2.å¸‚å€¼ AS æ€»èµ„äº§å‘¨è½¬ç‡\nFROM \n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f1\nJOIN \n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f2 ON f1.fund_code = f2.fund_code\nWHERE \n    f1.fundç®€ç§° = 'å¹¿ä¸œé“¶ç¦§ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸'\n    AND f1.æˆç«‹æ—¥æœŸ >= '2020-01-01'\n    AND f1.åˆ°æœŸæ—¥æœŸ <= '2023-12-31'\n    AND f2.æŒä»“æ—¥æœŸ >= '2020-01-01'\n    AND f2.æŒä»“æ—¥æœŸ <= '2023-12-31'\n    AND f2.è‚¡ç¥¨ä»£ç  = '603123'\n    ORDER BY f1.åˆ°æœŸæ—¥æœŸ DESC\nLIMIT 100;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“å®‰ä¿¡ç¨³å¥å›æŠ¥6ä¸ªæœˆæŒæœ‰æœŸæ··åˆAåŸºé‡‘åœ¨20211231çš„å¹´æŠ¥(å«åŠå¹´æŠ¥)ä¸­ï¼Œå…¶å¯è½¬å€ºæŒä»“å æ¯”æœ€å¤§çš„æ˜¯å“ªä¸ªè¡Œä¸šï¼Ÿç”¨ä¸­ä¿¡ä¸€çº§è¡Œä¸šæ¥ç»Ÿè®¡ã€‚",
    "sql": "SELECT\n    f1.`ä¸€çº§è¡Œä¸šåç§°` AS `ä¸€çº§è¡Œä¸šåç§°`,\n    COUNT(f1.`ç¬¬Nå¤§é‡ä»“è‚¡`) AS `å¯è½¬å€ºæŒä»“å æ¯”æœ€å¤§çš„è¡Œä¸š`\nFROM\n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† f1\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f2 ON f1.`åŸºé‡‘ä»£ç ` = f2.`è‚¡ç¥¨ä»£ç `\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f3 ON f1.`åŸºé‡‘ä»£ç ` = f3.`è‚¡ç¥¨ä»£ç `\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f4 ON f1.`åŸºé‡‘ä»£ç ` = f4.`è‚¡ç¥¨ä»£ç `\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f5 ON f1.`åŸºé‡‘ä»£ç ` = f5.`è‚¡ç¥¨ä»£ç `\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f6 ON f1.`åŸºé‡‘ä»£ç ` = f6.`è‚¡ç¥¨ä»£ç `\nGROUP BY f1.`åŸºé‡‘ä»£ç `, f1.`ä¸€çº§è¡Œä¸šåç§°`\n HAVING COUNT(f1.`ç¬¬Nå¤§é‡ä»“è‚¡`) = (\n    SELECT MAX(COUNT(f2.`ç¬¬Nå¤§é‡ä»“è‚¡`))\n    FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f2\n    WHERE f2.`åŸºé‡‘ä»£ç ` = f1.`åŸºé‡‘ä»£ç `\n    AND f2.`äº¤æ˜“æ—¥æœŸ` >= '2021-12-31'\n    ORDER BY f2.`äº¤æ˜“æ—¥æœŸ` DESC\n    LIMIT 1\n    )\nORDER BY f1.`ä¸€çº§è¡Œä¸šåç§°`;",
    "error": "no such column: f1.ä¸€çº§è¡Œä¸šåç§°"
}
{
    "question": "æ ¹æ®è”åŒ–ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸æ‹›è‚¡æ„è§ä¹¦ï¼Œç²¾ç»†åŒ–å·¥äº§å“çš„é€šå¸¸åˆ©æ¶¦ç‡æ˜¯å¤šå°‘ï¼Ÿ",
    "sql": "SELECT\n    f1.fund_code,\n    f1.fund_short_name,\n    f1.fund_total_assets AS total_assets,\n    f1.fund manages,\n    f1.fund_total_assets - f1.fund managed_shares AS total managed assets,\n    f1.fund_total_assets - f1.fund managed_shares - f1.fund managed_cash AS total managed liabilities\nFROM\n    FundåŸºæœ¬ä¿¡æ¯ f1\nLEFT JOIN\n    Fundå€ºåˆ¸æŒä»“æ˜ç»† f2 ON f1.fund_code = f2.fund_code\nLEFT JOIN\n    Fundè‚¡ç¥¨æŒä»“æ˜ç»† f3 ON f1.fund_code = f3.fund_code\nLEFT JOIN\n    Fundå¯è½¬å€ºæŒä»“æ˜ç»† f4 ON f1.fund_code = f4.fund_code\nLEFT JOIN\n    Fundæ—¥è¡Œæƒ…è¡¨ f5 ON f1.fund_code = f5.fund_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a1 ON f1.fund_short_name = a1.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a2 ON f1.fund_short_name = a2.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a3 ON f1.fund_short_name = a3.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a4 ON f1.fund_short_name = a4.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a5 ON f1.fund_short_name = a5.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a6 ON f1.fund_short_name = a6.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a7 ON f1.fund_short_name = a7.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a8 ON f1.fund_short_name = a8.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a9 ON f1.fund_short_name = a9.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a10 ON f1.fund_short_name = a10.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a11 ON f1.fund_short_name = a11.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a12 ON f1.fund_short_name = a12.stock_code\nLEFT JOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a13 ON f1.fund;",
    "error": "near \"AS\": syntax error"
}
{
    "question": "å„æŠ¥å‘ŠæœŸæœ«ï¼Œæ±Ÿè‹æ—·è¾¾æ±½è½¦ç»‡ç‰©é›†å›¢è‚¡ä»½æœ‰é™å…¬å¸å­˜è´§åˆ†åˆ«ä¸ºå¤šå°‘ä¸‡å…ƒï¼Ÿå æµåŠ¨èµ„äº§çš„æ¯”ä¾‹åˆ†åˆ«å¤šå°‘ï¼Ÿ",
    "sql": "SELECT\n    f.fund_code,\n    f.fundç®€ç§°,\n    f.æˆç«‹æ—¥æœŸ,\n    f.åˆ°æœŸæ—¥æœŸ,\n    f.ç®¡ç†è´¹ç‡,\n    f.æ‰˜ç®¡è´¹ç‡,\n    SUM(p.æ•°é‡) AS å­˜è´§æ€»é‡ä¸‡å…ƒ,\n    (SUM(p.æ•°é‡) / f.èµ„äº§å‡€å€¼) * 100 AS å­˜è´§å æ¯”æµåŠ¨èµ„äº§\nFROM\n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f\nJOIN\n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† p ON f.fund_code = p.fund_code\nJOIN\n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† b ON f.fund_code = b.fund_code\nJOIN\n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† cr ON f.fund_code = cr.fund_code\nJOIN\n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† cr ON f.fund_code = cr.fund_code\nJOIN\n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† b ON f.fund_code = b.fund_code\nJOIN\n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† cr ON f.fund_code = cr.fund_code\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a ON f.fund_code = a.åŸºé‡‘ä»£ç \nJOIN\n    æ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ h ON f.fund_code = h.åŸºé‡‘ä»£ç \nJOIN\n    Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ i ON f.fundç®€ç§° = i.è‚¡ç¥¨ä»£ç \nJOIN\n    åŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨ s ON f.fund_code = s.fund_code\nJOIN\n    åŸºé‡‘æ—¥è¡Œæƒ…è¡¨ d ON f.fund_code = d.fund_code\nGROUP BY\n    f.fund_code,\n    f.fundç®€ç§°,\n    f.æˆç«‹æ—¥æœŸ,\n    f.åˆ°æœŸæ—¥æœŸ,\n    f.ç®¡ç†è´¹ç‡,\n    f.æ‰˜ç®¡è´¹ç‡\nORDER BY\n    f.æˆç«‹æ—¥æœŸ DESC,\n    f.åˆ°æœŸæ—¥æœŸ DESC,\n    f.èµ„äº§å‡€å€¼ DESC\nLIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "2019å¹´ä¸­æœŸæŠ¥å‘Šé‡Œï¼Œåå¤åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸ç®¡ç†çš„åŸºé‡‘ä¸­ï¼Œæœºæ„æŠ•èµ„è€…æŒæœ‰ä»½é¢æ¯”ä¸ªäººæŠ•èµ„è€…å¤šçš„åŸºé‡‘æœ‰å¤šå°‘åª?",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS num_funds\nFROM fund_scale_holders f1\nJOIN fund_fundamentals f2 ON f1.fund_code = f2.fund_code\nWHERE f2.fund_manager = 'åå¤åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸'\nAND f1.æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ > f1.ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢\nORDER BY f1.fund_code DESC\nLIMIT 100;",
    "error": "no such table: fund_scale_holders"
}
{
    "question": "å‡è®¾è‚¡ç¥¨æ—¥æ”¶ç›Šç‡è®¡ç®—å…¬å¼ä¸ºï¼šæ—¥æ”¶ç›Šç‡ = ï¼ˆå½“æ—¥æ”¶ç›˜ä»·-æ˜¨æ”¶ç›˜ä»·ï¼‰/æ˜¨æ”¶ç›˜ä»·ã€‚è¯·å¸®æˆ‘æ‰¾åˆ°åœ¨2021å¹´ï¼Œç”³ä¸‡è¡Œä¸šåˆ†ç±»è¡Œä¸šåˆ’åˆ†æ ‡å‡†,é“¶è¡Œä¸€çº§è¡Œä¸šä¸­, ä»£ç ä¸ºå¤šå°‘çš„è‚¡ç¥¨çš„æ—¥å‡æ”¶ç›Šç‡æœ€é«˜ï¼Ÿ",
    "sql": "SELECT \n    stock_code,\n    a_stock.dayreturn_rate,\n    (SELECT a_stock.dayreturn_rate \n     FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a_stock \n     WHERE a_stock.äº¤æ˜“æ—¥æœŸ = '2021-12-31'\n     ) AS dayreturn_rate\nFROM \n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS a_stock\nWHERE \n    a_stock.äº¤æ˜“æ—¥æœŸ = '2021-12-31'\n    AND a_stock.è‚¡ç¥¨ä»£ç  = (SELECT stock_code \n                           FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ \n                           WHERE a_stock.äº¤æ˜“æ—¥æœŸ = '2021-12-31'\n                           AND a_stock.è‚¡ç¥¨ä»£ç  LIKE '%é“¶è¡Œ%')\n    AND a_stock.æ—¥æ”¶ç›Šç‡ > 0\nORDER BY dayreturn_rate DESC\nLIMIT 1;",
    "error": "no such column: stock_code"
}
{
    "question": "åœ¨20201022ï¼ŒæŒ‰ç…§ä¸­ä¿¡è¡Œä¸šåˆ†ç±»çš„è¡Œä¸šåˆ’åˆ†æ ‡å‡†ï¼Œå“ªä¸ªä¸€çº§è¡Œä¸šçš„Aè‚¡å…¬å¸æ•°é‡æœ€å¤šï¼Ÿ",
    "sql": "SELECT \n    a.stock_code,\n    a.è¡Œä¸šåˆ’åˆ†æ ‡å‡†,\n    a.ä¸€çº§è¡Œä¸šåç§°,\n    COUNT(a.stock_code) AS æ•°é‡\nFROM \n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a\nJOIN \n    Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ b \nON \n    a.è‚¡ç¥¨ä»£ç  = b.è‚¡ç¥¨ä»£ç \nWHERE \n    a.äº¤æ˜“æ—¥æœŸ = '20201022'\n    AND b.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'ä¸­ä¿¡è¡Œä¸šåˆ†ç±»'\n    AND a.äº¤æ˜“æ—¥æœŸ >= '20201022'\n    AND a.äº¤æ˜“æ—¥æœŸ <= '20201022'\nGROUP BY \n    a.ä¸€çº§è¡Œä¸šåç§°\nORDER BY \n    æ•°é‡ DESC\nLIMIT 1;",
    "error": "no such column: a.stock_code"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“æ‹›å•†å®‰æ¶¦çµæ´»é…ç½®æ··åˆAåŸºé‡‘ï¼Œåœ¨2021å¹´åŠå¹´åº¦æŠ¥å‘Šä¸­ï¼Œå‰10å¤§é‡ä»“è‚¡ä¸­ï¼Œæœ‰å¤šå°‘åªè‚¡ç¥¨åœ¨æŠ¥å‘ŠæœŸå†…å–å¾—æ­£æ”¶ç›Šã€‚",
    "sql": "SELECT COUNT(DISTINCT s.stock_code) AS distinct_stocks_with_positive_return\nFROM fund_stocks_holding_details f\nJOIN stock_daily_details s ON f.stock_code = s.stock_code AND f.fund_code = 'æ‹›å•†å®‰æ¶¦çµæ´»é…ç½®æ··åˆA' AND f.fund_short_name = 'çµæ´»é…ç½®'\nWHERE f.holding_date BETWEEN '2021-01-01' AND '2021-06-30'\n  AND f.portfolio_rank = 10\n  AND s.trading_date >= f.holding_date\n  AND s.trading_date <= f.holding_date\n  AND s.close > s.open\nGROUP BY f.fund_code, f.fund_short_name, f.holding_date\nORDER BY COUNT(DISTINCT s.stock_code) DESC\nLIMIT 100;",
    "error": "no such table: fund_stocks_holding_details"
}
{
    "question": "å¸®æˆ‘æŸ¥è¯¢åœ¨2020å¹´12æœˆ31æ—¥ï¼Œä»£ç ä¸º007678çš„åŸºé‡‘å‰20å¤§é‡ä»“è‚¡ç¥¨ä¸­å±äºä¸­ä¿¡äºŒçº§ç…§æ˜ç”µå·¥åŠå…¶ä»–è¡Œä¸šçš„å¹³å‡å¸‚å€¼æ˜¯å¤šå°‘ï¼Ÿå°æ•°ç‚¹åä¿ç•™ä¸è¶…è¿‡3ä½ã€‚",
    "sql": "SELECT\n    substr(fund_info.fund_short_name, 0, 20) AS fund_short_name,\n    avg(fund_stocks.market_value) AS avg_market_value\nFROM\n    fund_stocks\nJOIN\n    fund_info ON fund_stocks.fund_code = fund_info.fund_code\nWHERE\n    fund_info.fund_code = '007678'\n    AND fund_info.fund_date = '2020-12-31'\n    AND fund_stocks.position_rank <= 20\n    AND fund_stocks.industry IN ('ä¸­ä¿¡', 'äºŒçº§', 'ç…§æ˜ç”µå·¥', 'åŠå…¶ä»–', 'è¡Œä¸š')\n    AND fund_stocks.sub_industry = 'ä¸­ä¿¡äºŒçº§ç…§æ˜ç”µå·¥åŠå…¶ä»–'\nGROUP BY\n    fund_stocks.fund_code,\n    fund_stocks.fund_short_name,\n    fund_stocks.sub_industry\nORDER BY\n    avg_market_value DESC\nLIMIT 1;",
    "error": "no such table: fund_stocks"
}
{
    "question": "è¯·å¸®æˆ‘æŸ¥è¯¢å‡º20190121æ—¥ï¼Œéé“¶è¡Œé‡‘èä¸€çº§è¡Œä¸šæ¶¨å¹…è¶…è¿‡5%ï¼ˆä¸åŒ…å«ï¼‰çš„è‚¡ç¥¨æ•°é‡ã€‚",
    "sql": "SELECT COUNT(DISTINCT stock_code) AS stock_code_count\nFROM (\n    SELECT stock_code, stock_name, (current_open - previous_close) / previous_close * 100 AS percentage_change\n    FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a\n    WHERE a.äº¤æ˜“æ—¥æœŸ = '20190121'\n        AND a.è‚¡ç¥¨ä»£ç  LIKE 'A%'\n        AND a.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'éé“¶è¡Œé‡‘è'\n        AND a.ä¸€çº§è¡Œä¸šåç§° = 'ä¸€çº§'\n        AND a.äºŒçº§è¡Œä¸šåç§° IS NULL\n        AND a.percentage_change > 5\n) AS subquery;",
    "error": "no such column: stock_code"
}
{
    "question": "è¯·æŸ¥è¯¢ï¼šåœ¨20190118ï¼Œå±äºç”³ä¸‡äºŒçº§é“¶è¡Œè¡Œä¸šçš„Aè‚¡è‚¡ç¥¨ï¼Œå®ƒä»¬çš„å¹³å‡æˆäº¤é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿå°æ•°ç‚¹åä¿ç•™ä¸è¶…è¿‡5ä½ã€‚",
    "sql": "SELECT ROUND(AVGS.MARKETæˆäº¤é‡‘é¢(å…ƒ), 5) AS å¹³å‡æˆäº¤é‡‘é¢\nFROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS A\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS B ON A.äº¤æ˜“æ—¥ = B.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS C ON A.äº¤æ˜“æ—¥ = C.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS D ON A.äº¤æ˜“æ—¥ = D.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS E ON A.äº¤æ˜“æ—¥ = E.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS F ON A.äº¤æ˜“æ—¥ = F.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS G ON A.äº¤æ˜“æ—¥ = G.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS H ON A.äº¤æ˜“æ—¥ = H.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS I ON A.äº¤æ˜“æ—¥ = I.äº¤æ˜“æ—¥\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS J ON A.äº¤æ˜“æ—¥ = J.äº¤æ˜“æ—¥\nWHERE \n    A.è‚¡ç¥¨ä»£ç  IN (\n        SELECT \n            Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.è‚¡ç¥¨ä»£ç  \n        FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ \n        WHERE Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.äº¤æ˜“æ—¥æœŸ = '20190118' \n        AND Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'ç”³ä¸‡äºŒçº§é“¶è¡Œè¡Œä¸š'\n    )\n    AND A.è‚¡ç¥¨ä»£ç  IN (\n        SELECT \n            Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.è‚¡ç¥¨ä»£ç  \n        FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ \n        WHERE Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.äº¤æ˜“æ—¥æœŸ = '20190118' \n        AND Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'ç”³ä¸‡äºŒçº§é“¶è¡Œè¡Œä¸š'\n    )\n    AND A.äº¤æ˜“æ—¥æœŸ >= '20190101'\n    AND A.äº¤æ˜“æ—¥æœŸ <= '20190131'\n    AND A.æˆäº¤é‡‘é¢(å…ƒ) IS NOT NULL\n    AND A.æˆäº¤é‡‘é¢(å…ƒ) LIKE '%'\n    AND A.æˆäº¤é‡‘é¢(å…ƒ) NOT LIKE '%null%';",
    "error": "near \"(\": syntax error"
}
{
    "question": "ä¸­å›½é“è·¯é€šä¿¡ä¿¡å·è‚¡ä»½æœ‰é™å…¬å¸çš„ä¸»è¦ç»è¥æ¨¡å¼æ˜¯æ€æ ·çš„ï¼Ÿ",
    "sql": "SELECT\n    f.fund_code,\n    f.fund_name,\n    f.mgr,\n    f.tch,\n    f.mgr_fee,\n    f.tch_fee,\n    f.establish_date,\n    f.maturity_date,\n    f.mgr_commission,\n    f.mtch_commission\nFROM\n    Fund_Basic f\nJOIN\n    Fund_Equity Holdings fh ON f.fund_code = fh.fund_code\nJOIN\n    Fund_Bond Holdings fhb ON f.fund_code = fhb.fund_code\nJOIN\n    Fund_TrlBonds Holdings fht ON f.fund_code = fht.fund_code\nORDER BY f.establish_date DESC\nLIMIT 100;",
    "error": "near \"fh\": syntax error"
}
{
    "question": "è¯·æŸ¥è¯¢ï¼šåœ¨2021çš„å¹´åº¦æŠ¥å‘Šä¸­ï¼Œä¸ªäººæŠ•èµ„è€…æŒæœ‰åŸºé‡‘ä»½é¢å¤§äºæœºæ„æŠ•èµ„è€…æŒæœ‰åŸºé‡‘ä»½é¢çš„åŸºé‡‘å±äºè´§å¸å‹ç±»å‹çš„æœ‰å‡ ä¸ªã€‚",
    "sql": "SELECT COUNT(DISTINCT fund_code)\nFROM (\n    SELECT fund_code\n    FROM (\n        SELECT f1.*,\n               f2.*,\n               f3.*,\n               f4.*,\n               f5.*,\n               f6.*,\n               f7.*,\n               f8.*,\n               f9.*,\n               f10.*,\n               f11.*,\n               f12.*,\n               f13.*,\n               f14.*,\n               f15.*,\n               f16.*,\n               f17.*,\n               f18.*,\n               f19.*,\n               f20.*,\n               f21.*,\n               f22.*,\n               f23.*,\n               f24.*,\n               f25.*,\n               f26.*,\n               f27.*,\n               f28.*,\n               f29.*,\n               f30.*,\n               f31.*,\n               f32.*,\n               f33.*,\n               f34.*,\n               f35.*,\n               f36.*,\n               f37.*,\n               f38.*,\n               f39.*,\n               f40.*,\n               f41.*,\n               f42.*,\n               f43.*,\n               f44.*,\n               f45.*,\n               f46.*,\n               f47.*,\n               f48.*,\n               f49.*,\n               f50.*,\n               f51.*,\n               f52.*,\n               f53.*,\n               f54.*,\n               f55.*,\n               f56.*,\n               f57.*,\n               f58.*,\n               f59.*,\n               f60.*,\n               f61.*,\n               f62.*,\n               f63.*,\n               f64.*,\n               f65.*,\n               f66.*,\n               f67.*,\n               f68.*,\n               f69.*,\n               f70.*,\n               f71.*,\n               f72.*,\n               f73.*,\n               f74.*,\n               f75.*,\n               f76.*,\n               f77.*,\n               f78.*,\n               f79.*,\n               f80.*,\n               f81.*;",
    "error": "near \";\": syntax error"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“åœ†ä¿¡æ°¸ä¸°é«˜ç«¯åˆ¶é€ æ··åˆåŸºé‡‘ï¼Œåœ¨2020å¹´åŠå¹´åº¦æŠ¥å‘Šä¸­ï¼Œå‰10å¤§é‡ä»“è‚¡ä¸­ï¼Œæœ‰å¤šå°‘åªè‚¡ç¥¨åœ¨æŠ¥å‘ŠæœŸå†…å–å¾—æ­£æ”¶ç›Šã€‚",
    "sql": "SELECT COUNT(*) AS count_of_stocks_with_positive_return\nFROM (\n    SELECT \n        stock_code,\n        SUM(CASE WHEN close > open THEN 1 ELSE 0 END) AS positive_return\n    FROM \n        fund_stocks_holding_details\n    WHERE \n        fund_code = 'åœ†ä¿¡æ°¸ä¸°é«˜ç«¯åˆ¶é€ æ··åˆåŸºé‡‘' AND \n        reporting_period = '2020å¹´åŠå¹´åº¦'\n        AND position_rank <= 10\n    GROUP BY \n        stock_code\n) AS temp_table\nWHERE \n    temp_table.count_of_stocks_with_positive_return > 0;",
    "error": "no such table: fund_stocks_holding_details"
}
{
    "question": "åœ¨2019å¹´çš„ä¸­æœŸæŠ¥å‘Šé‡Œï¼Œé‡‘é¹°åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸ç®¡ç†çš„åŸºé‡‘ä¸­ï¼Œæœ‰å¤šå°‘æ¯”ä¾‹çš„åŸºé‡‘æ˜¯ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„ä»½é¢è¶…è¿‡æœºæ„æŠ•èµ„è€…ï¼Ÿå¸Œæœ›å¾—åˆ°ä¸€ä¸ªç²¾ç¡®åˆ°ä¸¤ä½å°æ•°çš„ç™¾åˆ†æ¯”ã€‚",
    "sql": "WITH FundHolderStructure AS (\n    SELECT \n        f1.fund_code,\n        f1.fundç®€ç§°,\n        f1.ç®¡ç†äºº,\n        f1.æ‰˜ç®¡äºº,\n        f1.åŸºé‡‘ç±»å‹,\n        f1.æˆç«‹æ—¥æœŸ,\n        f1.åˆ°æœŸæ—¥æœŸ,\n        f1.ç®¡ç†è´¹ç‡,\n        f1.æ‰˜ç®¡è´¹ç‡,\n        COUNT(f2.åŸºé‡‘æŒæœ‰ä»½é¢) AS total_shares,\n        f2.ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ AS personal_shares,\n        f2.æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ AS institutional_shares\n    FROM \n        FundåŸºæœ¬ä¿¡æ¯ f1\n    LEFT JOIN \n        FundHolderStructure f2 ON f1.fund_code = f2.fund_code\n    WHERE \n        f1.åŸºé‡‘ç®€ç§° LIKE '%é‡‘é¹°åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸%'\n        AND YEAR(f1.æˆç«‹æ—¥æœŸ) = 2019\n    GROUP BY \n        f1.fund_code, f1.fundç®€ç§°, f1.ç®¡ç†äºº, f1.æ‰˜ç®¡äºº, f1.åŸºé‡‘ç±»å‹, f1.æˆç«‹æ—¥æœŸ, f1.åˆ°æœŸæ—¥æœŸ, f1.ç®¡ç†è´¹ç‡, f1.æ‰˜ç®¡è´¹ç‡\n)\nSELECT \n    ROUND(SUM(CASE WHEN f1.personal_shares > f1.institutional_shares THEN f1.personal_shares ELSE 0 END) / \n        SUM(f1.total_shares) * 100, 2) AS percentage\nFROM \n    FundHolderStructure f1\nWHERE \n    f1.personal_shares > f1.institutional_shares\nORDER BY \n    f1.æˆç«‹æ—¥æœŸ DESC\nLIMIT 100;",
    "error": "no such table: FundåŸºæœ¬ä¿¡æ¯"
}
{
    "question": "åœ¨2019å¹´12æœˆå­£æŠ¥ä¸­ï¼ŒæŒæœ‰å¤§äºšåœ£è±¡è¿™ä¸€è‚¡ç¥¨ä¸”å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯”ä¸å°äº5%çš„æœ‰å‡ åªåŸºé‡‘ï¼Ÿ",
    "sql": "SELECT COUNT(DISTINCT fund_code) AS num_funds\nFROM (\n    SELECT fund_code, stock_code, å¸‚å€¼, åŸºé‡‘èµ„äº§å‡€å€¼, å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯”\n    FROM åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\n    WHERE æŠ¥å‘Šç±»å‹ = 'å­£æŠ¥'\n        AND åŸºé‡‘ä»£ç  = 'å¤§äºšåœ£è±¡'\n        AND å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” >= 5\n) AS temp_table\nGROUP BY fund_code\nORDER BY num_funds DESC\nLIMIT 10;",
    "error": "no such column: fund_code"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“åœ¨2019å¹´ï¼Œé‡‘ä¿¡åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸å·²å‘è¡Œçš„åŸºé‡‘ä¸­ï¼Œæœ‰å¤šå°‘åªåŸºé‡‘æŠ¥å‘ŠæœŸæœŸåˆåŸºé‡‘æ€»ä»½é¢å°äºæŠ¥å‘ŠæœŸæœŸæœ«åŸºé‡‘æ€»ä»½é¢(ä½¿ç”¨æ¯åªåŸºé‡‘å½“å¹´æœ€æ™šçš„å®šæœŸæŠ¥å‘Šæ•°æ®è®¡ç®—)ï¼Ÿ",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS distinct_fund_count\nFROM fundåŸºæœ¬ä¿¡æ¯ f1\nJOIN åŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨ f2 ON f1.fund_code = f2.fund_code\nWHERE f2.reporting_year = 2019\n  AND f2.fund_code LIKE 'é‡‘ä¿¡ç®¡ç†%' -- å‡è®¾åŸºé‡‘å…¬å¸åç§°å‰ç¼€ä¸º 'é‡‘ä¿¡ç®¡ç†%'\n  AND f1.portfolio_start_amount < f1.portfolio_end_amount\nORDER BY f2.reporting_year DESC\nLIMIT 1;",
    "error": "no such table: fundåŸºæœ¬ä¿¡æ¯"
}
{
    "question": "æŠ¥å‘ŠæœŸå†…ï¼Œæ­¦æ±‰å…´å›¾æ–°ç§‘ç”µå­è‚¡ä»½æœ‰é™å…¬å¸æ¥è‡ªå†›ç”¨é¢†åŸŸçš„æ”¶å…¥å ä¸»è¥ä¸šåŠ¡æ”¶å…¥çš„æ¯”é‡åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    (SELECT SUM(case WHEN www.w sharing_type = 'å†›ç”¨' THEN ww shares_volume ELSE 0 END) \n     FROM fund_holders \n     WHERE fund_code = f.fund_code \n     AND holding_date >= f.start_date \n     AND holding_date <= f.end_date) \n     / \n    (SELECT SUM(ww shares_volume) \n     FROM fund_holders \n     WHERE fund_code = f.fund_code \n     AND holding_date >= f.start_date \n     AND holding_date <= f.end_date) \nAS ratio\nFROM fund_daily \nAS f\nJOIN fund_holders \nON f.fund_code = h.fund_code\nAND f.holding_date = h.holding_date\nWHERE f.fund_name LIKE '%æ­¦æ±‰å…´å›¾æ–°ç§‘ç”µå­è‚¡ä»½æœ‰é™å…¬å¸%';",
    "error": "near \"sharing_type\": syntax error"
}
{
    "question": "æ ¹æ®æ­¦æ±‰å…´å›¾æ–°ç§‘ç”µå­è‚¡ä»½æœ‰é™å…¬å¸æ‹›è‚¡æ„å‘ä¹¦ï¼Œç”µå­ä¿¡æ¯è¡Œä¸šçš„ä¸Šæ¸¸æ¶‰åŠå“ªäº›ä¼ä¸šï¼Ÿ",
    "sql": "ğŸ“Œ ä»»åŠ¡æè¿°ï¼š\n            ä½ æ˜¯ä¸€å SQL ç”Ÿæˆä¸“å®¶ï¼Œéœ€è¦å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€é—®é¢˜è½¬æ¢ä¸º **é«˜æ•ˆä¸”å‡†ç¡®çš„ SQL æŸ¥è¯¢**ã€‚\n            \n            ğŸ“Š **æ•°æ®åº“æ¨¡å¼ï¼ˆSchemaï¼‰**ï¼š\n            â–Œ è¡¨åï¼šåŸºé‡‘åŸºæœ¬ä¿¡æ¯\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘å…¨ç§° (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª ç®¡ç†äºº (TEXT)\n    â–ª æ‰˜ç®¡äºº (TEXT)\n    â–ª åŸºé‡‘ç±»å‹ (TEXT)\n    â–ª æˆç«‹æ—¥æœŸ (TEXT)\n    â–ª åˆ°æœŸæ—¥æœŸ (TEXT)\n    â–ª ç®¡ç†è´¹ç‡ (TEXT)\n    â–ª æ‰˜ç®¡è´¹ç‡ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª è‚¡ç¥¨åç§° (TEXT)\n    â–ª æ•°é‡ (REAL)\n    â–ª å¸‚å€¼ (REAL)\n    â–ª å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª å€ºåˆ¸ç±»å‹ (TEXT)\n    â–ª å€ºåˆ¸åç§° (TEXT)\n    â–ª æŒå€ºæ•°é‡ (REAL)\n    â–ª æŒå€ºå¸‚å€¼ (REAL)\n    â–ª æŒå€ºå¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª å¯¹åº”è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª å€ºåˆ¸åç§° (TEXT)\n    â–ª æ•°é‡ (REAL)\n    â–ª å¸‚å€¼ (REAL)\n    â–ª å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘æ—¥è¡Œæƒ…è¡¨\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥æœŸ (TEXT)\n    â–ª å•ä½å‡€å€¼ (REAL)\n    â–ª å¤æƒå•ä½å‡€å€¼ (REAL)\n    â–ª ç´¯è®¡å•ä½å‡€å€¼ (REAL)\n    â–ª èµ„äº§å‡€å€¼ (REAL)\n\nâ–Œ è¡¨åï¼šAè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥ (TEXT)\n    â–ª æ˜¨æ”¶ç›˜(å…ƒ) (REAL)\n    â–ª ä»Šå¼€ç›˜(å…ƒ) (REAL)\n    â–ª æœ€é«˜ä»·(å…ƒ) (REAL)\n    â–ª æœ€ä½ä»·(å…ƒ) (REAL)\n    â–ª æ”¶ç›˜ä»·(å…ƒ) (REAL)\n    â–ª æˆäº¤é‡(è‚¡) (REAL)\n    â–ª æˆäº¤é‡‘é¢(å…ƒ) (REAL)\n\nâ–Œ è¡¨åï¼šæ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥ (TEXT)\n    â–ª æ˜¨æ”¶ç›˜(å…ƒ) (REAL)\n    â–ª ä»Šå¼€ç›˜(å…ƒ) (REAL)\n    â–ª æœ€é«˜ä»·(å…ƒ) (REAL)\n    â–ª æœ€ä½ä»·(å…ƒ) (REAL)\n    â–ª æ”¶ç›˜ä»·(å…ƒ) (REAL)\n    â–ª æˆäº¤é‡(è‚¡) (REAL)\n    â–ª æˆäº¤é‡‘é¢(å…ƒ) (REAL)\n\nâ–Œ è¡¨åï¼šAè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥æœŸ (TEXT)\n    â–ª è¡Œä¸šåˆ’åˆ†æ ‡å‡† (TEXT)\n    â–ª ä¸€çº§è¡Œä¸šåç§° (TEXT)\n    â–ª äºŒçº§è¡Œä¸šåç§° (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª å…¬å‘Šæ—¥æœŸ (TIMESTAMP)\n    â–ª æˆªæ­¢æ—¥æœŸ (TIMESTAMP)\n    â–ª æŠ¥å‘ŠæœŸæœŸåˆåŸºé‡‘æ€»ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸåŸºé‡‘æ€»ç”³è´­ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸåŸºé‡‘æ€»èµå›ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸæœŸæœ«åŸºé‡‘æ€»ä»½é¢ (REAL)\n    â–ª å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ (INTEGER)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘ä»½é¢æŒæœ‰äººç»“æ„\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª å…¬å‘Šæ—¥æœŸ (TIMESTAMP)\n    â–ª æˆªæ­¢æ—¥æœŸ (TIMESTAMP)\n    â–ª æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ (REAL)\n    â–ª æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢å æ€»ä»½é¢æ¯”ä¾‹ (REAL)\n    â–ª ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ (REAL)\n    â–ª ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢å æ€»ä»½é¢æ¯”ä¾‹ (REAL)\n    â–ª å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ (INTEGER)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\n            ğŸ“ **SQL ç”Ÿæˆè¦æ±‚ï¼š**\n            1ï¸âƒ£ **ä»…è¿”å› SQL ä»£ç **ï¼Œä¸åŒ…å«ä»»ä½•é¢å¤–çš„è‡ªç„¶è¯­è¨€è§£é‡Šã€‚  \n2ï¸âƒ£ SQL **åº”ç¬¦åˆ ANSI æ ‡å‡†**ï¼Œæˆ–å¯æ ¹æ®æ•°æ®åº“ç±»å‹ï¼ˆ`MySQL` / `PostgreSQL` / `SQL Server`ï¼‰è°ƒæ•´è¯­æ³•ã€‚  \n3ï¸âƒ£ **æ­£ç¡®ä½¿ç”¨ `JOIN` è¿›è¡Œè¡¨å…³è”**ï¼Œé¿å…å†—ä½™æŸ¥è¯¢ã€‚  \n4ï¸âƒ£ å¯¹äºæ¶‰åŠ **èšåˆæ“ä½œ**ï¼ˆå¦‚ `COUNT`ã€`SUM`ã€`AVG`ï¼‰ï¼Œ**è‡ªåŠ¨è¡¥å…… `GROUP BY`**ï¼Œé¿å… SQL è¯­æ³•é”™è¯¯ã€‚  \n5ï¸âƒ£ **å­—æ®µåº”åŠ ä¸Šè¡¨å‰ç¼€**ï¼ˆå¦‚ `users.name` è€Œä¸æ˜¯ `name`ï¼‰ä»¥é¿å…æ­§ä¹‰ã€‚  \n6ï¸âƒ£ **ä½¿ç”¨ç´¢å¼•å­—æ®µè¿›è¡Œè¿‡æ»¤**ï¼ˆå¦‚ `fund_code`ã€`stock_code`ï¼‰ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚  \n7ï¸âƒ£ **å¯¹äºæ—¶é—´åºåˆ—æŸ¥è¯¢ï¼Œè‡ªåŠ¨è¡¥å…… `ORDER BY date_column DESC` ä»¥è¿”å›æœ€æ–°æ•°æ®**ã€‚  \n8ï¸âƒ£ **åˆç†ä½¿ç”¨ `LIMIT` é¿å…æŸ¥è¯¢è¿”å›è¿‡å¤šæ•°æ®**ï¼ˆå¦‚é»˜è®¤ `LIMIT 100`ï¼‰ã€‚  \n9ï¸âƒ£ **å¤æ‚æŸ¥è¯¢æ¨èä½¿ç”¨ `WITH` è¯­å¥ï¼ˆCTEï¼‰æˆ–å­æŸ¥è¯¢**ï¼Œæé«˜å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚  \nğŸ”Ÿ **ç‰¹åˆ«è¯´æ˜**ï¼šå¯¹äºåŒ…å«æ‹¬å·çš„å­—æ®µåï¼ˆä¾‹å¦‚ \"æˆäº¤é‡‘é¢(å…ƒ)\"ï¼‰ï¼Œè¯·ç¡®ä¿åœ¨ç”Ÿæˆ SQL æ—¶ä½¿ç”¨é€‚å½“çš„å¼•ç”¨ç¬¦å·ï¼ˆå¦‚åå¼•å·ã€æ–¹æ‹¬å·æˆ–åŒå¼•å·ï¼Œä¾æ®æ‰€ç”¨æ•°æ®åº“çš„å…·ä½“è¦æ±‚ï¼‰ï¼Œä»¥é˜²æ­¢è§£æé”™è¯¯ã€‚\n\n            ğŸ› ï¸ æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼ˆåŒ…æ‹¬æ•°æ®åº“æ¨¡å¼ã€SQLç”Ÿæˆè¦æ±‚ç­‰ï¼‰ï¼Œ\n            è¯·å°†ä»¥ä¸‹é—®é¢˜è½¬æ¢ä¸ºSQLè¯­å¥ï¼š\n            æ ¹æ®æ­¦æ±‰å…´å›¾æ–°ç§‘ç”µå­è‚¡ä»½æœ‰é™å…¬å¸æ‹›è‚¡æ„å‘ä¹¦ï¼Œç”µå­ä¿¡æ¯è¡Œä¸šçš„ä¸Šæ¸¸æ¶‰åŠå“ªäº›ä¼ä¸šï¼Ÿ\n            ğŸ¯ **æœ€ç»ˆ SQL æŸ¥è¯¢**ï¼š```\n\nOkay, so I need to help this user by converting their natural language question into an efficient SQL query. Let me start by understanding what they're asking for. The user provided a detailed database schema and specific SQL requirements, so I have to make sure I follow those closely.\n\nThe question is: \"æ ¹æ®æ­¦æ±‰å…´å›¾æ–°ç§‘ç”µå­è‚¡ä»½æœ‰é™å…¬å¸æ‹›è‚¡æ„å‘ä¹¦ï¼Œç”µå­ä¿¡æ¯è¡Œä¸šçš„ä¸Šæ¸¸æ¶‰åŠå“ªäº›ä¼ä¸šï¼Ÿ\" Translating that, it's asking which upstream companies are involved in the electronics industry that upstream from WUTXNC.ELG, based on theæ‹›è‚¡æ„å‘ä¹¦.\n\nFirst, I'll break down the components. They want companies in the upstream of the electronics industry. So, I need to find companies that are in the supply chain or dependencies of the electronics companies. The main company here is WUTXNC.ELG, but I need to find its upstream suppliers.\n\nLooking at the database tables, I see several that might be relevant. The \"åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\" and \"åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»†\" tables are related to mutual funds holding stocks and bonds, but I'm not sure how that ties into the company's upstream. Maybe that's a red herring. The \"åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»†\" also seems off-topic.\n\nThe more relevant tables might be the ones related to the company's financials and holdings. Wait, the user provided a database schema, so I need to check which tables relate to the company's stakeholders or supply chain.\n\nHmm, perhaps the \"åŸºé‡‘æ—¥è¡Œæƒ…è¡¨\" and \"åŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\" are related to the company's performance, but again, not directly about upstream companies.\n\nWait, maybe the user is referring to the supply chain within the electronics industry. So, perhaps looking at the \"æ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\" and \"Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\" for stock market data on electronics companies, but that might not directly give upstream suppliers.\n\nAlternatively, maybe the user is interested in the company's stakeholders or major investors, but the question is about upstream companies in the industry, not investors.\n\nWait, perhaps the user wants to find the companies that supply WUTXNC.ELG, so looking at the supply chain, which might be in a different table. But looking at the provided tables, I don't see one that directly links a company to its suppliers. Maybe the tables provided don't include the necessary information for this query.\n\nAlternatively, maybe the user wants to find the companies that are in;",
    "error": "near \"ğŸ“Œ\": syntax error"
}
{
    "question": "å¹¿å·ä¸­æµ·è¾¾å«æ˜Ÿå¯¼èˆªæŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æœ¬æ¬¡å‹Ÿé›†èµ„é‡‘ä¸»è¦æŠ•èµ„å“ªäº›é¡¹ç›®ï¼Ÿ",
    "sql": "SELECT\n    f.fund_code,\n    f.fund_name,\n    f manage_type,\n    SUM(p1.fundraising_amount) AS total_funding\nFROM\n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f\n    LEFT JOIN\n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† p1\n    ON f.fund_code = p1.fund_code\n    WHERE\n        f.fund_name LIKE '%å¹¿å·ä¸­æµ·è¾¾å«æ˜Ÿå¯¼èˆªæŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸%'\n    GROUP BY\n    f.fund_code, f.fund_name, f.fund_type\n    ORDER BY\n    total_funding DESC,\n    f.fund_name\n    LIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "æˆ‘æƒ³äº†è§£ä¸€ä¸‹çº¢åœŸåˆ›æ–°åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸2020å¹´æˆç«‹çš„æ··åˆå‹åŸºé‡‘,å…¶ç®¡ç†è´¹ç‡çš„å¹³å‡å€¼æ˜¯å¤šå°‘?è¯·å››èˆäº”å…¥ä¿ç•™å°æ•°ç‚¹ä¸¤ä½ã€‚",
    "sql": "SELECT\n    F.fund_name,\n    ROUND(Avg(Management_Fee), 2) AS Management_Fee_Avg\nFROM\n    Fund_Basics F\nJOIN\n    Fund_Snapshot_FY2020 A ON F.Fund_Code = A.Fund_Code\nWHERE\n    F.Fund_Code LIKE '%çº¢åœŸåˆ›æ–°%'\n    AND F.Fund_Type = 'æ··åˆå‹'\n    AND F.Founded_Date LIKE '2020-01-%';",
    "error": "no such table: Fund_Basics"
}
{
    "question": "åœ¨2008å¹´ï¼Œä¸œèå‹¤ä¸Šå…‰ç”µè‚¡ä»½æœ‰é™å…¬å¸åœ¨æ™¯è§‚äº®åŒ–åŠå¯¼ä½“ç…§æ˜é¢†åŸŸçš„å¸‚åœºå æœ‰ç‡ä¸ºå¤šå°‘ï¼Ÿ",
    "sql": "SELECT\n    f.fund_code,\n    f.fundç®€ç§°,\n    f.ç®¡ç†è´¹Rate,\n    f.æ‰˜ç®¡è´¹Rate\nFROM\n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f\nJOIN\n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† s ON f.fund_code = s.fund_code\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a ON s.stock_code = a.stock_code\nWHERE\n    a.äº¤æ˜“æ—¥æœŸ = '2008-12-31'\n    AND a.è‚¡ç¥¨ä»£ç  = '002415'\n    AND f.fundç®€ç§° = 'ä¸œèå‹¤ä¸Šå…‰ç”µè‚¡ä»½æœ‰é™å…¬å¸'\n    AND a.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'æ™¯è§‚äº®åŒ–åŠå¯¼ä½“ç…§æ˜'\n    ORDER BY date DESC\n    LIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "æ¹–å—å—å²­æ°‘ç”¨çˆ†ç ´å™¨æè‚¡ä»½æœ‰é™å…¬å¸çš„æ§è‚¡è‚¡ä¸œæ˜¯è°ï¼Ÿ",
    "sql": "SELECT DISTINCT \n    f1.fund_code AS åŸºé‡‘ä»£ç ,\n    f1.fund_name AS åŸºé‡‘å…¨ç§°\nFROM \n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f1\nJOIN \n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f2 ON f1.fund_code = f2.fund_code\nJOIN \n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† f3 ON f1.fund_code = f3.fund_code\nJOIN \n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† f4 ON f1.fund_code = f4.fund_code\nJOIN \n    åŸºé‡‘æ—¥è¡Œæƒ…è¡¨ f5 ON f1.fund_code = f5.fund_code\nJOIN \n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f6 ON f1.fund_name LIKE '%Aè‚¡ç¥¨%'\nJOIN \n    æ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f7 ON f1.fund_name LIKE '%æ¸¯è‚¡ç¥¨%'\nJOIN \n    Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ f8 ON f1.fund_name LIKE '%Aè‚¡å…¬å¸%'\nWHERE \n    f1.fund_name = 'æ¹–å—å—å²­æ°‘ç”¨çˆ†ç ´å™¨æè‚¡ä»½æœ‰é™å…¬å¸'\nLIMIT 1;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "åœ¨ç ”å‘æ–¹é¢ï¼Œä¸Šæµ·çœŸå…°ä»ªè¡¨ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸åˆ©ç”¨å“ªä¸‰åœ°çš„äººæ‰ä¼˜åŠ¿ï¼Œæˆç«‹ç ”å‘ä¸­å¿ƒï¼Œç»„å»ºäº†â€œä¸‰ä½ä¸€ä½“â€çš„ç ”å‘ä½“ç³»ï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f.manager,\n    f.mgrt_funder,\n    f.mgrt_fund,\n    f.fund_type,\n    f.fund_start_date,\n    f.fund_end_date,\n    f.mgrt_fee,\n    f.mgrt_fee,\n    f.mgrt_fee,\n    f.mgrt_fee\nFROM \n    Fund_Behavior f\nJOIN \n    Fund_Mgrt f_mgrt\nON \n    f.fund_code = f_mgrt.fund_code\nJOIN \n    Fund_Funder f_funder\nON \n    f_mgrt.fund_code = f_funder.fund_code\nJOIN \n    Fund_Fund f_fund\nON \n    f_funder.fund_code = f_fund.fund_code\nJOIN \n    Fund_Type f_type\nON \n    f_fund.fund_code = f_type.fund_code\nORDER BY \n    f.fund_start_date DESC,\n    f.fund_end_date DESC,\n    f.fund_code DESC;",
    "error": "no such table: Fund_Behavior"
}
{
    "question": "æˆ‘æƒ³äº†è§£åšæ—¶ç ”ç©¶ä¼˜é€‰çµæ´»é…ç½®æ··åˆ(LOF)AåŸºé‡‘,åœ¨2021å¹´å››å­£åº¦çš„å­£æŠ¥ç¬¬3å¤§é‡è‚¡ã€‚è¯¥æŒä»“è‚¡ç¥¨å½“ä¸ªå­£åº¦çš„æ¶¨è·Œå¹…?è¯·å››èˆäº”å…¥ä¿ç•™ç™¾åˆ†æ¯”åˆ°å°æ•°ç‚¹ä¸¤ä½ã€‚",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_short_name,\n    s.stock_code AS stock_code,\n    s.stock_name AS stock_name,\n    ROUND(s.movement_percentage, 2) AS movement_percentage\nFROM \n    fund_stocks_holding_minæ˜ç»† f\nJOIN \n    stock_dayè¡Œæƒ…è¡¨ s \nON \n    f.stock_code = s.stock_code\nWHERE \n    f.fund_code = 'åšæ—¶ç ”ç©¶ä¼˜é€‰çµæ´»é…ç½®æ··åˆLOF A'\n    AND f.fund_short_name = 'LOF'\n    AND f.fundholding_type IN ('è‚¡ç¥¨å‹åŸºé‡‘', 'æ··åˆå‹åŸºé‡‘')\n    AND f.holding_rank = 3\n    AND f.holding_date >= '2021-09-30'\n    AND f.holding_date <= '2021-12-31'\n    AND s.trade_date >= '2021-09-30'\n    AND s.trade_date <= '2021-12-31';",
    "error": "no such table: fund_stocks_holding_minæ˜ç»†"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“å¯Œå…°å…‹æ—å›½æµ·å¤§ä¸­åç²¾é€‰æ··åˆ(QDII)(ç¾å…ƒç°æ±‡)åœ¨2021å¹´Q2çš„å­£æŠ¥ä¸­ï¼Œè¯¥åŸºé‡‘çš„ç¬¬1å¤§é‡ä»“è‚¡çš„ä»£ç æ˜¯ä»€ä¹ˆ?",
    "sql": "SELECT DISTINCT fws.fund_code, fws.fund_short_name, fwsReporting.fund ReportingDate, fws.fund_type,\n       fws.fund_management_fees_rate, fws.fund_tchf_fees_rate\nFROM fund_franklin_guoqin_AHJZQDII_emerging markets_fund_info fws\nJOIN fund_franklin_guoqin_AHJZQDII_emerging markets_fund_holdingæ˜ç»† fwh\nON fws.fund_code = fwh.fund_code\nJOIN fund_franklin_guoqin_AHJZQDII_emerging markets_fund_holdingæ˜ç»† fws_holding ON fws.fund_code = fws_holding.fund_code\nJOIN fund_franklin_guoqin_AHJZQDII_emerging markets_fund_holdingæ˜ç»† fws_fund_holding ON fws.fund_code = fws_fund_holding.fund_code\nWHERE fws.reporting_date = '2021-06-30'\n   AND fws.fund_type = 'æ··åˆå‹'\n   AND fws.fund_short_name = 'å¯Œå…°å…‹æ—å›½æµ·å¤§ä¸­åç²¾é€‰æ··åˆ(QDII)(ç¾å…ƒç°æ±‡)'\n   AND fws.fund_management_fees_rate IS NOT NULL\n   AND fws.fund_tchf_fees_rate IS NOT NULL\n   AND fws_holding.n_th_largest_share = 1\n   AND fws_holding.stock_name IS NOT NULL\n   AND fws_holding.stock_code LIKE '%.USD' -- Assuming USD codes end with .USD\n   AND fws_fund_holding.fund_code = fws.fund_code\n   AND fws_fund_holdingReporting.fund ReportingDate = fws.reporting_date\n   AND fws_fund_holdingReporting.fund_short_name = fws.fund_short_name\n   AND fws_fund_holdingReporting.fund_type = fws.fund_type\n   AND fws_fund_holdingReporting.fund_management_fees_rate = fws.fund_management_fees_rate\n   AND fws_fund_holdingReporting.fund_tchf_fees_rate = fws.fund_tchf_fees_rate\n   AND fws_holdingReporting.fund_code = fws_holding.fund_code\n   AND f;",
    "error": "near \"fws\": syntax error"
}
{
    "question": "å¸¸ç†Ÿé£èŒƒç”µåŠ›è®¾å¤‡è‚¡ä»½æœ‰é™å…¬å¸çš„æœºå™¨è®¾å¤‡æˆæ–°ç‡æ˜¯å¤šå°‘ï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f manage_type,\n    f management_fees,\n    f.tombus_holders_funds,\n    f.tombus_holders_funds_ratio,\n    f.fund_total_assets,\n    f.fund_total_assets_ratio\nFROM \n    fund_fundamentals f\nJOIN \n    fund_holders f_holders \n    ON \n        f.fund_code = f_holders.fund_code\nJOIN \n    fund_holders f_holders2 \n    ON \n        f_holders.fund_code = f_holders2.fund_code\nWHERE \n    f_fund_holders_fund_name LIKE '%å¸¸ç†Ÿé£èŒƒç”µåŠ›è®¾å¤‡è‚¡ä»½æœ‰é™å…¬å¸%';",
    "error": "no such table: fund_fundamentals"
}
{
    "question": "2009å¹´ã€2010å¹´åŠ2011å¹´ï¼Œæµ·å—åŒæˆè¯ä¸šè‚¡ä»½æœ‰é™å…¬å¸é”€å”®è´¹ç”¨åˆ†åˆ«ä¸ºå¤šå°‘ï¼Ÿ",
    "sql": "SELECT \n    f1.åŸºé‡‘ä»£ç  AS å…¬å¸ä»£ç ,\n    f1.åŸºé‡‘ç®€ç§° AS å…¬å¸åç§°,\n    f1.ç®¡ç†è´¹(%) AS ç®¡ç†è´¹ç‡,\n    f1.æ‰˜ç®¡è´¹(%) AS æ‰˜ç®¡è´¹ç‡\nFROM \n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f1\nJOIN \n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f2 ON f1.åŸºé‡‘ä»£ç  = f2.åŸºé‡‘ä»£ç \nJOIN \n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† f3 ON f1.åŸºé‡‘ä»£ç  = f3.åŸºé‡‘ä»£ç \nJOIN \n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† f4 ON f1.åŸºé‡‘ä»£ç  = f4.åŸºé‡‘ä»£ç \nWHERE \n    f1.åŸºé‡‘ç®€ç§° LIKE '%æµ·å—åŒæˆè¯ä¸šè‚¡ä»½æœ‰é™å…¬å¸%'\n    AND YEAR(f1.æˆç«‹æ—¥æœŸ) BETWEEN 2009 AND 2011\n    AND f2.åŸºé‡‘ç®€ç§° LIKE '%æµ·å—åŒæˆè¯ä¸šè‚¡ä»½æœ‰é™å…¬å¸%'\n    AND f3.åŸºé‡‘ç®€ç§° LIKE '%æµ·å—åŒæˆè¯ä¸šè‚¡ä»½æœ‰é™å…¬å¸%'\n    AND f4.åŸºé‡‘ç®€ç§° LIKE '%æµ·å—åŒæˆè¯ä¸šè‚¡ä»½æœ‰é™å…¬å¸%'\nORDER BY f1.åŸºé‡‘ç®€ç§° ASC\nLIMIT 100;",
    "error": "near \"(\": syntax error"
}
{
    "question": "å†…è’™å¤å›æ­£èƒ½æºåŒ–å·¥è‚¡ä»½æœ‰é™å…¬å¸çš„æ³•å®šä»£è¡¨äººæ˜¯è°ï¼Ÿ",
    "sql": "SELECT DISTINCT u.user_name\nFROM users u\nJOIN a_stocks AS a\nON u.user_id = a.user_id\nWHERE a.stock_name = 'å†…è’™å¤å›æ­£èƒ½æºåŒ–å·¥è‚¡ä»½æœ‰é™å…¬å¸';",
    "error": "no such table: users"
}
{
    "question": "è”åŒ–ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸çš„ä¸»è¥ä¸šåŠ¡åŒ…æ‹¬å“ªä¸¤éƒ¨åˆ†ï¼Ÿ",
    "sql": "SELECT DISTINCT\n    f1.fund_type AS \"ä¸»è¥ä¸šåŠ¡1\"\nFROM\n    Fund_BusinessParts f1\nJOIN\n    Fund_BusinessParts f2 ON f1.fund_code = f2.fund_code\nJOIN\n    Fund_BusinessParts f3 ON f1.fund_code = f3.fund_code\nJOIN\n    Fund_BusinessParts f4 ON f1.fund_code = f4.fund_code\nJOIN\n    Fund_BusinessParts f5 ON f1.fund_code = f5.fund_code\nJOIN\n    Fund_BusinessParts f6 ON f1.fund_code = f6.fund_code\nJOIN\n    Fund_BusinessParts f7 ON f1.fund_code = f7.fund_code\nJOIN\n    Fund_BusinessParts f8 ON f1.fund_code = f8.fund_code\nJOIN\n    Fund_BusinessParts f9 ON f1.fund_code = f9.fund_code\nJOIN\n    Fund_BusinessParts f10 ON f1.fund_code = f10.fund_code\nJOIN\n    Fund_BusinessParts f11 ON f1.fund_code = f11.fund_code\nJOIN\n    Fund_BusinessParts f12 ON f1.fund_code = f12.fund_code\nJOIN\n    Fund_BusinessParts f13 ON f1.fund_code = f13.fund_code\nJOIN\n    Fund_BusinessParts f14 ON f1.fund_code = f14.fund_code\nJOIN\n    Fund_BusinessParts f15 ON f1.fund_code = f15.fund_code\nJOIN\n    Fund_BusinessParts f16 ON f1.fund_code = f16.fund_code\nJOIN\n    Fund_BusinessParts f17 ON f1.fund_code = f17.fund_code\nJOIN\n    Fund_BusinessParts f18 ON f1.fund_code = f18.fund_code\nJOIN\n    Fund_BusinessParts f19 ON f1.fund_code = f19.fund_code\nJOIN\n    Fund_BusinessParts f20 ON f1.fund_code = f20.fund_code\nJOIN\n    Fund_BusinessParts f21 ON f1.fund_code = f21.fund_code\nJOIN\n    Fund_BusinessParts;",
    "error": "no such table: Fund_BusinessParts"
}
{
    "question": "20191231æ—¥ï¼Œå®‹åŸæ¼”è‰ºåœ¨å¤šå°‘åªåŸºé‡‘çš„å‰ä¸ƒå¤§é‡ä»“è‚¡ä¸­ï¼Ÿ",
    "sql": "SELECT COUNT(DISTINCT f.fund_code) AS distinct_fund_codes\nFROM fund_stocks\nJOIN fund_bonds\nON fund_stocks.fund_code = fund_bonds.fund_code\nJOIN fund_corp_bonds\nON fund_stocks.fund_code = fund_corp_bonds.fund_code\nWHERE\n    fund_stocks.fund_short_name = 'å®‹åŸæ¼”è‰º'\n    AND transaction_date = '20191231'\n    AND rank = 1\n    OR rank = 2\n    OR rank = 3\n    OR rank = 4\n    OR rank = 5\n    OR rank = 6\n    OR rank = 7;",
    "error": "no such table: fund_stocks"
}
{
    "question": "è¯»è€…å‡ºç‰ˆä¼ åª’è‚¡ä»½æœ‰é™å…¬å¸çš„ä¸»è¦çº¸å¼ ä¾›åº”å•†æœ‰å“ªäº›ï¼Ÿ",
    "sql": "SELECT DISTINCT\n    f1.fund_code,\n    f1.fund_name,\n    f1.fund_manager,\n    f1.fund_type,\n    f1.fund_estdate,\n    f1.fund_maturity_date,\n    f1.fund_management_fee,\n    f1.fund_administration_fee\nFROM \"åŸºé‡‘åŸºæœ¬ä¿¡æ¯\" f1\nLEFT JOIN \"åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\" f2 ON f1.fund_code = f2.fund_code\nLEFT JOIN \"åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»†\" f3 ON f1.fund_code = f3.fund_code\nLEFT JOIN \"åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»†\" f4 ON f1.fund_code = f4.fund_code\nLEFT JOIN \"åŸºé‡‘æ—¥è¡Œæƒ…è¡¨\" f5 ON f1.fund_code = f5.fund_code\nLEFT JOIN \"Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\" a1 ON f1.fund_code = a1.stock_code\nLEFT JOIN \"æ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\" h1 ON f1.fund_code = h1.stock_code\nLEFT JOIN \"åŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\" f6 ON f1.fund_code = f6.fund_code\nLEFT JOIN \"åŸºé‡‘ä»½é¢æŒæœ‰äººç»“æ„\" f7 ON f1.fund_code = f7.fund_code\nWHERE f1.fund_name LIKE '%è¯»è€…å‡ºç‰ˆä¼ åª’è‚¡ä»½æœ‰é™å…¬å¸%';",
    "error": "no such column: f1.fund_code"
}
{
    "question": "2005å¹´ã€2006å¹´å’Œ2007å¹´ï¼Œå®æ³¢ç«‹ç«‹ç”µå­è‚¡ä»½æœ‰é™å…¬å¸æ‰€è·æ”¿åºœè¡¥åŠ©è®¡å…¥å½“æœŸæŸç›Šçš„é‡‘é¢åˆ†åˆ«å å½“å¹´åˆ©æ¶¦æ€»é¢çš„æ¯”ä¾‹æ˜¯å¤šå°‘ï¼Ÿ",
    "sql": "WITH FundPerformanceAS(\n    SELECT \n        f1.fund_code,\n        f1.fund_name,\n        f2.year AS profit_year,\n        f2.total_profit,\n        f2.year AS government_benefit_year,\n        f2.total_benefit,\n        f3.benefit_amount\n    FROM \n        FundBasic inf\n    JOIN \n        FundAnnualReport f2 ON inf.fund_code = f2.fund_code\n    WHERE \n        f2.year BETWEEN '2005' AND '2007'\n    )\n,\nStockDataAS(\n    SELECT \n        s1.stock_code,\n        s1.stock_name,\n        s1.year AS stock_year,\n        s2.benefit_year,\n        s2.benefit_amount,\n        s2.total_profit\n    FROM \n        AStocks a\n    JOIN \n        AStocksFundBenefit f ON a.stock_code = f.stock_code\n    WHERE \n        a.year = '2005' OR a.year = '2006' OR a.year = '2007'\n)\n,\nBenefitDataAS(\n    SELECT \n        b.benefit_year,\n        b.benefit_amount,\n        b.total_profit\n    FROM \n        FundPerformance f1\n    CROSS JOIN \n        StockData f2\n    WHERE \n        f1.year = f2.year\n        AND f1.benefit_year = f2.benefit_year\n)\nSELECT \n    (benefit_amount / total_profit) * 100 AS percentage\nFROM \n    BenefitData\nWHERE \n    year >= '2005'\n    AND year <= '2007'\n    AND benefit_year = 'å®æ³¢ç«‹ç«‹ç”µå­è‚¡ä»½æœ‰é™å…¬å¸'\nORDER BY year DESC\nLIMIT 3;",
    "error": "near \"SELECT\": syntax error"
}
{
    "question": "åœ¨20190211ï¼ŒæŒ‰ç…§ä¸­ä¿¡è¡Œä¸šåˆ†ç±»çš„è¡Œä¸šåˆ’åˆ†æ ‡å‡†ï¼Œå“ªä¸ªä¸€çº§è¡Œä¸šçš„Aè‚¡å…¬å¸æ•°é‡æœ€å¤šï¼Ÿ",
    "sql": "SELECT a.è¡Œä¸šåˆ’åˆ†æ ‡å‡†, b.ä¸€çº§è¡Œä¸šåç§°, COUNT(*) AS æ•°é‡\nFROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a\nJOIN Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ b ON a.è‚¡ç¥¨ä»£ç  = b.è‚¡ç¥¨ä»£ç \nWHERE a.äº¤æ˜“æ—¥æœŸ = '20190211'\n  AND b.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'ä¸­ä¿¡è¡Œä¸šåˆ†ç±»æ ‡å‡†'\nGROUP BY a.ä¸€çº§è¡Œä¸šåç§°\nORDER BY æ•°é‡ DESC\nLIMIT 1;",
    "error": "no such column: a.è¡Œä¸šåˆ’åˆ†æ ‡å‡†"
}
{
    "question": "å¸®æˆ‘æŸ¥ä¸€ä¸‹åœ¨2019å¹´ï¼Œä»£ç ä¸º603199çš„Aè‚¡è‚¡ç¥¨ä»Šå¼€ç›˜é«˜äºæ˜¨æ”¶ç›˜çš„å¤©æ•°ï¼Ÿ",
    "sql": "SELECT COUNT(DISTINCT dt)\nFROM (\n    SELECT date AS dt\n    FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS a\n    WHERE \n        a.è‚¡ç¥¨ä»£ç  = '603199' \n        AND date >= '2019-01-01' \n        AND date <= '2019-12-31' \n        AND a.ä»Šå¼€ç›˜(å…ƒ) > a.æ˜¨æ”¶ç›˜(å…ƒ)\n    ORDER BY date\n) AS t\nORDER BY t.dtp descend;",
    "error": "near \"(\": syntax error"
}
{
    "question": "å¸®æˆ‘æŸ¥ä¸€ä¸‹é¹æ‰¬æ™¯ç§‘æ··åˆAåŸºé‡‘åœ¨20201126çš„èµ„äº§å‡€å€¼å’Œå•ä½å‡€å€¼æ˜¯å¤šå°‘?",
    "sql": "SELECT\n    f1.fund_code AS åŸºé‡‘ä»£ç ,\n    f1.trade_date AS äº¤æ˜“æ—¥æœŸ,\n    f1.unite_value AS å•ä½å‡€å€¼,\n    f1 assets_value AS èµ„äº§å‡€å€¼\nFROM\n    åŸºé‡‘æ—¥è¡Œæƒ…è¡¨ f1\nJOIN\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ f2\n    ON f1.fund_code = f2.fund_code\n    AND f1.trade_date = f2.trade_date\nJOIN\n    Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ f3\n    ON f1.fund_code = f3.fund_code\n    AND f1.trade_date >= f3.äº¤æ˜“æ—¥æœŸ\nJOIN\n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f4\n    ON f1.fund_code = f4.fund_code\n    AND f1.trade_date >= f4.holding_date\nJOIN\n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† f5\n    ON f1.fund_code = f5.fund_code\n    AND f1.trade_date >= f5.holding_date\nJOIN\n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† f6\n    ON f1.fund_code = f6.fund_code\n    AND f1.trade_date >= f6.holding_date\nWHERE\n    f1.fund_code = 'é¹æ‰¬æ™¯ç§‘æ··åˆA'\n    AND f1.trade_date = '20201126'\nORDER BY\n    f1.trade_date DESC;",
    "error": "near \"AS\": syntax error"
}
{
    "question": "è¯·é—®è‚¡ç¥¨ä»£ç ä¸º301005çš„è‚¡ç¥¨åœ¨2021å¹´å†…æ—¥æˆäº¤é‡ä½äºè¯¥è‚¡ç¥¨å½“å¹´å¹³å‡æ—¥æˆäº¤é‡çš„æœ‰å¤šå°‘ä¸ªäº¤æ˜“æ—¥ï¼Ÿ",
    "sql": "SELECT COUNT(*) AS trading_days\nFROM (\n    SELECT \n        date AS trade_date,\n        stock_code,\n        SUM(æˆäº¤é‡‘é¢(å…ƒ)) AS total_volume\n    FROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    WHERE stock_code = '301005' AND year(trade_date) = 2021\n    GROUP BY date, stock_code\n) AS stock_volume\nWHERE total_volume < (SELECT SUM(total_volume) FROM stock_volume)\nORDER BY trade_date DESC\nLIMIT 100;",
    "error": "no such table: stock_volume"
}
{
    "question": "è¯·æŸ¥è¯¢ï¼šåœ¨2020çš„å¹´åº¦æŠ¥å‘Šä¸­ï¼Œä¸ªäººæŠ•èµ„è€…æŒæœ‰åŸºé‡‘ä»½é¢å¤§äºæœºæ„æŠ•èµ„è€…æŒæœ‰åŸºé‡‘ä»½é¢çš„åŸºé‡‘å±äºæ··åˆå‹ç±»å‹çš„æœ‰å‡ ä¸ªã€‚",
    "sql": "SELECT COUNT(fund_code)\nFROM (\n    SELECT fund_code\n    FROMåŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨ fundè§„æ¨¡å˜åŠ¨è¡¨ a\n    JOINåŸºé‡‘æŒæœ‰äººç»“æ„åŸºé‡‘æŒæœ‰ç»“æ„è¡¨ b ON a.fund_code = b.fund_code\n    WHERE a.æŠ¥å‘Šç±»å‹ = 'å¹´åº¦æŠ¥å‘Š' AND a.æŠ¥å‘ŠæœŸæœŸåˆåŸºé‡‘æ€»ä»½é¢ > 0\n    AND a.å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ = 2020\n    AND b.ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ > b.æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢\n) AS t\nWHERE t.åŸºé‡‘ç±»å‹ = 'æ··åˆå‹';",
    "error": "near \"fundè§„æ¨¡å˜åŠ¨è¡¨\": syntax error"
}
{
    "question": "å¸®æˆ‘æŸ¥ä¸€ä¸‹åœ¨2020å¹´ï¼Œä»£ç ä¸º002868çš„Aè‚¡è‚¡ç¥¨ä»Šå¼€ç›˜é«˜äºæ˜¨æ”¶ç›˜çš„å¤©æ•°ï¼Ÿ",
    "sql": "SELECT COUNT(*) AS Trading_Days\nFROM AStocks\nWHERE \n    å¹´ä»½ = '2020' AND \n    åŸºé‡‘ä»£ç  = '002868' AND \n    ä»Šå¼€ç›˜ > æ˜¨æ”¶ç›˜;",
    "error": "no such table: AStocks"
}
{
    "question": "æ£®èµ«ç”µæ¢¯è‚¡ä»½æœ‰é™å…¬å¸çš„ä¸»è¥ä¸šåŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ",
    "sql": "WITH fund_stock_holding AS (\n    SELECT\n        distinct f1.fund_code,\n        f1.fund_short_name AS fund_short_name,\n        f1.fund_type,\n        f1.start_date,\n        f1.end_date,\n        f1.mgrè´¹ç‡,\n        f1.tchè´¹ç‡\n    FROM\n        åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† f1\n    WHERE\n        f1.fund_short_name = 'æ£®èµ«ç”µæ¢¯è‚¡ä»½æœ‰é™å…¬å¸'\n        AND f1.fund_type IN ('è‚¡ç¥¨å‹', 'æ··åˆå‹')\n        AND f1.mgrè´¹ç‡ != 'NULL'\n        AND f1.tchè´¹ç‡ != 'NULL'\n),\nfund_bond_holding AS (\n    SELECT\n        distinct f2.fund_code,\n        f2.fund_short_name AS fund_short_name,\n        f2.bond_type,\n        f2.bond_name,\n        f2.hold_num,\n        f2.market,\n        f2.country,\n        f2.report_type\n    FROM\n        åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† f2\n    WHERE\n        f2.fund_short_name = 'æ£®èµ«ç”µæ¢¯è‚¡ä»½æœ‰é™å…¬å¸'\n        AND f2.bond_type IN ('å€ºåˆ¸å‹', 'è´§å¸å¸‚åœºåŸºé‡‘')\n        AND f2.hold_num != 'NULL'\n        AND f2.market IN (' reminding_securitieså¸‚åœº', ' reminding_countrystdå¸‚åœº')\n        AND f2.country IN ('ä¸­å›½', 'å…¶ä»–å›½å®¶')\n        AND f2.report_type IN ('ä¸€çº§', 'äºŒçº§')\n),\nfund_fundè½¬å€º_holding AS (\n    SELECT\n        distinct f3.fund_code,\n        f3.fund_short_name AS fund_short_name,\n        f3.issuance_type,\n        f3.issuance_name,\n        f3.hold_num,\n        f3.market,\n        f3.country,\n        f3.report_type\n    FROM\n        åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† f3\n    WHERE\n        f3.fund_short_name = 'æ£®èµ«ç”µæ¢¯è‚¡ä»½æœ‰é™å…¬å¸'\n        AND f3.issuance_type IN ('å¯è½¬å€º', 'å¯äº¤æ¢å€º')\n        AND f3.hold_num != 'NULL'\n        AND f3.market IN (' reminding_securitieså¸‚åœº', ' reminding_countrystdå¸‚åœº')\n        AND f3.country IN ('ä¸­å›½', 'å…¶ä»–å›½å®¶')\n        AND f3.report_type IN ('ä¸€çº§', 'äºŒçº§')\n),\nfund_daily;",
    "error": "near \";\": syntax error"
}
{
    "question": "å¤šæ™¶ç¡…æˆæœ¬çº¦å å®æ³¢ç«‹ç«‹ç”µå­è‚¡ä»½æœ‰é™å…¬å¸2007å¹´åº¦äº§å“åŸææ–™æˆæœ¬çš„å¤šå¤§æ¯”ä¾‹ï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f.start_date,\n    f.end_date,\n    f asset_total,\n    f.fund_total_shares,\n    f.fund_total_shares - f.fund_total_shares_at_start as total_shares,\n    f.fund_total_shares_at_start,\n    f.fund_total_shares_at_end,\n    f.fund_total_shares_at_start * f.fund_rate_of_return AS total_return,\n    f.fund_total_shares_at_end * f.fund_rate_of_return AS total_return_end\nFROM \n    fund_daily_statistics f\nJOIN \n    fund_daily_statistics g ON f.fund_code = g.fund_code\n    AND f.start_date = g.start_date\n    AND f.end_date = g.end_date\n    AND f.fund_total_shares_at_start = g.fund_total_shares_at_start\n    AND f.fund_total_shares_at_end = g.fund_total_shares_at_end\n    AND f.fund_rate_of_return = g.fund_rate_of_return\n    ORDER BY f.start_date DESC\nLIMIT 100;",
    "error": "no such table: fund_daily_statistics"
}
{
    "question": "è¯·æŸ¥è¯¢ï¼šåœ¨20191129ï¼Œå±äºç”³ä¸‡äºŒçº§ä»ªå™¨ä»ªè¡¨è¡Œä¸šçš„Aè‚¡è‚¡ç¥¨ï¼Œå®ƒä»¬çš„å¹³å‡æˆäº¤é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿå°æ•°ç‚¹åä¿ç•™ä¸è¶…è¿‡5ä½ã€‚",
    "sql": "SELECT\n    substr(aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.æˆäº¤é‡‘é¢(å…ƒ), 0, 15) AS æˆäº¤é‡‘é¢(å…ƒ)\nFROM\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a\nJOIN\n    Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ b ON a.è‚¡ç¥¨ä»£ç  = b.è‚¡ç¥¨ä»£ç \nWHERE\n    a.äº¤æ˜“æ—¥æœŸ = '20191129'\n    AND b.ä¸€çº§è¡Œä¸šåç§° = 'ç”³ä¸‡äºŒçº§ä»ªå™¨ä»ªè¡¨'\n    AND substr(a.æˆäº¤é‡‘é¢(å…ƒ), 0, 15) LIKE '%.00000' OR substr(a.æˆäº¤é‡‘é¢(å…ƒ), 0, 15) LIKE '%.00001' OR substr(a.æˆäº¤é‡‘é¢(å…ƒ), 0, 15) LIKE '%.00002' OR substr(a.æˆäº¤é‡‘é¢(å…ƒ), 0, 15) LIKE '%.00003' OR substr(a.æˆäº¤é‡‘é¢(å…ƒ), 0, 15) LIKE '%.00004';",
    "error": "near \"(\": syntax error"
}
{
    "question": "æ˜“æ–¹è¾¾åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸2019å¹´æˆç«‹äº†å¤šå°‘åŸºé‡‘?",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) AS num_funds\nFROM \"åŸºé‡‘åŸºæœ¬ä¿¡æ¯\" f1\nJOIN \"åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\" f2 ON f1.fund_code = f2.fund_code\nJOIN \"åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»†\" f3 ON f1.fund_code = f3.fund_code\nJOIN \"åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»†\" f4 ON f1.fund_code = f4.fund_code\nWHERE f1.fundå¹´ä»½ = '2019'\nORDER BY f1.fundå¹´ä»½ DESC\nLIMIT 100;",
    "error": "no such column: f1.fund_code"
}
{
    "question": "å˜‰å®åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸ç®¡ç†çš„å€ºåˆ¸å‹äº§å“çš„æ•°é‡æœ‰å¤šå°‘?",
    "sql": "SELECT COUNT(DISTINCT f.fund_code) AS fund_count\nFROM fund_bonds f\nWHERE fund_manager = 'å˜‰å®åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸'\n  AND fund_type = 'å€ºåˆ¸å‹';",
    "error": "no such table: fund_bonds"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“è‚¡ç¥¨002720åœ¨ç”³ä¸‡è¡Œä¸šåˆ†ç±»ä¸‹çš„äºŒçº§è¡Œä¸šæ˜¯ä»€ä¹ˆï¼Ÿç”¨æœ€æ–°çš„æ•°æ®ã€‚",
    "sql": "ğŸ“Œ ä»»åŠ¡æè¿°ï¼š\n            ä½ æ˜¯ä¸€å SQL ç”Ÿæˆä¸“å®¶ï¼Œéœ€è¦å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€é—®é¢˜è½¬æ¢ä¸º **é«˜æ•ˆä¸”å‡†ç¡®çš„ SQL æŸ¥è¯¢**ã€‚\n            \n            ğŸ“Š **æ•°æ®åº“æ¨¡å¼ï¼ˆSchemaï¼‰**ï¼š\n            â–Œ è¡¨åï¼šåŸºé‡‘åŸºæœ¬ä¿¡æ¯\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘å…¨ç§° (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª ç®¡ç†äºº (TEXT)\n    â–ª æ‰˜ç®¡äºº (TEXT)\n    â–ª åŸºé‡‘ç±»å‹ (TEXT)\n    â–ª æˆç«‹æ—¥æœŸ (TEXT)\n    â–ª åˆ°æœŸæ—¥æœŸ (TEXT)\n    â–ª ç®¡ç†è´¹ç‡ (TEXT)\n    â–ª æ‰˜ç®¡è´¹ç‡ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª è‚¡ç¥¨åç§° (TEXT)\n    â–ª æ•°é‡ (REAL)\n    â–ª å¸‚å€¼ (REAL)\n    â–ª å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª å€ºåˆ¸ç±»å‹ (TEXT)\n    â–ª å€ºåˆ¸åç§° (TEXT)\n    â–ª æŒå€ºæ•°é‡ (REAL)\n    â–ª æŒå€ºå¸‚å€¼ (REAL)\n    â–ª æŒå€ºå¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª å¯¹åº”è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª å€ºåˆ¸åç§° (TEXT)\n    â–ª æ•°é‡ (REAL)\n    â–ª å¸‚å€¼ (REAL)\n    â–ª å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘æ—¥è¡Œæƒ…è¡¨\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥æœŸ (TEXT)\n    â–ª å•ä½å‡€å€¼ (REAL)\n    â–ª å¤æƒå•ä½å‡€å€¼ (REAL)\n    â–ª ç´¯è®¡å•ä½å‡€å€¼ (REAL)\n    â–ª èµ„äº§å‡€å€¼ (REAL)\n\nâ–Œ è¡¨åï¼šAè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥ (TEXT)\n    â–ª æ˜¨æ”¶ç›˜(å…ƒ) (REAL)\n    â–ª ä»Šå¼€ç›˜(å…ƒ) (REAL)\n    â–ª æœ€é«˜ä»·(å…ƒ) (REAL)\n    â–ª æœ€ä½ä»·(å…ƒ) (REAL)\n    â–ª æ”¶ç›˜ä»·(å…ƒ) (REAL)\n    â–ª æˆäº¤é‡(è‚¡) (REAL)\n    â–ª æˆäº¤é‡‘é¢(å…ƒ) (REAL)\n\nâ–Œ è¡¨åï¼šæ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥ (TEXT)\n    â–ª æ˜¨æ”¶ç›˜(å…ƒ) (REAL)\n    â–ª ä»Šå¼€ç›˜(å…ƒ) (REAL)\n    â–ª æœ€é«˜ä»·(å…ƒ) (REAL)\n    â–ª æœ€ä½ä»·(å…ƒ) (REAL)\n    â–ª æ”¶ç›˜ä»·(å…ƒ) (REAL)\n    â–ª æˆäº¤é‡(è‚¡) (REAL)\n    â–ª æˆäº¤é‡‘é¢(å…ƒ) (REAL)\n\nâ–Œ è¡¨åï¼šAè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥æœŸ (TEXT)\n    â–ª è¡Œä¸šåˆ’åˆ†æ ‡å‡† (TEXT)\n    â–ª ä¸€çº§è¡Œä¸šåç§° (TEXT)\n    â–ª äºŒçº§è¡Œä¸šåç§° (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª å…¬å‘Šæ—¥æœŸ (TIMESTAMP)\n    â–ª æˆªæ­¢æ—¥æœŸ (TIMESTAMP)\n    â–ª æŠ¥å‘ŠæœŸæœŸåˆåŸºé‡‘æ€»ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸåŸºé‡‘æ€»ç”³è´­ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸåŸºé‡‘æ€»èµå›ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸæœŸæœ«åŸºé‡‘æ€»ä»½é¢ (REAL)\n    â–ª å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ (INTEGER)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘ä»½é¢æŒæœ‰äººç»“æ„\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª å…¬å‘Šæ—¥æœŸ (TIMESTAMP)\n    â–ª æˆªæ­¢æ—¥æœŸ (TIMESTAMP)\n    â–ª æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ (REAL)\n    â–ª æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢å æ€»ä»½é¢æ¯”ä¾‹ (REAL)\n    â–ª ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ (REAL)\n    â–ª ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢å æ€»ä»½é¢æ¯”ä¾‹ (REAL)\n    â–ª å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ (INTEGER)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\n            ğŸ“ **SQL ç”Ÿæˆè¦æ±‚ï¼š**\n            1ï¸âƒ£ **ä»…è¿”å› SQL ä»£ç **ï¼Œä¸åŒ…å«ä»»ä½•é¢å¤–çš„è‡ªç„¶è¯­è¨€è§£é‡Šã€‚  \n2ï¸âƒ£ SQL **åº”ç¬¦åˆ ANSI æ ‡å‡†**ï¼Œæˆ–å¯æ ¹æ®æ•°æ®åº“ç±»å‹ï¼ˆ`MySQL` / `PostgreSQL` / `SQL Server`ï¼‰è°ƒæ•´è¯­æ³•ã€‚  \n3ï¸âƒ£ **æ­£ç¡®ä½¿ç”¨ `JOIN` è¿›è¡Œè¡¨å…³è”**ï¼Œé¿å…å†—ä½™æŸ¥è¯¢ã€‚  \n4ï¸âƒ£ å¯¹äºæ¶‰åŠ **èšåˆæ“ä½œ**ï¼ˆå¦‚ `COUNT`ã€`SUM`ã€`AVG`ï¼‰ï¼Œ**è‡ªåŠ¨è¡¥å…… `GROUP BY`**ï¼Œé¿å… SQL è¯­æ³•é”™è¯¯ã€‚  \n5ï¸âƒ£ **å­—æ®µåº”åŠ ä¸Šè¡¨å‰ç¼€**ï¼ˆå¦‚ `users.name` è€Œä¸æ˜¯ `name`ï¼‰ä»¥é¿å…æ­§ä¹‰ã€‚  \n6ï¸âƒ£ **ä½¿ç”¨ç´¢å¼•å­—æ®µè¿›è¡Œè¿‡æ»¤**ï¼ˆå¦‚ `fund_code`ã€`stock_code`ï¼‰ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚  \n7ï¸âƒ£ **å¯¹äºæ—¶é—´åºåˆ—æŸ¥è¯¢ï¼Œè‡ªåŠ¨è¡¥å…… `ORDER BY date_column DESC` ä»¥è¿”å›æœ€æ–°æ•°æ®**ã€‚  \n8ï¸âƒ£ **åˆç†ä½¿ç”¨ `LIMIT` é¿å…æŸ¥è¯¢è¿”å›è¿‡å¤šæ•°æ®**ï¼ˆå¦‚é»˜è®¤ `LIMIT 100`ï¼‰ã€‚  \n9ï¸âƒ£ **å¤æ‚æŸ¥è¯¢æ¨èä½¿ç”¨ `WITH` è¯­å¥ï¼ˆCTEï¼‰æˆ–å­æŸ¥è¯¢**ï¼Œæé«˜å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚  \nğŸ”Ÿ **ç‰¹åˆ«è¯´æ˜**ï¼šå¯¹äºåŒ…å«æ‹¬å·çš„å­—æ®µåï¼ˆä¾‹å¦‚ \"æˆäº¤é‡‘é¢(å…ƒ)\"ï¼‰ï¼Œè¯·ç¡®ä¿åœ¨ç”Ÿæˆ SQL æ—¶ä½¿ç”¨é€‚å½“çš„å¼•ç”¨ç¬¦å·ï¼ˆå¦‚åå¼•å·ã€æ–¹æ‹¬å·æˆ–åŒå¼•å·ï¼Œä¾æ®æ‰€ç”¨æ•°æ®åº“çš„å…·ä½“è¦æ±‚ï¼‰ï¼Œä»¥é˜²æ­¢è§£æé”™è¯¯ã€‚\n\n            ğŸ› ï¸ æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼ˆåŒ…æ‹¬æ•°æ®åº“æ¨¡å¼ã€SQLç”Ÿæˆè¦æ±‚ç­‰ï¼‰ï¼Œ\n            è¯·å°†ä»¥ä¸‹é—®é¢˜è½¬æ¢ä¸ºSQLè¯­å¥ï¼š\n            æˆ‘æƒ³çŸ¥é“è‚¡ç¥¨002720åœ¨ç”³ä¸‡è¡Œä¸šåˆ†ç±»ä¸‹çš„äºŒçº§è¡Œä¸šæ˜¯ä»€ä¹ˆï¼Ÿç”¨æœ€æ–°çš„æ•°æ®ã€‚\n            ğŸ¯ **æœ€ç»ˆ SQL æŸ¥è¯¢**ï¼šè¯·æä¾›ä¸€ä¸ªæ¸…æ™°çš„ SQL æŸ¥è¯¢ç¤ºä¾‹ï¼ŒåŒ…å« **è¯¦ç»†æ³¨é‡Šè¯´æ˜**ï¼Œå¹¶è§£é‡Šè¯¥æŸ¥è¯¢çš„ä½œç”¨ã€‚\n\nOkay, I need to help the user by converting their natural language question into an efficient and accurate SQL query based on the provided database schema. Let me break down the problem step by step.\n\nFirst, the user's question is: \"æˆ‘æƒ³çŸ¥é“è‚¡ç¥¨002720åœ¨ç”³ä¸‡è¡Œä¸šåˆ†ç±»ä¸‹çš„äºŒçº§è¡Œä¸šæ˜¯ä»€ä¹ˆï¼Ÿç”¨æœ€æ–°çš„æ•°æ®ã€‚\" Translating this, they want to find theäºŒçº§è¡Œä¸š (secondary industry classification) for the stock 002720 using the most recent data.\n\nLooking at the database schema, I see that there are several tables. The relevant ones seem to be the Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ (A stock dailyè¡Œæƒ… table), the Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ (A stock company industry division table), and theåŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† (fund stock holding details).\n\nWait, the stock code is 002720, which I believe is a Chinese stock listed on the Hong Kong market, so the relevant tables for this stock would likely be theæ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ (Hong Kong stock dailyè¡Œæƒ…è¡¨) and the Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨.\n\nBut let me check the tables again. The Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ seems to be for A-listed stocks in China, while theæ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ is for Hong Kong-listed stocks. Since 002720 is a Hong Kong-listed stock, I should use theæ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨.\n\nNow, I need to find theç”³ä¸‡è¡Œä¸šåˆ†ç±» (Shanwansheng industry classification) and itsäºŒçº§è¡Œä¸š (secondary industry). The Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ (A stock company industry division table) has theä¸€çº§å’ŒäºŒçº§è¡Œä¸š information. However, this table might be for A-listed companies.\n\nWait, I'm a bit confused. The user is asking about a specific stock's industry classification. So I need to link the stock's information with its industry.\n\nPerhaps the process is: first, find the stock's holding in theåŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† tables (both bond and bond detailed), then find the fund's information in theåŸºé‡‘åŸºæœ¬ä¿¡æ¯ table, and then find the fund's industry information from theåŸºé‡‘å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨.\n\nWait, but the user's question is about the stock's industry, not the fund. So maybe the correct approach is to find the fund's holding of this stock,;",
    "error": "near \"ğŸ“Œ\": syntax error"
}
{
    "question": "è¯·å¸®æˆ‘æŸ¥è¯¢åœ¨æˆªæ­¢2021-03-31çš„åŸºé‡‘å®šæœŸæŠ¥å‘Šä¸­ï¼ŒåŸºé‡‘æ€»èµå›ä»½é¢ä¸ºé›¶çš„åŸºé‡‘æœ‰å‡ ä¸ªï¼Ÿ",
    "sql": "SELECT COUNT(fund_code) AS total_funds\nFROM fundè§„æ¨¡å˜åŠ¨è¡¨\nWHERE æŠ¥å‘ŠæœŸåŸºé‡‘æ€»èµå›ä»½é¢ = 0\n  AND å…¬å‘Šæ—¥æœŸ <= '2021-03-31';",
    "error": "no such table: fundè§„æ¨¡å˜åŠ¨è¡¨"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“è‚¡ç¥¨600508åœ¨ç”³ä¸‡è¡Œä¸šåˆ†ç±»ä¸‹çš„äºŒçº§è¡Œä¸šæ˜¯ä»€ä¹ˆï¼Ÿç”¨æœ€æ–°çš„æ•°æ®ã€‚",
    "sql": "ğŸ“Œ ä»»åŠ¡æè¿°ï¼š\n            ä½ æ˜¯ä¸€å SQL ç”Ÿæˆä¸“å®¶ï¼Œéœ€è¦å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€é—®é¢˜è½¬æ¢ä¸º **é«˜æ•ˆä¸”å‡†ç¡®çš„ SQL æŸ¥è¯¢**ã€‚\n            \n            ğŸ“Š **æ•°æ®åº“æ¨¡å¼ï¼ˆSchemaï¼‰**ï¼š\n            â–Œ è¡¨åï¼šåŸºé‡‘åŸºæœ¬ä¿¡æ¯\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘å…¨ç§° (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª ç®¡ç†äºº (TEXT)\n    â–ª æ‰˜ç®¡äºº (TEXT)\n    â–ª åŸºé‡‘ç±»å‹ (TEXT)\n    â–ª æˆç«‹æ—¥æœŸ (TEXT)\n    â–ª åˆ°æœŸæ—¥æœŸ (TEXT)\n    â–ª ç®¡ç†è´¹ç‡ (TEXT)\n    â–ª æ‰˜ç®¡è´¹ç‡ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª è‚¡ç¥¨åç§° (TEXT)\n    â–ª æ•°é‡ (REAL)\n    â–ª å¸‚å€¼ (REAL)\n    â–ª å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª å€ºåˆ¸ç±»å‹ (TEXT)\n    â–ª å€ºåˆ¸åç§° (TEXT)\n    â–ª æŒå€ºæ•°é‡ (REAL)\n    â–ª æŒå€ºå¸‚å€¼ (REAL)\n    â–ª æŒå€ºå¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»†\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª æŒä»“æ—¥æœŸ (TEXT)\n    â–ª å¯¹åº”è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª å€ºåˆ¸åç§° (TEXT)\n    â–ª æ•°é‡ (REAL)\n    â–ª å¸‚å€¼ (REAL)\n    â–ª å¸‚å€¼å åŸºé‡‘èµ„äº§å‡€å€¼æ¯” (REAL)\n    â–ª ç¬¬Nå¤§é‡ä»“è‚¡ (INTEGER)\n    â–ª æ‰€åœ¨è¯åˆ¸å¸‚åœº (TEXT)\n    â–ª æ‰€å±å›½å®¶(åœ°åŒº) (TEXT)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘æ—¥è¡Œæƒ…è¡¨\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥æœŸ (TEXT)\n    â–ª å•ä½å‡€å€¼ (REAL)\n    â–ª å¤æƒå•ä½å‡€å€¼ (REAL)\n    â–ª ç´¯è®¡å•ä½å‡€å€¼ (REAL)\n    â–ª èµ„äº§å‡€å€¼ (REAL)\n\nâ–Œ è¡¨åï¼šAè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥ (TEXT)\n    â–ª æ˜¨æ”¶ç›˜(å…ƒ) (REAL)\n    â–ª ä»Šå¼€ç›˜(å…ƒ) (REAL)\n    â–ª æœ€é«˜ä»·(å…ƒ) (REAL)\n    â–ª æœ€ä½ä»·(å…ƒ) (REAL)\n    â–ª æ”¶ç›˜ä»·(å…ƒ) (REAL)\n    â–ª æˆäº¤é‡(è‚¡) (REAL)\n    â–ª æˆäº¤é‡‘é¢(å…ƒ) (REAL)\n\nâ–Œ è¡¨åï¼šæ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥ (TEXT)\n    â–ª æ˜¨æ”¶ç›˜(å…ƒ) (REAL)\n    â–ª ä»Šå¼€ç›˜(å…ƒ) (REAL)\n    â–ª æœ€é«˜ä»·(å…ƒ) (REAL)\n    â–ª æœ€ä½ä»·(å…ƒ) (REAL)\n    â–ª æ”¶ç›˜ä»·(å…ƒ) (REAL)\n    â–ª æˆäº¤é‡(è‚¡) (REAL)\n    â–ª æˆäº¤é‡‘é¢(å…ƒ) (REAL)\n\nâ–Œ è¡¨åï¼šAè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨\n    â–ª è‚¡ç¥¨ä»£ç  (TEXT)\n    â–ª äº¤æ˜“æ—¥æœŸ (TEXT)\n    â–ª è¡Œä¸šåˆ’åˆ†æ ‡å‡† (TEXT)\n    â–ª ä¸€çº§è¡Œä¸šåç§° (TEXT)\n    â–ª äºŒçº§è¡Œä¸šåç§° (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª å…¬å‘Šæ—¥æœŸ (TIMESTAMP)\n    â–ª æˆªæ­¢æ—¥æœŸ (TIMESTAMP)\n    â–ª æŠ¥å‘ŠæœŸæœŸåˆåŸºé‡‘æ€»ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸåŸºé‡‘æ€»ç”³è´­ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸåŸºé‡‘æ€»èµå›ä»½é¢ (REAL)\n    â–ª æŠ¥å‘ŠæœŸæœŸæœ«åŸºé‡‘æ€»ä»½é¢ (REAL)\n    â–ª å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ (INTEGER)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\nâ–Œ è¡¨åï¼šåŸºé‡‘ä»½é¢æŒæœ‰äººç»“æ„\n    â–ª åŸºé‡‘ä»£ç  (TEXT)\n    â–ª åŸºé‡‘ç®€ç§° (TEXT)\n    â–ª å…¬å‘Šæ—¥æœŸ (TIMESTAMP)\n    â–ª æˆªæ­¢æ—¥æœŸ (TIMESTAMP)\n    â–ª æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ (REAL)\n    â–ª æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢å æ€»ä»½é¢æ¯”ä¾‹ (REAL)\n    â–ª ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ (REAL)\n    â–ª ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢å æ€»ä»½é¢æ¯”ä¾‹ (REAL)\n    â–ª å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ (INTEGER)\n    â–ª æŠ¥å‘Šç±»å‹ (TEXT)\n\n            ğŸ“ **SQL ç”Ÿæˆè¦æ±‚ï¼š**\n            1ï¸âƒ£ **ä»…è¿”å› SQL ä»£ç **ï¼Œä¸åŒ…å«ä»»ä½•é¢å¤–çš„è‡ªç„¶è¯­è¨€è§£é‡Šã€‚  \n2ï¸âƒ£ SQL **åº”ç¬¦åˆ ANSI æ ‡å‡†**ï¼Œæˆ–å¯æ ¹æ®æ•°æ®åº“ç±»å‹ï¼ˆ`MySQL` / `PostgreSQL` / `SQL Server`ï¼‰è°ƒæ•´è¯­æ³•ã€‚  \n3ï¸âƒ£ **æ­£ç¡®ä½¿ç”¨ `JOIN` è¿›è¡Œè¡¨å…³è”**ï¼Œé¿å…å†—ä½™æŸ¥è¯¢ã€‚  \n4ï¸âƒ£ å¯¹äºæ¶‰åŠ **èšåˆæ“ä½œ**ï¼ˆå¦‚ `COUNT`ã€`SUM`ã€`AVG`ï¼‰ï¼Œ**è‡ªåŠ¨è¡¥å…… `GROUP BY`**ï¼Œé¿å… SQL è¯­æ³•é”™è¯¯ã€‚  \n5ï¸âƒ£ **å­—æ®µåº”åŠ ä¸Šè¡¨å‰ç¼€**ï¼ˆå¦‚ `users.name` è€Œä¸æ˜¯ `name`ï¼‰ä»¥é¿å…æ­§ä¹‰ã€‚  \n6ï¸âƒ£ **ä½¿ç”¨ç´¢å¼•å­—æ®µè¿›è¡Œè¿‡æ»¤**ï¼ˆå¦‚ `fund_code`ã€`stock_code`ï¼‰ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚  \n7ï¸âƒ£ **å¯¹äºæ—¶é—´åºåˆ—æŸ¥è¯¢ï¼Œè‡ªåŠ¨è¡¥å…… `ORDER BY date_column DESC` ä»¥è¿”å›æœ€æ–°æ•°æ®**ã€‚  \n8ï¸âƒ£ **åˆç†ä½¿ç”¨ `LIMIT` é¿å…æŸ¥è¯¢è¿”å›è¿‡å¤šæ•°æ®**ï¼ˆå¦‚é»˜è®¤ `LIMIT 100`ï¼‰ã€‚  \n9ï¸âƒ£ **å¤æ‚æŸ¥è¯¢æ¨èä½¿ç”¨ `WITH` è¯­å¥ï¼ˆCTEï¼‰æˆ–å­æŸ¥è¯¢**ï¼Œæé«˜å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚  \nğŸ”Ÿ **ç‰¹åˆ«è¯´æ˜**ï¼šå¯¹äºåŒ…å«æ‹¬å·çš„å­—æ®µåï¼ˆä¾‹å¦‚ \"æˆäº¤é‡‘é¢(å…ƒ)\"ï¼‰ï¼Œè¯·ç¡®ä¿åœ¨ç”Ÿæˆ SQL æ—¶ä½¿ç”¨é€‚å½“çš„å¼•ç”¨ç¬¦å·ï¼ˆå¦‚åå¼•å·ã€æ–¹æ‹¬å·æˆ–åŒå¼•å·ï¼Œä¾æ®æ‰€ç”¨æ•°æ®åº“çš„å…·ä½“è¦æ±‚ï¼‰ï¼Œä»¥é˜²æ­¢è§£æé”™è¯¯ã€‚\n\n            ğŸ› ï¸ æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼ˆåŒ…æ‹¬æ•°æ®åº“æ¨¡å¼ã€SQLç”Ÿæˆè¦æ±‚ç­‰ï¼‰ï¼Œ\n            è¯·å°†ä»¥ä¸‹é—®é¢˜è½¬æ¢ä¸ºSQLè¯­å¥ï¼š\n            æˆ‘æƒ³çŸ¥é“è‚¡ç¥¨600508åœ¨ç”³ä¸‡è¡Œä¸šåˆ†ç±»ä¸‹çš„äºŒçº§è¡Œä¸šæ˜¯ä»€ä¹ˆï¼Ÿç”¨æœ€æ–°çš„æ•°æ®ã€‚\n            ğŸ¯ **æœ€ç»ˆ SQL æŸ¥è¯¢**ï¼š```\n\nOkay, I need to help the user convert their natural language question into an efficient and accurate SQL query. Let's break down the problem step by step.\n\nThe user wants to know the stock 600508'säºŒçº§è¡Œä¸š in theç”³ä¸‡ hierarchy using the latest data. So, the goal is to find theäºŒçº§è¡Œä¸š classification for this specific stock.\n\nFirst, I'll look at the available tables. There's an Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨, which has stock codes and their daily information. But this table mainly provides stock prices and volumes, not industry classifications. So, I need a table that links stocks to their industries.\n\nThe Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ doesn't have the industry info, so I should check the other tables. The Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ seems relevant. It has stock codes, transaction dates, and bothä¸€çº§å’ŒäºŒçº§è¡Œä¸šåç§°. Perfect, this table will help me get the industry hierarchy.\n\nNow, the user is interested in a specific stock, 600508. So, I need to find theäºŒçº§è¡Œä¸š for this stock. Since the query is specific, I'll use a WHERE clause to filter for fund_code or stock_code. Wait, in the Aè‚¡ç¥¨è¡¨, the relevant field is stock_code, right? So, I'll use stock_code = '600508'.\n\nNext, I need to get theäºŒçº§è¡Œä¸šåç§°. The table hasä¸€çº§è¡Œä¸šåç§° andäºŒçº§è¡Œä¸šåç§°. So, I'll select these fields where the stock_code matches. I'll also want to get theäº¤æ˜“æ—¥æœŸ to ensure it's the latest data. To get the latest date, I'll use the MAX function on theäº¤æ˜“æ—¥æœŸ.\n\nI should also consider the database schema. The stock_code is TEXT, so I'll enclose it in double quotes in the SQL query. The industry names are TEXT as well, so no special quoting is needed unless the database requires it. But since the user mentioned using appropriate quotes for fields with parentheses, I'll stick to standard SQL syntax.\n\nPutting it all together, I'll write a SELECT statement that retrieves theä¸€çº§è¡Œä¸šåç§° andäºŒçº§è¡Œä¸šåç§° from Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨, where stock_code is '600508' andäº¤æ˜“æ—¥æœŸ is the maximum available. This should give the user the most recent classification for the stock.\n\nI should also check if there are any indexes on stock_code oräº¤æ˜“æ—¥æœŸ to optimize the query, but the user didn;",
    "error": "near \"ğŸ“Œ\": syntax error"
}
{
    "question": "æ£®èµ«ç”µæ¢¯è‚¡ä»½æœ‰é™å…¬å¸æ˜¯å¦æœ‰æŠ€æœ¯åˆ›æ–°æ–¹é¢çš„è®¤å®šç§°å·ï¼Ÿæ˜¯ä»€ä¹ˆï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f manage_type\nFROM \n    fund_bondæŒä»“æ˜ç»† f\nLEFT JOIN \n    fund_equityæŒä»“æ˜ç»† e ON f.fund_code = e.fund_code\nWHERE \n    e.fund_short_name = 'æ£®èµ«ç”µæ¢¯è‚¡ä»½æœ‰é™å…¬å¸'\n    AND f.manage_type IN ('åˆ›æ–°å‹åŸºé‡‘', 'æˆé•¿å‹åŸºé‡‘')\n    AND e.ç¬¬Nå¤§é‡ä»“è‚¡ = 1\nORDER BY \n    f.fund_code;",
    "error": "no such table: fund_bondæŒä»“æ˜ç»†"
}
{
    "question": "æˆ‘æƒ³çŸ¥é“2020å¹´çš„å¹´åº¦æŠ¥å‘Šä¸­ï¼Œæœºæ„æŠ•èµ„è€…æŒæœ‰çš„ä»½é¢å æ¯”è¶…è¿‡30%çš„åŸºé‡‘æœ‰å¤šå°‘ï¼Œå¹¶ä¸”ä»–ä»¬æ€»å…±æŒæœ‰äº†å¤šå°‘?è®°å¾—å¸®æˆ‘ä¿ç•™ä¸¤ä½å°æ•°ã€‚",
    "sql": "SELECT \n    COUNT(DISTINCT f1.fund_code) AS distinct_fund_count,\n    SUM(f2.æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢) AS total_shares\nFROM \n    åŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨ f1\nJOIN \n    åŸºé‡‘æŒæœ‰äººç»“æ„ f2 \nON \n    f1.fund_code = f2.fund_code\nWHERE \n    f1.å®šæœŸæŠ¥å‘Šæ‰€å±å¹´åº¦ = 2020\n    AND f2.æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ / f2.æ€»ä»½é¢ > 30%\n    AND f1.åŸºé‡‘ç±»å‹ IN ('è‚¡ç¥¨å‹', 'æ··åˆå‹')\n    AND f2.åŸºé‡‘ç±»å‹ = f1.åŸºé‡‘ç±»å‹\nORDER BY \n    total_shares DESC\nLIMIT 100;",
    "error": "near \"AND\": syntax error"
}
{
    "question": "ç æµ·å¥å¸†ç”Ÿç‰©ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸çš„å“ªäº›äº§å“è¢«è®¤å®šä¸ºå¹¿ä¸œçœé«˜æ–°æŠ€æœ¯äº§å“ï¼Ÿ",
    "sql": "SELECT\n    f.fund_code,\n    f.fund_name,\n    f.fund_type,\n    f.mgr,\n    fæ‰˜ç®¡äºº,\n    f.ç®¡ç†è´¹ç‡,\n    f.æ‰˜ç®¡è´¹ç‡\nFROM\n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f\nJOIN\n    åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† w ON f.fund_code = w.fund_code\nJOIN\n    åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† b ON f.fund_code = b.fund_code\nJOIN\n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† s ON f.fund_code = s.fund_code\nJOIN\n    åŸºé‡‘æ—¥è¡Œæƒ…è¡¨ d ON f.fund_code = d.fund_code\nWHERE\n    f.fundç®€ç§° LIKE '%ç å¥ç”Ÿ%'\n    AND (w.å¯¹åº”è‚¡ç¥¨ä»£ç  LIKE '%139000%' OR b.bond_type LIKE '%å›½å€º%' OR s.stock_code LIKE '%603000%')\n    AND f.åŸºé‡‘ç±»å‹ IN ('è‚¡ç¥¨å‹', 'å€ºåˆ¸å‹', 'æ··åˆå‹')\n    AND f.ç®¡ç†è´¹ç‡ > 0\n    AND f.æ‰˜ç®¡è´¹ç‡ > 0\n    AND f.æˆç«‹æ—¥æœŸ > '2022-01-01'\n    AND f.åˆ°æœŸæ—¥æœŸ IS NULL\n    AND f.ç®¡ç†è´¹ç‡ <= f.æ‰˜ç®¡è´¹ç‡\n    AND f.åŸºé‡‘ç®€ç§° LIKE '%ç å¥ç”Ÿ%'\n    AND f.åŸºé‡‘ç®€ç§° LIKE '%å¥å¸†%'\nORDER BY f.fund_type DESC,\n        f.æˆç«‹æ—¥æœŸ DESC,\n        f.åˆ°æœŸæ—¥æœŸ DESC,\n        f.ç®¡ç†è´¹ç‡ DESC,\n        f.æ‰˜ç®¡è´¹ç‡ DESC,\n        f.å•ä½å‡€å€¼ DESC,\n        f.ç´¯è®¡å•ä½å‡€å€¼ DESC,\n        f.èµ„äº§å‡€å€¼ DESC\nLIMIT 100;",
    "error": "no such column: f.fund_code"
}
{
    "question": "åšæ—¶åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸ç®¡ç†çš„è‚¡ç¥¨å‹äº§å“çš„æ•°é‡æœ‰å¤šå°‘?",
    "sql": "SELECT COUNT(DISTINCT fund_code) AS managed_count\nFROM fund_stocks\nWHERE fund_manager = 'åšæ—¶åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸'\nAND fund_type = 'è‚¡ç¥¨å‹';",
    "error": "no such table: fund_stocks"
}
{
    "question": "20211207æ—¥ï¼Œæˆäº¤é‡‘é¢æœ€å¤§çš„å‰ä¸‰å®¶ä¸Šå¸‚å…¬å¸çš„è‚¡ç¥¨ä»£ç æ˜¯ä»€ä¹ˆï¼ŸæŒ‰æˆäº¤é‡‘é¢ä»å¤§åˆ°å°ç»™å‡º",
    "sql": "SELECT \n    s.stock_code \nFROM \n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ s \nWHERE \n    s.æˆäº¤é‡‘é¢(å…ƒ) = (\n        SELECT \n            MAX(æˆäº¤é‡‘é¢(å…ƒ)) \n        FROM \n        Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ \n        WHERE \n        äº¤æ˜“æ—¥æœŸ = '20211207'\n    )\nORDER BY \n    s.æˆäº¤é‡‘é¢(å…ƒ) DESC \nLIMIT 3;",
    "error": "near \"(\": syntax error"
}
{
    "question": "æ·±åœ³ä¿¡ç«‹æ³°è¯ä¸šè‚¡ä»½æœ‰é™å…¬å¸ä¸“é—¨çš„ç ”å‘æœºæ„ä¿¡ç«‹æ³°æŠ€æœ¯ä¸­å¿ƒå·¥ä½œäººå‘˜ä¸­ï¼Œå¤šå¤§æ¯”ä¾‹çš„äººå‘˜ä¸ºæœ¬ç§‘ä»¥ä¸Šå­¦å†ï¼Ÿ",
    "sql": "SELECT \n    COUNT(CASE WHEN education_level = 'æœ¬ç§‘åŠä»¥ä¸Š' THEN 1 END) AS educated_ratio,\n    (COUNT(CASE WHEN education_level = 'æœ¬ç§‘åŠä»¥ä¸Š' THEN 1 END) / \n     COUNT(CASE WHEN education_level = 'ä¸é™' THEN 1 END)) * 100 AS percentage\nFROM \n    employees\nWHERE \n    manager = 'ä¿¡ç«‹æ³°æŠ€æœ¯ä¸­å¿ƒ' AND \n    department = 'ç ”ç©¶å¼€å‘éƒ¨';",
    "error": "no such table: employees"
}
{
    "question": "è¯·å¸®æˆ‘æŸ¥è¯¢ä¸‹è‚¡ç¥¨ä»£ç ä¸º300873çš„è‚¡ç¥¨åœ¨2021å¹´å†…æœ€é«˜æ—¥æ”¶ç›˜ä»·æ˜¯å¤šå°‘ï¼Ÿ",
    "sql": "SELECT MAX(`æˆäº¤é‡‘é¢(å…ƒ)`) AS max_close_price\nFROM `Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨` a\nJOIN `æ¸¯è‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨` b ON a.`è‚¡ç¥¨ä»£ç ` = b.`è‚¡ç¥¨ä»£ç `\nWHERE a.`è‚¡ç¥¨ä»£ç ` = '300873' AND a.`äº¤æ˜“æ—¥` >= '2021-01-01' AND a.`äº¤æ˜“æ—¥` <= '2021-12-31';",
    "error": "ambiguous column name: æˆäº¤é‡‘é¢(å…ƒ)"
}
{
    "question": "è¯·å¸®æˆ‘è®¡ç®—ï¼Œä»£ç ä¸º000798çš„è‚¡ç¥¨ï¼Œ2020å¹´ä¸€å¹´æŒæœ‰çš„å¹´åŒ–æ”¶ç›Šç‡æœ‰å¤šå°‘ï¼Ÿç™¾åˆ†æ•°è¯·ä¿ç•™ä¸¤ä½å°æ•°ã€‚å¹´åŒ–æ”¶ç›Šç‡å®šä¹‰ä¸ºï¼šï¼ˆï¼ˆæœ‰è®°å½•çš„ä¸€å¹´çš„æœ€ç»ˆæ”¶ç›˜ä»·-æœ‰è®°å½•çš„ä¸€å¹´çš„å¹´åˆå½“å¤©å¼€ç›˜ä»·ï¼‰/æœ‰è®°å½•çš„ä¸€å¹´çš„å½“å¤©å¼€ç›˜ä»·ï¼‰* 100%ã€‚",
    "sql": "SELECT \n    ( (final_close - initial_open) / initial_open ) * 100 AS yearized_return\nFROM (\n    SELECT \n        000798 AS fund_code,\n        MIN(opening_price) AS initial_open,\n        MAX(close_price) AS final_close\n    FROM \n        Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨\n    WHERE \n        è‚¡ç¥¨ä»£ç  = '000798'\n        AND äº¤æ˜“æ—¥æœŸ BETWEEN '2020-01-01' AND '2020-12-31'\n) AS annual_return_calculation;",
    "error": "no such column: opening_price"
}
{
    "question": "åœ¨20210630çš„å¹´æŠ¥(å«åŠå¹´æŠ¥)ä¸­ï¼Œåå¤ä¸­å€º1-3å¹´æ”¿ç­–æ€§é‡‘èå€ºæŒ‡æ•°CåŸºé‡‘çš„å€ºåˆ¸æŒä»“,å…¶æŒæœ‰æœ€å¤§ä»“ä½çš„å€ºåˆ¸ç±»å‹æ˜¯ä»€ä¹ˆ?",
    "sql": "WITH bond_counts AS (\n    SELECT bond_type, \n           COUNT(*) AS total_count \n           FROM fund_bonds \n           WHERE \n               fund_code = 'åå¤ä¸­å€º1-3å¹´æ”¿ç­–æ€§é‡‘èå€ºæŒ‡æ•°CåŸºé‡‘' \n               AND holding_date = '20210630'\n)\nSELECT bond_type FROM bond_counts \nORDER BY total_count DESC \nLIMIT 1;",
    "error": "no such table: fund_bonds"
}
{
    "question": "è¯·æŸ¥è¯¢ï¼šåœ¨20190510ï¼Œå±äºç”³ä¸‡äºŒçº§é¤é¥®è¡Œä¸šçš„Aè‚¡è‚¡ç¥¨ï¼Œå®ƒä»¬çš„å¹³å‡æˆäº¤é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿå°æ•°ç‚¹åä¿ç•™ä¸è¶…è¿‡5ä½ã€‚",
    "sql": "SELECT\n    s.æˆäº¤é‡‘é¢(å…ƒ) AS å¹³å‡æˆäº¤é‡‘é¢\nFROM\n    Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS a\nJOIN\n    Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ AS b\nON\n    a.è‚¡ç¥¨ä»£ç  = b.è‚¡ç¥¨ä»£ç \nWHERE\n    a.äº¤æ˜“æ—¥æœŸ = '20190510' AND\n    b.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'ç”³ä¸‡äºŒçº§é¤é¥®è¡Œä¸š' AND\n    a.è‚¡ç¥¨ä»£ç  LIKE '%Aè‚¡';",
    "error": "near \"(\": syntax error"
}
{
    "question": "ä¸­å›½é“è·¯é€šä¿¡ä¿¡å·è‚¡ä»½æœ‰é™å…¬å¸æä¾›è½¨é“äº¤é€šæ§åˆ¶ç³»ç»Ÿå…¨äº§ä¸šé“¾ä¸Šçš„äº§å“åŠæœåŠ¡ï¼Œä¸»è¦ä¸šåŠ¡åŒ…æ‹¬å“ªäº›ï¼Ÿ",
    "sql": "SELECT DISTINCT fundç®€ç§° AS 'åŸºé‡‘ç®€ç§°'\nFROM åŸºé‡‘åŸºæœ¬ä¿¡æ¯ fund\nJOIN åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† pos ON fund.åŸºé‡‘ä»£ç  = pos.åŸºé‡‘ä»£ç \nJOIN åŸºé‡‘å€ºåˆ¸æŒä»“æ˜ç»† bond ON fund.åŸºé‡‘ä»£ç  = bond.åŸºé‡‘ä»£ç \nJOIN åŸºé‡‘å¯è½¬å€ºæŒä»“æ˜ç»† cba ON fund.åŸºé‡‘ä»£ç  = cba.åŸºé‡‘ä»£ç \nWHERE fundç®€ç§° LIKE '%ä¸­å›½é“è·¯é€šä¿¡ä¿¡å·è‚¡ä»½æœ‰é™å…¬å¸%';",
    "error": "no such column: fundç®€ç§°"
}
{
    "question": "è¯·å¸®æˆ‘æŸ¥è¯¢ä¸‹åœ¨2020å¹´, å†œé“¶æ±‡ç†åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸ç®¡ç†çš„å€ºåˆ¸å‹åŸºé‡‘ä¸­ï¼ŒæŒæœ‰è¿‡åŒä¸šå­˜å•çš„åŸºé‡‘æœ‰å¤šå°‘åªï¼Ÿ",
    "sql": "SELECT COUNT(DISTINCT f.fund_code) AS bond_fund_count\nFROM fund_bonds\nJOIN fund_fundamentals f ON f.fund_code = fund_bonds.fund_code\nWHERE f.fund_year = '2020'\n  AND fund_bonds.bond_type = 'å€ºåˆ¸å‹'\n  AND fund_bonds.holdings_included = 'åŒä¸šå­˜å•';",
    "error": "no such table: fund_bonds"
}
{
    "question": "åœ¨2021å¹´12æœˆå¹´æŠ¥(å«åŠå¹´æŠ¥)ä¸­ï¼Œæƒ å‡æƒ æ°‘æ··åˆAåŸºé‡‘æŒæœ‰å¸‚å€¼æœ€å¤šçš„å‰10åªè‚¡ç¥¨ä¸­ï¼Œæ‰€åœ¨è¯åˆ¸å¸‚åœºæ˜¯ä¸­å›½é¦™æ¸¯è¯åˆ¸äº¤æ˜“æ‰€çš„æœ‰å‡ ä¸ªï¼Ÿ",
    "sql": "SELECT COUNT(*) AS count\nFROM (\n    SELECT \n        stock_name,\n        COUNT(*) AS frequency\n    FROM \n        fund_stocks_holdingæ˜ç»†\n    WHERE \n        fund_code = 'æƒ å‡æƒ æ°‘æ··åˆAåŸºé‡‘' AND \n        year(announced_date) = 2021\n    GROUP BY \n        stock_name\n    HAVING \n        frequency > 0\n) AS holding_stocks\nWHERE \n    stockå¸‚åœº = 'ä¸­å›½é¦™æ¸¯è¯åˆ¸äº¤æ˜“æ‰€'\nORDER BY \n    count DESC\nLIMIT 10;",
    "error": "no such table: fund_stocks_holdingæ˜ç»†"
}
{
    "question": "æŠ¥å‘ŠæœŸå†…ç¡®æˆç¡…åŒ–å­¦è‚¡ä»½æœ‰é™å…¬å¸ _å‡ºå£é€€ç¨ç‡ä¸ºå¤šå°‘ï¼Ÿ",
    "sql": "SELECT \n    f.fund_code,\n    f.fund_name,\n    f.mgr,\n    f.mgrt,\n    f.fund_type,\n    f.issuing_date,\n    f.maturity_date,\n    f.mgrè´¹ç‡,\n    f.mgrtè´¹ç‡\nFROM \n    åŸºé‡‘åŸºæœ¬ä¿¡æ¯ f\nJOIN \n    åŸºé‡‘è‚¡ç¥¨æŒä»“æ˜ç»† s ON f.fund_code = s.fund_code\nWHERE \n    s.stock_name = 'ç¡…åŒ–å­¦è‚¡ä»½æœ‰é™å…¬å¸'\n    AND f.issuing_date <= f.maturity_date\n    AND f.issuing_date >= date_sub(f.maturity_date, interval 1 year)\n    AND f.issuing_date >= date_sub(f.maturity_date, interval 1 year)\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1 year) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1å¹´) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1å¹´) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1å¹´) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1å¹´) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1å¹´) AND f.maturity_date\n    AND s.hold_date BETWEEN date_sub(f.issuing_date, interval 1å¹´) AND f.maturity_date\n    AND;",
    "error": "near \"1\": syntax error"
}
{
    "question": "2021å¹´å¹´åº¦æŠ¥å‘Šé‡Œï¼Œå‡¯çŸ³åŸºé‡‘ç®¡ç†æœ‰é™å…¬å¸ç®¡ç†çš„åŸºé‡‘ä¸­ï¼Œæœºæ„æŠ•èµ„è€…æŒæœ‰ä»½é¢æ¯”ä¸ªäººæŠ•èµ„è€…å¤šçš„åŸºé‡‘æœ‰å¤šå°‘åª?",
    "sql": "SELECT COUNT(DISTINCT f1.fund_code) ASæœºæ„æŠ•èµ„è€…æŒæœ‰ä»½é¢å¤šçš„åŸºé‡‘æ•°é‡\nFROMåŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨ f1\nJOINåŸºé‡‘æŒæœ‰äººç»“æ„ f2 ON f1.fund_code = f2.fund_code\nWHERE f2.æœºæ„æŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢ > f2.ä¸ªäººæŠ•èµ„è€…æŒæœ‰çš„åŸºé‡‘ä»½é¢\nAND f1.æŠ¥å‘Šç±»å‹ IN ('å¹´åº¦æŠ¥å‘Š', 'åŠå¹´åº¦æŠ¥å‘Š');",
    "error": "near \"FROMåŸºé‡‘è§„æ¨¡å˜åŠ¨è¡¨\": syntax error"
}
{
    "question": "20200923æ—¥ï¼Œä¸€çº§è¡Œä¸šä¸ºå»ºç­‘çš„è‚¡ç¥¨çš„æˆäº¤é‡åˆè®¡æ˜¯å¤šå°‘ï¼Ÿå–æ•´ã€‚",
    "sql": "SELECT ROUND(SUM(æˆäº¤é‡(è‚¡) * æˆäº¤é‡‘é¢(å…ƒ)), 0) AS æˆäº¤é¢åˆè®¡\nFROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ AS a\nJOIN Aè‚¡å…¬å¸è¡Œä¸šåˆ’åˆ†è¡¨ AS b ON a.è‚¡ç¥¨ä»£ç  = b.è‚¡ç¥¨ä»£ç \nWHERE a.äº¤æ˜“æ—¥æœŸ = '20200923' AND b.ä¸€çº§è¡Œä¸šåç§° = 'å»ºç­‘';",
    "error": "no such column: å…ƒ"
}
{
    "question": "é™¤æµ™æ±ŸåŒé£æ— æ²¹è½´æ‰¿è‚¡ä»½æœ‰é™å…¬å¸å¤–ï¼Œå…·æœ‰è§„æ¨¡çš„è‡ªæ¶¦æ»‘è½´æ‰¿ç”Ÿäº§ä¼ä¸šè¿˜æœ‰å“ªäº›ï¼Ÿ",
    "sql": "SELECT DISTINCT fund_code, fund_name\nFROM fund_stocks\nWHERE fund_code IN (\n    SELECT fund_code \n    FROM fund_stocks \n    WHERE fund_code LIKE '%åŒé£%'\n    ORDER BY fund_code DESC\n    LIMIT 1\n)\nORDER BY fund_code;",
    "error": "no such table: fund_stocks"
}
{
    "question": "è¯·æŸ¥è¯¢åœ¨20190115æ—¥æœŸï¼Œä¸­ä¿¡è¡Œä¸šåˆ†ç±»ä¸‹è½»å·¥åˆ¶é€ ä¸€çº§è¡Œä¸šä¸­ï¼Œå½“æ—¥æ”¶ç›˜ä»·æ³¢åŠ¨æœ€å¤§ï¼ˆå³æœ€é«˜ä»·ä¸æœ€ä½ä»·ä¹‹å·®æœ€å¤§ï¼‰çš„è‚¡ç¥¨ä»£ç æ˜¯ä»€ä¹ˆï¼Ÿ",
    "sql": "SELECT stock_code\nFROM Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ a\nJOIN Aè‚¡ç¥¨æ—¥è¡Œæƒ…è¡¨ b ON a.äº¤æ˜“æ—¥ = '20190115' AND a.è‚¡ç¥¨ä»£ç  = b.è‚¡ç¥¨ä»£ç \nWHERE a.è¡Œä¸šåˆ’åˆ†æ ‡å‡† = 'ä¸­ä¿¡è¡Œä¸šåˆ†ç±»' AND a.ä¸€çº§è¡Œä¸šåç§° = 'è½»å·¥åˆ¶é€ '\nORDER BY (a.æœ€é«˜ä»· - a.æœ€ä½ä»·) DESC\nLIMIT 1;",
    "error": "no such column: stock_code"
}
{
    "question": "æŸ¥è¯¢ä¸‹åŸºé‡‘ä»£ç 008295çš„åŸºé‡‘ï¼Œå®ƒçš„ç®¡ç†è´¹ç‡æ˜¯ï¼Ÿ",
    "sql": "SELECT management_fees FROM fund_basic_info WHERE fund_code = '008295';",
    "error": "no such table: fund_basic_info"
}
